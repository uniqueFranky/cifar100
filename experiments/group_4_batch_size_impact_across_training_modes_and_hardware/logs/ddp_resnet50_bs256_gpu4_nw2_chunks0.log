====================================================================================================
Experiment: ddp_resnet50_bs256_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 256,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 256 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs256_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T13:05:02.603692
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 256
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs256_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 1024
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 256
有效batch size: 1024
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/49] Loss: 4.8533 | Acc: 0.78% | Time: 0.5738s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 5.5961, Acc: 1.18%
测试 - Loss: 4.7836, Acc: 1.55%
学习率: 0.100000, 时间: 14.84s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 0.00% -> 1.55%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/49] Loss: 4.5819 | Acc: 2.34% | Time: 0.0327s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 4.4718, Acc: 2.66%
测试 - Loss: 4.2981, Acc: 4.52%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 1.55% -> 4.52%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/49] Loss: 4.2668 | Acc: 3.12% | Time: 0.0393s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 4.1703, Acc: 5.33%
测试 - Loss: 4.0379, Acc: 7.27%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 4.52% -> 7.27%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/49] Loss: 4.0559 | Acc: 6.64% | Time: 0.0332s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.9656, Acc: 7.84%
测试 - Loss: 3.8438, Acc: 9.98%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 7.27% -> 9.98%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/49] Loss: 3.7401 | Acc: 11.72% | Time: 0.0370s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.8119, Acc: 10.10%
测试 - Loss: 3.7179, Acc: 11.12%
学习率: 0.100000, 时间: 5.71s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 9.98% -> 11.12%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/49] Loss: 3.8162 | Acc: 9.77% | Time: 0.0365s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.6871, Acc: 12.05%
测试 - Loss: 3.6450, Acc: 12.67%
学习率: 0.100000, 时间: 5.60s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 11.12% -> 12.67%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/49] Loss: 3.6508 | Acc: 12.89% | Time: 0.0366s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.5725, Acc: 13.52%
测试 - Loss: 3.4761, Acc: 15.93%
学习率: 0.100000, 时间: 5.62s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 12.67% -> 15.93%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/49] Loss: 3.4281 | Acc: 15.23% | Time: 0.0363s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.4308, Acc: 16.74%
测试 - Loss: 3.4582, Acc: 16.53%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 15.93% -> 16.53%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/49] Loss: 3.1828 | Acc: 14.84% | Time: 0.0345s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.2625, Acc: 19.62%
测试 - Loss: 3.3361, Acc: 19.00%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 16.53% -> 19.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/49] Loss: 3.1370 | Acc: 21.09% | Time: 0.0346s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 3.1303, Acc: 22.38%
测试 - Loss: 3.1055, Acc: 23.53%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 19.00% -> 23.53%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/49] Loss: 2.9707 | Acc: 23.44% | Time: 0.0298s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.9788, Acc: 25.14%
测试 - Loss: 2.9734, Acc: 26.37%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 23.53% -> 26.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/49] Loss: 2.9046 | Acc: 26.95% | Time: 0.0444s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.8164, Acc: 28.10%
测试 - Loss: 2.9518, Acc: 26.89%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 26.37% -> 26.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/49] Loss: 2.7729 | Acc: 32.42% | Time: 0.0365s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.6777, Acc: 30.82%
测试 - Loss: 2.7464, Acc: 30.18%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 26.89% -> 30.18%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/49] Loss: 2.5916 | Acc: 32.03% | Time: 0.0362s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.5465, Acc: 33.51%
测试 - Loss: 2.7021, Acc: 31.54%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 30.18% -> 31.54%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/49] Loss: 2.4083 | Acc: 34.77% | Time: 0.0388s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.4308, Acc: 35.89%
测试 - Loss: 2.5151, Acc: 35.26%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 31.54% -> 35.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/49] Loss: 2.2390 | Acc: 38.28% | Time: 0.0316s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.3167, Acc: 38.83%
测试 - Loss: 2.4291, Acc: 37.41%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 35.26% -> 37.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/49] Loss: 2.1594 | Acc: 41.41% | Time: 0.0380s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.1910, Acc: 40.98%
测试 - Loss: 2.3233, Acc: 39.82%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 37.41% -> 39.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/49] Loss: 2.1540 | Acc: 41.41% | Time: 0.0263s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 2.0719, Acc: 43.62%
测试 - Loss: 2.2428, Acc: 40.82%
学习率: 0.100000, 时间: 5.60s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 39.82% -> 40.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/49] Loss: 2.0002 | Acc: 49.61% | Time: 0.0276s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.9420, Acc: 46.99%
测试 - Loss: 2.1219, Acc: 43.61%
学习率: 0.100000, 时间: 5.64s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 40.82% -> 43.61%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/49] Loss: 1.7929 | Acc: 50.39% | Time: 0.0314s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.8697, Acc: 48.98%
测试 - Loss: 2.1605, Acc: 43.63%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 43.61% -> 43.63%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/49] Loss: 1.8077 | Acc: 50.39% | Time: 0.0338s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.7845, Acc: 50.40%
测试 - Loss: 2.1445, Acc: 44.11%
学习率: 0.100000, 时间: 5.61s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 43.63% -> 44.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/49] Loss: 1.8258 | Acc: 53.12% | Time: 0.0306s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.7450, Acc: 51.46%
测试 - Loss: 1.9273, Acc: 48.85%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 44.11% -> 48.85%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/49] Loss: 1.5422 | Acc: 53.52% | Time: 0.0319s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.6437, Acc: 53.88%
测试 - Loss: 1.9520, Acc: 47.80%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/49] Loss: 1.4931 | Acc: 57.81% | Time: 0.0374s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.5183, Acc: 56.66%
测试 - Loss: 1.8279, Acc: 51.20%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 48.85% -> 51.20%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/49] Loss: 1.2984 | Acc: 64.06% | Time: 0.0322s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.4769, Acc: 57.95%
测试 - Loss: 2.0106, Acc: 48.28%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/49] Loss: 1.4429 | Acc: 58.98% | Time: 0.0342s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.4043, Acc: 59.97%
测试 - Loss: 2.5476, Acc: 46.93%
学习率: 0.100000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/49] Loss: 1.1974 | Acc: 63.28% | Time: 0.0378s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.3165, Acc: 61.77%
测试 - Loss: 2.3676, Acc: 49.61%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/49] Loss: 1.3167 | Acc: 60.16% | Time: 0.0276s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.2557, Acc: 62.89%
测试 - Loss: 1.7752, Acc: 53.47%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 51.20% -> 53.47%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/49] Loss: 1.2405 | Acc: 67.19% | Time: 0.0414s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.2033, Acc: 65.18%
测试 - Loss: 1.7928, Acc: 52.86%
学习率: 0.100000, 时间: 5.60s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/49] Loss: 1.0685 | Acc: 68.36% | Time: 0.0317s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.1218, Acc: 66.76%
测试 - Loss: 1.7926, Acc: 53.79%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 53.47% -> 53.79%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/49] Loss: 0.8416 | Acc: 76.95% | Time: 0.0454s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.0979, Acc: 67.60%
测试 - Loss: 1.6638, Acc: 56.21%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 53.79% -> 56.21%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/49] Loss: 0.9266 | Acc: 73.05% | Time: 0.0375s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.0231, Acc: 69.61%
测试 - Loss: 1.8574, Acc: 53.48%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/49] Loss: 0.9583 | Acc: 73.44% | Time: 0.0372s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 1.0086, Acc: 69.70%
测试 - Loss: 1.7628, Acc: 54.20%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/49] Loss: 0.8722 | Acc: 74.61% | Time: 0.0299s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.9414, Acc: 72.06%
测试 - Loss: 1.6927, Acc: 56.23%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 56.21% -> 56.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/49] Loss: 0.7528 | Acc: 77.34% | Time: 0.0351s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.9056, Acc: 72.78%
测试 - Loss: 1.6394, Acc: 56.20%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/49] Loss: 0.8299 | Acc: 74.22% | Time: 0.0327s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.8492, Acc: 73.51%
测试 - Loss: 1.6470, Acc: 57.42%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 56.23% -> 57.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/49] Loss: 0.8186 | Acc: 75.00% | Time: 0.0387s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.8165, Acc: 75.43%
测试 - Loss: 1.8047, Acc: 55.96%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/49] Loss: 0.7549 | Acc: 76.56% | Time: 0.0340s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.7614, Acc: 76.99%
测试 - Loss: 1.6352, Acc: 58.20%
学习率: 0.100000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 57.42% -> 58.20%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/49] Loss: 0.6286 | Acc: 81.64% | Time: 0.0282s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.7264, Acc: 77.74%
测试 - Loss: 1.6458, Acc: 58.55%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 58.20% -> 58.55%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/49] Loss: 0.5403 | Acc: 84.38% | Time: 0.0331s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.6588, Acc: 79.66%
测试 - Loss: 1.6917, Acc: 57.51%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/49] Loss: 0.5900 | Acc: 81.64% | Time: 0.0379s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.6259, Acc: 80.62%
测试 - Loss: 1.7738, Acc: 56.39%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/49] Loss: 0.5954 | Acc: 82.03% | Time: 0.0364s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.6223, Acc: 80.86%
测试 - Loss: 1.5926, Acc: 59.23%
学习率: 0.100000, 时间: 5.63s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 58.55% -> 59.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/49] Loss: 0.5572 | Acc: 80.08% | Time: 0.0315s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.5504, Acc: 83.06%
测试 - Loss: 1.6716, Acc: 58.74%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/49] Loss: 0.4773 | Acc: 84.38% | Time: 0.0291s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.5302, Acc: 83.60%
测试 - Loss: 1.6108, Acc: 60.34%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 59.23% -> 60.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/49] Loss: 0.4549 | Acc: 83.98% | Time: 0.0412s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.5006, Acc: 84.66%
测试 - Loss: 1.6183, Acc: 60.14%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/49] Loss: 0.5673 | Acc: 80.47% | Time: 0.0338s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.4743, Acc: 85.37%
测试 - Loss: 1.5497, Acc: 61.42%
学习率: 0.100000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 60.34% -> 61.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/49] Loss: 0.4179 | Acc: 88.28% | Time: 0.0368s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.4362, Acc: 86.65%
测试 - Loss: 1.6604, Acc: 60.60%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/49] Loss: 0.4113 | Acc: 87.89% | Time: 0.0319s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.4295, Acc: 86.46%
测试 - Loss: 1.6353, Acc: 60.66%
学习率: 0.100000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/49] Loss: 0.3753 | Acc: 89.45% | Time: 0.0414s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.4019, Acc: 87.60%
测试 - Loss: 1.6681, Acc: 60.66%
学习率: 0.100000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/49] Loss: 0.3042 | Acc: 90.62% | Time: 0.0290s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.3888, Acc: 87.86%
测试 - Loss: 1.6757, Acc: 61.16%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/49] Loss: 0.2997 | Acc: 92.19% | Time: 0.0375s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.2061, Acc: 94.83%
测试 - Loss: 1.2316, Acc: 68.74%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 61.42% -> 68.74%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/49] Loss: 0.1156 | Acc: 98.05% | Time: 0.0387s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.1315, Acc: 97.33%
测试 - Loss: 1.2209, Acc: 69.31%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 68.74% -> 69.31%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/49] Loss: 0.1311 | Acc: 96.09% | Time: 0.0328s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.1082, Acc: 97.93%
测试 - Loss: 1.2177, Acc: 69.36%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 69.31% -> 69.36%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/49] Loss: 0.0901 | Acc: 99.61% | Time: 0.0312s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0966, Acc: 98.30%
测试 - Loss: 1.2158, Acc: 69.58%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 69.36% -> 69.58%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/49] Loss: 0.0894 | Acc: 98.44% | Time: 0.0316s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0852, Acc: 98.67%
测试 - Loss: 1.2245, Acc: 69.62%
学习率: 0.010000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 69.58% -> 69.62%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/49] Loss: 0.0653 | Acc: 99.22% | Time: 0.0357s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0830, Acc: 98.77%
测试 - Loss: 1.2252, Acc: 69.74%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 69.62% -> 69.74%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/49] Loss: 0.0704 | Acc: 99.61% | Time: 0.0305s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0748, Acc: 99.03%
测试 - Loss: 1.2209, Acc: 69.99%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 69.74% -> 69.99%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/49] Loss: 0.0557 | Acc: 99.22% | Time: 0.0308s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0709, Acc: 98.93%
测试 - Loss: 1.2296, Acc: 69.65%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/49] Loss: 0.0487 | Acc: 99.61% | Time: 0.0293s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0658, Acc: 99.08%
测试 - Loss: 1.2330, Acc: 69.74%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/49] Loss: 0.0531 | Acc: 99.61% | Time: 0.0346s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0640, Acc: 99.16%
测试 - Loss: 1.2334, Acc: 69.70%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/49] Loss: 0.0469 | Acc: 100.00% | Time: 0.0314s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0607, Acc: 99.28%
测试 - Loss: 1.2386, Acc: 69.61%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/49] Loss: 0.0559 | Acc: 99.22% | Time: 0.0303s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0588, Acc: 99.18%
测试 - Loss: 1.2406, Acc: 69.70%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/49] Loss: 0.0487 | Acc: 99.61% | Time: 0.0333s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0559, Acc: 99.32%
测试 - Loss: 1.2456, Acc: 69.51%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/49] Loss: 0.0411 | Acc: 99.61% | Time: 0.0376s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0515, Acc: 99.46%
测试 - Loss: 1.2461, Acc: 69.57%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/49] Loss: 0.0504 | Acc: 100.00% | Time: 0.0286s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0520, Acc: 99.43%
测试 - Loss: 1.2470, Acc: 69.72%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/49] Loss: 0.0495 | Acc: 99.61% | Time: 0.0309s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0481, Acc: 99.50%
测试 - Loss: 1.2471, Acc: 69.69%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/49] Loss: 0.0494 | Acc: 99.61% | Time: 0.0363s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0456, Acc: 99.54%
测试 - Loss: 1.2459, Acc: 69.89%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/49] Loss: 0.0389 | Acc: 100.00% | Time: 0.0310s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0438, Acc: 99.50%
测试 - Loss: 1.2478, Acc: 69.94%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/49] Loss: 0.0484 | Acc: 99.61% | Time: 0.0378s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0427, Acc: 99.65%
测试 - Loss: 1.2532, Acc: 69.68%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/49] Loss: 0.0366 | Acc: 100.00% | Time: 0.0364s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0408, Acc: 99.70%
测试 - Loss: 1.2513, Acc: 69.56%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/49] Loss: 0.0349 | Acc: 100.00% | Time: 0.0370s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0397, Acc: 99.64%
测试 - Loss: 1.2547, Acc: 69.44%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/49] Loss: 0.0452 | Acc: 99.61% | Time: 0.0347s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0387, Acc: 99.68%
测试 - Loss: 1.2538, Acc: 69.70%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/49] Loss: 0.0309 | Acc: 100.00% | Time: 0.0381s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0392, Acc: 99.69%
测试 - Loss: 1.2521, Acc: 69.74%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/49] Loss: 0.0369 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0361, Acc: 99.75%
测试 - Loss: 1.2570, Acc: 69.64%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/49] Loss: 0.0305 | Acc: 99.61% | Time: 0.0289s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0358, Acc: 99.71%
测试 - Loss: 1.2586, Acc: 69.72%
学习率: 0.010000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/49] Loss: 0.0339 | Acc: 99.61% | Time: 0.0394s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0347, Acc: 99.67%
测试 - Loss: 1.2549, Acc: 69.79%
学习率: 0.010000, 时间: 5.63s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/49] Loss: 0.0439 | Acc: 99.22% | Time: 0.0262s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0330, Acc: 99.74%
测试 - Loss: 1.2539, Acc: 70.01%
学习率: 0.010000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 69.99% -> 70.01%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/49] Loss: 0.0347 | Acc: 100.00% | Time: 0.0361s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0318, Acc: 99.75%
测试 - Loss: 1.2576, Acc: 69.70%
学习率: 0.010000, 时间: 5.60s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/49] Loss: 0.0327 | Acc: 100.00% | Time: 0.0343s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0321, Acc: 99.82%
测试 - Loss: 1.2590, Acc: 69.69%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/49] Loss: 0.0372 | Acc: 99.61% | Time: 0.0348s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0317, Acc: 99.78%
测试 - Loss: 1.2597, Acc: 70.01%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/49] Loss: 0.0260 | Acc: 100.00% | Time: 0.0401s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0296, Acc: 99.84%
测试 - Loss: 1.2611, Acc: 69.78%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/49] Loss: 0.0328 | Acc: 100.00% | Time: 0.0328s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0295, Acc: 99.90%
测试 - Loss: 1.2605, Acc: 69.64%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/49] Loss: 0.0269 | Acc: 100.00% | Time: 0.0310s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0283, Acc: 99.87%
测试 - Loss: 1.2634, Acc: 69.91%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/49] Loss: 0.0187 | Acc: 100.00% | Time: 0.0415s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0283, Acc: 99.86%
测试 - Loss: 1.2610, Acc: 69.96%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/49] Loss: 0.0294 | Acc: 100.00% | Time: 0.0336s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0273, Acc: 99.89%
测试 - Loss: 1.2570, Acc: 69.91%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/49] Loss: 0.0312 | Acc: 100.00% | Time: 0.0321s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0285, Acc: 99.82%
测试 - Loss: 1.2687, Acc: 69.69%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/49] Loss: 0.0278 | Acc: 99.61% | Time: 0.0325s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0266, Acc: 99.84%
测试 - Loss: 1.2662, Acc: 69.80%
学习率: 0.010000, 时间: 5.59s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/49] Loss: 0.0230 | Acc: 100.00% | Time: 0.0392s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0268, Acc: 99.90%
测试 - Loss: 1.2634, Acc: 69.84%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/49] Loss: 0.0294 | Acc: 100.00% | Time: 0.0257s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0251, Acc: 99.90%
测试 - Loss: 1.2636, Acc: 69.99%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/49] Loss: 0.0236 | Acc: 100.00% | Time: 0.0334s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0247, Acc: 99.91%
测试 - Loss: 1.2623, Acc: 69.89%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/49] Loss: 0.0253 | Acc: 100.00% | Time: 0.0392s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0241, Acc: 99.91%
测试 - Loss: 1.2609, Acc: 70.07%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 70.01% -> 70.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/49] Loss: 0.0231 | Acc: 99.61% | Time: 0.0355s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0237, Acc: 99.90%
测试 - Loss: 1.2629, Acc: 70.04%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/49] Loss: 0.0238 | Acc: 100.00% | Time: 0.0398s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0230, Acc: 99.90%
测试 - Loss: 1.2635, Acc: 70.19%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
最佳准确率更新: 70.07% -> 70.19%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/49] Loss: 0.0184 | Acc: 100.00% | Time: 0.0333s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0233, Acc: 99.92%
测试 - Loss: 1.2599, Acc: 69.82%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/49] Loss: 0.0229 | Acc: 100.00% | Time: 0.0340s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0228, Acc: 99.90%
测试 - Loss: 1.2599, Acc: 69.76%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/49] Loss: 0.0297 | Acc: 99.61% | Time: 0.0404s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0234, Acc: 99.90%
测试 - Loss: 1.2650, Acc: 69.66%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/49] Loss: 0.0354 | Acc: 100.00% | Time: 0.0323s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0230, Acc: 99.90%
测试 - Loss: 1.2662, Acc: 69.73%
学习率: 0.010000, 时间: 5.57s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/49] Loss: 0.0198 | Acc: 100.00% | Time: 0.0347s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0214, Acc: 99.94%
测试 - Loss: 1.2674, Acc: 69.82%
学习率: 0.010000, 时间: 5.60s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/49] Loss: 0.0193 | Acc: 100.00% | Time: 0.0388s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0215, Acc: 99.93%
测试 - Loss: 1.2706, Acc: 69.69%
学习率: 0.010000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/49] Loss: 0.0193 | Acc: 100.00% | Time: 0.0354s | GPU Mem: 0.29GB/7.00GB

训练 - Loss: 0.0208, Acc: 99.93%
测试 - Loss: 1.2667, Acc: 69.67%
学习率: 0.001000, 时间: 5.58s
GPU内存使用:
  GPU 1 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 2 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 3 - 已分配: 0.29GB, 已保留: 7.00GB
  GPU 5 - 已分配: 0.29GB, 已保留: 7.00GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 762.43秒 (12.71分钟)
平均每epoch: 7.62秒
最佳测试准确率: 70.19%
保存最终模型到: ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs256_gpu4_nw2_chunks0.pth

训练完成!
