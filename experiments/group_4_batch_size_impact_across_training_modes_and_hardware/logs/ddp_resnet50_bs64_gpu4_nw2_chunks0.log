====================================================================================================
Experiment: ddp_resnet50_bs64_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 64,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 64 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs64_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T12:36:21.775477
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 64
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs64_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 256
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 64
有效batch size: 256
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/196] Loss: 4.8589 | Acc: 1.56% | Time: 1.6399s | GPU Mem: 0.28GB/2.06GB
Rank 0 | Epoch: 0 [100/196] Loss: 4.5883 | Acc: 1.49% | Time: 0.0267s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 4.9137, Acc: 1.66%
测试 - Loss: 4.4790, Acc: 3.12%
学习率: 0.100000, 时间: 18.06s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 0.00% -> 3.12%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/196] Loss: 4.4553 | Acc: 1.56% | Time: 0.0324s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 1 [100/196] Loss: 4.1984 | Acc: 4.22% | Time: 0.0274s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 4.2023, Acc: 5.09%
测试 - Loss: 4.0295, Acc: 7.26%
学习率: 0.100000, 时间: 8.21s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 3.12% -> 7.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/196] Loss: 3.9575 | Acc: 10.94% | Time: 0.0386s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 2 [100/196] Loss: 3.7519 | Acc: 7.91% | Time: 0.0262s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 3.9081, Acc: 8.77%
测试 - Loss: 3.8182, Acc: 9.72%
学习率: 0.100000, 时间: 8.17s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 7.26% -> 9.72%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/196] Loss: 3.5194 | Acc: 10.94% | Time: 0.0368s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 3 [100/196] Loss: 3.4487 | Acc: 11.70% | Time: 0.0264s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 3.7030, Acc: 12.10%
测试 - Loss: 3.5995, Acc: 14.05%
学习率: 0.100000, 时间: 8.07s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 9.72% -> 14.05%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/196] Loss: 3.4779 | Acc: 15.62% | Time: 0.0347s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 4 [100/196] Loss: 3.4293 | Acc: 15.45% | Time: 0.0273s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 3.4819, Acc: 16.14%
测试 - Loss: 3.3785, Acc: 18.31%
学习率: 0.100000, 时间: 8.11s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 14.05% -> 18.31%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/196] Loss: 3.5224 | Acc: 14.06% | Time: 0.0395s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 5 [100/196] Loss: 3.2823 | Acc: 19.01% | Time: 0.0253s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 3.2868, Acc: 19.70%
测试 - Loss: 3.1604, Acc: 22.91%
学习率: 0.100000, 时间: 8.12s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 18.31% -> 22.91%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/196] Loss: 2.8895 | Acc: 23.44% | Time: 0.0338s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 6 [100/196] Loss: 3.1718 | Acc: 22.37% | Time: 0.0318s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 3.0654, Acc: 23.32%
测试 - Loss: 3.0855, Acc: 26.00%
学习率: 0.100000, 时间: 8.04s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 22.91% -> 26.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/196] Loss: 3.1275 | Acc: 23.44% | Time: 0.0318s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 7 [100/196] Loss: 3.1837 | Acc: 26.49% | Time: 0.0307s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 2.8774, Acc: 27.30%
测试 - Loss: 2.9175, Acc: 27.65%
学习率: 0.100000, 时间: 8.10s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 26.00% -> 27.65%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/196] Loss: 2.7673 | Acc: 26.56% | Time: 0.0384s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 8 [100/196] Loss: 2.7058 | Acc: 31.56% | Time: 0.0266s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 2.6284, Acc: 32.14%
测试 - Loss: 2.7369, Acc: 32.01%
学习率: 0.100000, 时间: 8.18s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 27.65% -> 32.01%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/196] Loss: 2.4838 | Acc: 32.81% | Time: 0.0343s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 9 [100/196] Loss: 2.5851 | Acc: 33.85% | Time: 0.0252s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 2.4715, Acc: 34.94%
测试 - Loss: 2.5007, Acc: 36.00%
学习率: 0.100000, 时间: 8.09s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 32.01% -> 36.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/196] Loss: 2.4272 | Acc: 39.06% | Time: 0.0361s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 10 [100/196] Loss: 2.5877 | Acc: 37.72% | Time: 0.0275s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 2.2837, Acc: 39.22%
测试 - Loss: 2.3660, Acc: 39.00%
学习率: 0.100000, 时间: 8.04s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 36.00% -> 39.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/196] Loss: 1.9742 | Acc: 48.44% | Time: 0.0349s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 11 [100/196] Loss: 1.8920 | Acc: 41.92% | Time: 0.0255s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 2.1271, Acc: 42.28%
测试 - Loss: 2.8926, Acc: 41.07%
学习率: 0.100000, 时间: 8.14s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 39.00% -> 41.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/196] Loss: 1.9278 | Acc: 45.31% | Time: 0.0307s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 12 [100/196] Loss: 2.4896 | Acc: 46.27% | Time: 0.0255s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 2.0020, Acc: 46.28%
测试 - Loss: 2.1545, Acc: 43.77%
学习率: 0.100000, 时间: 8.23s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 41.07% -> 43.77%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/196] Loss: 1.8229 | Acc: 53.12% | Time: 0.0314s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 13 [100/196] Loss: 1.7917 | Acc: 47.76% | Time: 0.0241s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.8879, Acc: 48.02%
测试 - Loss: 2.0191, Acc: 46.62%
学习率: 0.100000, 时间: 8.21s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 43.77% -> 46.62%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/196] Loss: 1.7368 | Acc: 51.56% | Time: 0.0329s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 14 [100/196] Loss: 1.8582 | Acc: 50.39% | Time: 0.0242s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.7978, Acc: 50.00%
测试 - Loss: 1.9710, Acc: 47.59%
学习率: 0.100000, 时间: 8.18s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 46.62% -> 47.59%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/196] Loss: 1.5259 | Acc: 56.25% | Time: 0.0308s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 15 [100/196] Loss: 1.5119 | Acc: 51.39% | Time: 0.0299s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.7089, Acc: 51.66%
测试 - Loss: 1.8364, Acc: 49.73%
学习率: 0.100000, 时间: 8.19s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 47.59% -> 49.73%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/196] Loss: 1.6421 | Acc: 56.25% | Time: 0.0315s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 16 [100/196] Loss: 1.7646 | Acc: 54.49% | Time: 0.0257s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.6333, Acc: 53.84%
测试 - Loss: 1.8600, Acc: 49.71%
学习率: 0.100000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/196] Loss: 1.5563 | Acc: 62.50% | Time: 0.0267s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 17 [100/196] Loss: 1.4327 | Acc: 56.06% | Time: 0.0294s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.5502, Acc: 55.93%
测试 - Loss: 1.6753, Acc: 54.06%
学习率: 0.100000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 49.73% -> 54.06%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/196] Loss: 1.6695 | Acc: 53.12% | Time: 0.0377s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 18 [100/196] Loss: 1.3704 | Acc: 58.04% | Time: 0.0240s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.4783, Acc: 57.76%
测试 - Loss: 1.6469, Acc: 54.74%
学习率: 0.100000, 时间: 8.17s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 54.06% -> 54.74%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/196] Loss: 1.5356 | Acc: 53.12% | Time: 0.0360s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 19 [100/196] Loss: 1.7099 | Acc: 59.73% | Time: 0.0243s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.4313, Acc: 59.40%
测试 - Loss: 1.7340, Acc: 52.09%
学习率: 0.100000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/196] Loss: 1.3779 | Acc: 67.19% | Time: 0.0330s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 20 [100/196] Loss: 1.4371 | Acc: 61.05% | Time: 0.0258s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.3803, Acc: 60.84%
测试 - Loss: 1.7395, Acc: 52.97%
学习率: 0.100000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/196] Loss: 1.5698 | Acc: 59.38% | Time: 0.0323s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 21 [100/196] Loss: 1.5085 | Acc: 60.94% | Time: 0.0359s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.3501, Acc: 61.19%
测试 - Loss: 1.7110, Acc: 54.73%
学习率: 0.100000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/196] Loss: 1.2526 | Acc: 64.06% | Time: 0.0334s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 22 [100/196] Loss: 1.3366 | Acc: 62.96% | Time: 0.0259s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.2987, Acc: 62.48%
测试 - Loss: 1.6560, Acc: 54.75%
学习率: 0.100000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 54.74% -> 54.75%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/196] Loss: 1.1956 | Acc: 67.19% | Time: 0.0373s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 23 [100/196] Loss: 1.3081 | Acc: 64.22% | Time: 0.0279s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.2498, Acc: 63.74%
测试 - Loss: 1.5484, Acc: 57.23%
学习率: 0.100000, 时间: 8.10s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 54.75% -> 57.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/196] Loss: 1.1440 | Acc: 64.06% | Time: 0.0341s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 24 [100/196] Loss: 1.2009 | Acc: 64.65% | Time: 0.0277s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.2487, Acc: 63.85%
测试 - Loss: 1.6051, Acc: 56.04%
学习率: 0.100000, 时间: 8.12s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/196] Loss: 0.9605 | Acc: 67.19% | Time: 0.0354s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 25 [100/196] Loss: 1.2685 | Acc: 65.59% | Time: 0.0280s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.2014, Acc: 64.90%
测试 - Loss: 1.8572, Acc: 51.79%
学习率: 0.100000, 时间: 8.20s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/196] Loss: 1.1705 | Acc: 67.19% | Time: 0.0288s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 26 [100/196] Loss: 0.5892 | Acc: 67.06% | Time: 0.0331s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.1636, Acc: 66.14%
测试 - Loss: 1.6727, Acc: 55.02%
学习率: 0.100000, 时间: 8.17s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/196] Loss: 1.0568 | Acc: 67.19% | Time: 0.0270s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 27 [100/196] Loss: 0.8497 | Acc: 66.71% | Time: 0.0255s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.1489, Acc: 66.50%
测试 - Loss: 1.6083, Acc: 57.66%
学习率: 0.100000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 57.23% -> 57.66%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/196] Loss: 1.4690 | Acc: 50.00% | Time: 0.0355s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 28 [100/196] Loss: 1.3423 | Acc: 66.58% | Time: 0.0248s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.1428, Acc: 66.58%
测试 - Loss: 1.7028, Acc: 54.73%
学习率: 0.100000, 时间: 8.20s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/196] Loss: 0.8907 | Acc: 73.44% | Time: 0.0298s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 29 [100/196] Loss: 0.9184 | Acc: 68.15% | Time: 0.0254s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0978, Acc: 67.96%
测试 - Loss: 1.6598, Acc: 57.41%
学习率: 0.100000, 时间: 8.13s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/196] Loss: 0.9892 | Acc: 71.88% | Time: 0.0334s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 30 [100/196] Loss: 1.0322 | Acc: 69.12% | Time: 0.0250s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0830, Acc: 67.92%
测试 - Loss: 1.6966, Acc: 56.11%
学习率: 0.100000, 时间: 8.09s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/196] Loss: 1.1460 | Acc: 68.75% | Time: 0.0381s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 31 [100/196] Loss: 1.5281 | Acc: 70.20% | Time: 0.0311s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0785, Acc: 68.66%
测试 - Loss: 1.7253, Acc: 54.23%
学习率: 0.100000, 时间: 8.20s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/196] Loss: 1.0593 | Acc: 71.88% | Time: 0.0358s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 32 [100/196] Loss: 1.0915 | Acc: 69.01% | Time: 0.0306s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0687, Acc: 68.39%
测试 - Loss: 1.7234, Acc: 55.42%
学习率: 0.100000, 时间: 8.31s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/196] Loss: 1.0027 | Acc: 68.75% | Time: 0.0327s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 33 [100/196] Loss: 0.9031 | Acc: 70.24% | Time: 0.0337s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0427, Acc: 69.33%
测试 - Loss: 1.6221, Acc: 57.25%
学习率: 0.100000, 时间: 8.24s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/196] Loss: 0.7094 | Acc: 78.12% | Time: 0.0358s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 34 [100/196] Loss: 0.9824 | Acc: 70.62% | Time: 0.0300s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0276, Acc: 69.80%
测试 - Loss: 1.5448, Acc: 58.03%
学习率: 0.100000, 时间: 8.05s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 57.66% -> 58.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/196] Loss: 0.9260 | Acc: 75.00% | Time: 0.0334s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 35 [100/196] Loss: 1.1316 | Acc: 71.15% | Time: 0.0256s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0037, Acc: 70.34%
测试 - Loss: 1.6252, Acc: 57.22%
学习率: 0.100000, 时间: 8.04s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/196] Loss: 0.9880 | Acc: 70.31% | Time: 0.0341s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 36 [100/196] Loss: 1.0147 | Acc: 71.02% | Time: 0.0301s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0133, Acc: 70.07%
测试 - Loss: 1.5746, Acc: 58.60%
学习率: 0.100000, 时间: 8.20s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 58.03% -> 58.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/196] Loss: 1.0435 | Acc: 71.88% | Time: 0.0318s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 37 [100/196] Loss: 1.3523 | Acc: 69.91% | Time: 0.0271s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 1.0057, Acc: 70.10%
测试 - Loss: 1.6039, Acc: 57.62%
学习率: 0.100000, 时间: 8.20s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/196] Loss: 1.0127 | Acc: 75.00% | Time: 0.0348s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 38 [100/196] Loss: 0.9674 | Acc: 71.40% | Time: 0.0254s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9804, Acc: 70.73%
测试 - Loss: 1.5185, Acc: 59.33%
学习率: 0.100000, 时间: 8.23s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 58.60% -> 59.33%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/196] Loss: 0.8115 | Acc: 76.56% | Time: 0.0363s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 39 [100/196] Loss: 1.0128 | Acc: 72.03% | Time: 0.0303s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9468, Acc: 71.54%
测试 - Loss: 1.6542, Acc: 57.95%
学习率: 0.100000, 时间: 8.14s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/196] Loss: 0.9136 | Acc: 67.19% | Time: 0.0362s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 40 [100/196] Loss: 1.1548 | Acc: 71.69% | Time: 0.0264s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9588, Acc: 71.38%
测试 - Loss: 1.6715, Acc: 56.88%
学习率: 0.100000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/196] Loss: 0.8639 | Acc: 76.56% | Time: 0.0315s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 41 [100/196] Loss: 0.8171 | Acc: 72.68% | Time: 0.0244s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9643, Acc: 71.63%
测试 - Loss: 1.4998, Acc: 59.71%
学习率: 0.100000, 时间: 8.07s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 59.33% -> 59.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/196] Loss: 0.7743 | Acc: 71.88% | Time: 0.0345s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 42 [100/196] Loss: 0.8961 | Acc: 73.72% | Time: 0.0258s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9119, Acc: 72.56%
测试 - Loss: 1.5588, Acc: 59.28%
学习率: 0.100000, 时间: 8.14s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/196] Loss: 0.9064 | Acc: 68.75% | Time: 0.0303s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 43 [100/196] Loss: 0.7949 | Acc: 72.73% | Time: 0.0307s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9381, Acc: 71.94%
测试 - Loss: 1.4787, Acc: 60.82%
学习率: 0.100000, 时间: 8.13s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 59.71% -> 60.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/196] Loss: 0.8346 | Acc: 81.25% | Time: 0.0319s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 44 [100/196] Loss: 0.9257 | Acc: 74.23% | Time: 0.0266s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9211, Acc: 72.50%
测试 - Loss: 1.6528, Acc: 58.29%
学习率: 0.100000, 时间: 8.19s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/196] Loss: 1.0333 | Acc: 65.62% | Time: 0.0299s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 45 [100/196] Loss: 1.0090 | Acc: 73.87% | Time: 0.0339s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9079, Acc: 72.87%
测试 - Loss: 1.5473, Acc: 58.54%
学习率: 0.100000, 时间: 8.08s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/196] Loss: 1.0097 | Acc: 68.75% | Time: 0.0293s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 46 [100/196] Loss: 0.7050 | Acc: 73.55% | Time: 0.0253s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.8927, Acc: 72.80%
测试 - Loss: 1.6908, Acc: 57.43%
学习率: 0.100000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/196] Loss: 0.7913 | Acc: 71.88% | Time: 0.0349s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 47 [100/196] Loss: 0.9264 | Acc: 73.79% | Time: 0.0245s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.9031, Acc: 72.68%
测试 - Loss: 1.5016, Acc: 60.81%
学习率: 0.100000, 时间: 8.12s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/196] Loss: 0.8335 | Acc: 71.88% | Time: 0.0323s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 48 [100/196] Loss: 0.8335 | Acc: 74.33% | Time: 0.0335s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.8871, Acc: 73.52%
测试 - Loss: 1.4298, Acc: 62.41%
学习率: 0.100000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 60.82% -> 62.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/196] Loss: 0.6476 | Acc: 76.56% | Time: 0.0411s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 49 [100/196] Loss: 0.8290 | Acc: 73.87% | Time: 0.0285s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.8727, Acc: 73.58%
测试 - Loss: 1.5641, Acc: 60.36%
学习率: 0.010000, 时间: 8.08s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/196] Loss: 1.0398 | Acc: 68.75% | Time: 0.0341s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 50 [100/196] Loss: 0.7683 | Acc: 82.27% | Time: 0.0245s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.5278, Acc: 84.46%
测试 - Loss: 0.9268, Acc: 73.99%
学习率: 0.010000, 时间: 8.13s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 62.41% -> 73.99%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/196] Loss: 0.5136 | Acc: 84.38% | Time: 0.0308s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 51 [100/196] Loss: 0.4317 | Acc: 89.20% | Time: 0.0246s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.3826, Acc: 89.06%
测试 - Loss: 0.9254, Acc: 74.52%
学习率: 0.010000, 时间: 8.19s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 73.99% -> 74.52%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/196] Loss: 0.3940 | Acc: 87.50% | Time: 0.0375s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 52 [100/196] Loss: 0.2588 | Acc: 90.90% | Time: 0.0307s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.3303, Acc: 90.38%
测试 - Loss: 0.9225, Acc: 74.94%
学习率: 0.010000, 时间: 8.13s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 74.52% -> 74.94%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/196] Loss: 0.2346 | Acc: 93.75% | Time: 0.0427s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 53 [100/196] Loss: 0.3399 | Acc: 92.14% | Time: 0.0304s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.2910, Acc: 91.64%
测试 - Loss: 0.9371, Acc: 74.75%
学习率: 0.010000, 时间: 8.17s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/196] Loss: 0.2477 | Acc: 95.31% | Time: 0.0289s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 54 [100/196] Loss: 0.1603 | Acc: 93.08% | Time: 0.0279s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.2614, Acc: 92.66%
测试 - Loss: 0.9559, Acc: 74.70%
学习率: 0.010000, 时间: 8.20s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/196] Loss: 0.3285 | Acc: 89.06% | Time: 0.0284s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 55 [100/196] Loss: 0.2365 | Acc: 92.91% | Time: 0.0293s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.2450, Acc: 92.94%
测试 - Loss: 0.9576, Acc: 74.98%
学习率: 0.010000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 74.94% -> 74.98%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/196] Loss: 0.2990 | Acc: 92.19% | Time: 0.0371s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 56 [100/196] Loss: 0.2876 | Acc: 94.00% | Time: 0.0283s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.2244, Acc: 93.53%
测试 - Loss: 0.9591, Acc: 74.98%
学习率: 0.010000, 时间: 8.19s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/196] Loss: 0.3172 | Acc: 87.50% | Time: 0.0318s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 57 [100/196] Loss: 0.1500 | Acc: 94.94% | Time: 0.0248s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.2000, Acc: 94.45%
测试 - Loss: 0.9702, Acc: 74.83%
学习率: 0.010000, 时间: 8.12s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/196] Loss: 0.2021 | Acc: 93.75% | Time: 0.0326s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 58 [100/196] Loss: 0.1992 | Acc: 94.83% | Time: 0.0239s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1872, Acc: 94.77%
测试 - Loss: 0.9920, Acc: 75.31%
学习率: 0.010000, 时间: 8.03s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
最佳准确率更新: 74.98% -> 75.31%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/196] Loss: 0.0811 | Acc: 100.00% | Time: 0.0362s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 59 [100/196] Loss: 0.2022 | Acc: 95.30% | Time: 0.0338s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1741, Acc: 95.22%
测试 - Loss: 0.9998, Acc: 75.18%
学习率: 0.010000, 时间: 8.11s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/196] Loss: 0.0904 | Acc: 98.44% | Time: 0.0386s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 60 [100/196] Loss: 0.1789 | Acc: 95.99% | Time: 0.0355s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1668, Acc: 95.42%
测试 - Loss: 1.0036, Acc: 74.50%
学习率: 0.010000, 时间: 8.31s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/196] Loss: 0.0984 | Acc: 100.00% | Time: 0.0348s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 61 [100/196] Loss: 0.2639 | Acc: 96.21% | Time: 0.0325s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1508, Acc: 96.06%
测试 - Loss: 1.0249, Acc: 74.67%
学习率: 0.010000, 时间: 8.21s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/196] Loss: 0.1028 | Acc: 96.88% | Time: 0.0320s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 62 [100/196] Loss: 0.2067 | Acc: 96.21% | Time: 0.0387s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1417, Acc: 96.10%
测试 - Loss: 1.0065, Acc: 75.23%
学习率: 0.010000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/196] Loss: 0.0949 | Acc: 98.44% | Time: 0.0373s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 63 [100/196] Loss: 0.0962 | Acc: 97.03% | Time: 0.0252s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1228, Acc: 96.96%
测试 - Loss: 1.0369, Acc: 74.71%
学习率: 0.010000, 时间: 8.21s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/196] Loss: 0.0852 | Acc: 100.00% | Time: 0.0289s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 64 [100/196] Loss: 0.1549 | Acc: 97.31% | Time: 0.0241s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1106, Acc: 97.29%
测试 - Loss: 1.0460, Acc: 74.77%
学习率: 0.010000, 时间: 8.17s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/196] Loss: 0.1493 | Acc: 96.88% | Time: 0.0306s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 65 [100/196] Loss: 0.2171 | Acc: 97.83% | Time: 0.0294s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1047, Acc: 97.56%
测试 - Loss: 1.0498, Acc: 75.20%
学习率: 0.010000, 时间: 8.18s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/196] Loss: 0.1526 | Acc: 96.88% | Time: 0.0306s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 66 [100/196] Loss: 0.0579 | Acc: 97.77% | Time: 0.0246s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.1020, Acc: 97.48%
测试 - Loss: 1.0656, Acc: 74.45%
学习率: 0.010000, 时间: 8.12s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/196] Loss: 0.1166 | Acc: 95.31% | Time: 0.0275s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 67 [100/196] Loss: 0.0851 | Acc: 97.93% | Time: 0.0263s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0956, Acc: 97.79%
测试 - Loss: 1.0766, Acc: 74.41%
学习率: 0.010000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/196] Loss: 0.0666 | Acc: 100.00% | Time: 0.0254s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 68 [100/196] Loss: 0.0805 | Acc: 97.93% | Time: 0.0251s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0897, Acc: 97.86%
测试 - Loss: 1.0903, Acc: 74.76%
学习率: 0.010000, 时间: 8.25s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/196] Loss: 0.0708 | Acc: 100.00% | Time: 0.0274s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 69 [100/196] Loss: 0.0479 | Acc: 97.45% | Time: 0.0250s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0960, Acc: 97.63%
测试 - Loss: 1.0977, Acc: 74.18%
学习率: 0.010000, 时间: 8.18s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/196] Loss: 0.0572 | Acc: 100.00% | Time: 0.0347s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 70 [100/196] Loss: 0.0672 | Acc: 98.10% | Time: 0.0272s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0831, Acc: 97.92%
测试 - Loss: 1.0978, Acc: 74.35%
学习率: 0.010000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/196] Loss: 0.0497 | Acc: 98.44% | Time: 0.0295s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 71 [100/196] Loss: 0.0814 | Acc: 98.11% | Time: 0.0244s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0802, Acc: 98.21%
测试 - Loss: 1.0881, Acc: 74.87%
学习率: 0.010000, 时间: 8.09s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/196] Loss: 0.0373 | Acc: 100.00% | Time: 0.0291s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 72 [100/196] Loss: 0.0894 | Acc: 98.02% | Time: 0.0246s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0812, Acc: 98.11%
测试 - Loss: 1.1239, Acc: 74.16%
学习率: 0.010000, 时间: 8.09s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/196] Loss: 0.0756 | Acc: 100.00% | Time: 0.0275s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 73 [100/196] Loss: 0.0370 | Acc: 98.56% | Time: 0.0242s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0714, Acc: 98.42%
测试 - Loss: 1.0878, Acc: 74.96%
学习率: 0.010000, 时间: 8.13s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/196] Loss: 0.0351 | Acc: 98.44% | Time: 0.0304s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 74 [100/196] Loss: 0.1046 | Acc: 98.34% | Time: 0.0260s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0717, Acc: 98.32%
测试 - Loss: 1.1211, Acc: 74.45%
学习率: 0.010000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/196] Loss: 0.0324 | Acc: 100.00% | Time: 0.0364s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 75 [100/196] Loss: 0.0811 | Acc: 98.59% | Time: 0.0264s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0703, Acc: 98.46%
测试 - Loss: 1.1098, Acc: 74.44%
学习率: 0.010000, 时间: 8.25s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/196] Loss: 0.0572 | Acc: 100.00% | Time: 0.0289s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 76 [100/196] Loss: 0.0907 | Acc: 98.65% | Time: 0.0258s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0649, Acc: 98.54%
测试 - Loss: 1.1424, Acc: 74.29%
学习率: 0.010000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/196] Loss: 0.0684 | Acc: 98.44% | Time: 0.0288s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 77 [100/196] Loss: 0.0400 | Acc: 98.75% | Time: 0.0259s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0615, Acc: 98.66%
测试 - Loss: 1.1066, Acc: 74.64%
学习率: 0.010000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/196] Loss: 0.0573 | Acc: 98.44% | Time: 0.0338s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 78 [100/196] Loss: 0.0523 | Acc: 98.56% | Time: 0.0260s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0616, Acc: 98.58%
测试 - Loss: 1.1009, Acc: 74.70%
学习率: 0.010000, 时间: 8.09s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/196] Loss: 0.0505 | Acc: 100.00% | Time: 0.0251s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 79 [100/196] Loss: 0.0580 | Acc: 98.93% | Time: 0.0279s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0555, Acc: 98.88%
测试 - Loss: 1.1244, Acc: 74.43%
学习率: 0.010000, 时间: 8.15s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/196] Loss: 0.0656 | Acc: 100.00% | Time: 0.0340s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 80 [100/196] Loss: 0.0391 | Acc: 99.21% | Time: 0.0247s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0505, Acc: 99.02%
测试 - Loss: 1.1568, Acc: 74.24%
学习率: 0.010000, 时间: 8.29s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/196] Loss: 0.0355 | Acc: 98.44% | Time: 0.0317s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 81 [100/196] Loss: 0.0286 | Acc: 98.84% | Time: 0.0283s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0556, Acc: 98.78%
测试 - Loss: 1.1293, Acc: 74.72%
学习率: 0.010000, 时间: 8.17s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/196] Loss: 0.0587 | Acc: 98.44% | Time: 0.0352s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 82 [100/196] Loss: 0.0419 | Acc: 98.87% | Time: 0.0352s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0563, Acc: 98.84%
测试 - Loss: 1.1128, Acc: 74.29%
学习率: 0.010000, 时间: 8.21s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/196] Loss: 0.0595 | Acc: 98.44% | Time: 0.0279s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 83 [100/196] Loss: 0.0638 | Acc: 98.87% | Time: 0.0316s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0548, Acc: 98.88%
测试 - Loss: 1.1327, Acc: 74.32%
学习率: 0.010000, 时间: 8.08s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/196] Loss: 0.0323 | Acc: 98.44% | Time: 0.0266s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 84 [100/196] Loss: 0.0432 | Acc: 98.82% | Time: 0.0265s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0541, Acc: 98.89%
测试 - Loss: 1.1346, Acc: 74.60%
学习率: 0.010000, 时间: 8.09s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/196] Loss: 0.0476 | Acc: 98.44% | Time: 0.0256s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 85 [100/196] Loss: 0.0495 | Acc: 98.93% | Time: 0.0262s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0552, Acc: 98.92%
测试 - Loss: 1.1475, Acc: 74.25%
学习率: 0.010000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/196] Loss: 0.0213 | Acc: 100.00% | Time: 0.0325s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 86 [100/196] Loss: 0.0609 | Acc: 98.92% | Time: 0.0246s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0512, Acc: 98.94%
测试 - Loss: 1.1283, Acc: 74.36%
学习率: 0.010000, 时间: 8.12s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/196] Loss: 0.0641 | Acc: 98.44% | Time: 0.0278s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 87 [100/196] Loss: 0.0553 | Acc: 99.07% | Time: 0.0246s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0499, Acc: 98.94%
测试 - Loss: 1.1509, Acc: 73.87%
学习率: 0.010000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/196] Loss: 0.0467 | Acc: 98.44% | Time: 0.0315s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 88 [100/196] Loss: 0.0406 | Acc: 99.24% | Time: 0.0243s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0485, Acc: 99.06%
测试 - Loss: 1.1543, Acc: 74.42%
学习率: 0.010000, 时间: 8.21s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/196] Loss: 0.0568 | Acc: 98.44% | Time: 0.0304s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 89 [100/196] Loss: 0.0315 | Acc: 98.84% | Time: 0.0243s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0528, Acc: 98.87%
测试 - Loss: 1.1576, Acc: 74.19%
学习率: 0.010000, 时间: 8.07s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/196] Loss: 0.0214 | Acc: 100.00% | Time: 0.0280s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 90 [100/196] Loss: 0.0517 | Acc: 99.09% | Time: 0.0325s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0468, Acc: 99.02%
测试 - Loss: 1.1574, Acc: 74.04%
学习率: 0.010000, 时间: 8.13s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/196] Loss: 0.0438 | Acc: 100.00% | Time: 0.0325s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 91 [100/196] Loss: 0.0473 | Acc: 99.03% | Time: 0.0260s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0492, Acc: 99.05%
测试 - Loss: 1.1422, Acc: 74.11%
学习率: 0.010000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/196] Loss: 0.0741 | Acc: 98.44% | Time: 0.0398s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 92 [100/196] Loss: 0.0267 | Acc: 98.99% | Time: 0.0254s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0506, Acc: 98.98%
测试 - Loss: 1.1393, Acc: 73.92%
学习率: 0.010000, 时间: 8.05s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/196] Loss: 0.0756 | Acc: 95.31% | Time: 0.0334s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 93 [100/196] Loss: 0.0747 | Acc: 98.82% | Time: 0.0256s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0540, Acc: 98.74%
测试 - Loss: 1.1486, Acc: 73.94%
学习率: 0.010000, 时间: 8.06s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/196] Loss: 0.0470 | Acc: 98.44% | Time: 0.0348s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 94 [100/196] Loss: 0.0561 | Acc: 99.20% | Time: 0.0263s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0479, Acc: 99.01%
测试 - Loss: 1.1691, Acc: 73.72%
学习率: 0.010000, 时间: 8.25s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/196] Loss: 0.0309 | Acc: 100.00% | Time: 0.0271s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 95 [100/196] Loss: 0.0653 | Acc: 98.89% | Time: 0.0267s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0501, Acc: 98.93%
测试 - Loss: 1.1672, Acc: 73.62%
学习率: 0.010000, 时间: 8.18s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/196] Loss: 0.0392 | Acc: 100.00% | Time: 0.0312s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 96 [100/196] Loss: 0.0435 | Acc: 98.95% | Time: 0.0250s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0550, Acc: 98.83%
测试 - Loss: 1.1854, Acc: 73.75%
学习率: 0.010000, 时间: 8.22s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/196] Loss: 0.0502 | Acc: 98.44% | Time: 0.0289s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 97 [100/196] Loss: 0.0631 | Acc: 98.81% | Time: 0.0256s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0557, Acc: 98.79%
测试 - Loss: 1.1777, Acc: 73.66%
学习率: 0.010000, 时间: 8.14s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/196] Loss: 0.0546 | Acc: 98.44% | Time: 0.0353s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 98 [100/196] Loss: 0.0525 | Acc: 98.70% | Time: 0.0263s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0541, Acc: 98.82%
测试 - Loss: 1.1901, Acc: 73.83%
学习率: 0.010000, 时间: 8.16s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/196] Loss: 0.0220 | Acc: 100.00% | Time: 0.0311s | GPU Mem: 0.28GB/2.31GB
Rank 0 | Epoch: 99 [100/196] Loss: 0.0494 | Acc: 98.95% | Time: 0.0331s | GPU Mem: 0.28GB/2.31GB

训练 - Loss: 0.0505, Acc: 98.94%
测试 - Loss: 1.1906, Acc: 73.34%
学习率: 0.001000, 时间: 8.14s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 2 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 3 - 已分配: 0.28GB, 已保留: 2.31GB
  GPU 5 - 已分配: 0.28GB, 已保留: 2.31GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 950.51秒 (15.84分钟)
平均每epoch: 9.51秒
最佳测试准确率: 75.31%
保存最终模型到: ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs64_gpu4_nw2_chunks0.pth

训练完成!
