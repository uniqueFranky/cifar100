====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T12:52:31.370322
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.8089 | Acc: 0.00% | Time: 1.3785s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.9204, Acc: 1.74%
测试 - Loss: 4.4741, Acc: 2.92%
学习率: 0.100000, 时间: 15.35s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 2.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.4175 | Acc: 3.91% | Time: 0.0425s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.2118, Acc: 4.87%
测试 - Loss: 4.1655, Acc: 5.15%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 2.92% -> 5.15%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.0851 | Acc: 8.59% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.9820, Acc: 7.46%
测试 - Loss: 3.9632, Acc: 7.50%
学习率: 0.100000, 时间: 5.95s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 5.15% -> 7.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.6476 | Acc: 12.50% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.7873, Acc: 10.70%
测试 - Loss: 3.6515, Acc: 13.04%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 7.50% -> 13.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.6086 | Acc: 12.50% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.5902, Acc: 13.84%
测试 - Loss: 3.5233, Acc: 14.91%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 13.04% -> 14.91%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.5934 | Acc: 10.16% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.3761, Acc: 17.61%
测试 - Loss: 3.2626, Acc: 20.08%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 14.91% -> 20.08%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.1134 | Acc: 19.53% | Time: 0.0388s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.1696, Acc: 21.36%
测试 - Loss: 3.0909, Acc: 23.79%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 20.08% -> 23.79%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.0634 | Acc: 26.56% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.9316, Acc: 25.70%
测试 - Loss: 2.8980, Acc: 26.42%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 23.79% -> 26.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 2.6761 | Acc: 29.69% | Time: 0.0353s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.6618, Acc: 31.14%
测试 - Loss: 2.6094, Acc: 32.61%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 26.42% -> 32.61%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.4298 | Acc: 39.84% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.4657, Acc: 35.88%
测试 - Loss: 2.5930, Acc: 33.88%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 32.61% -> 33.88%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.4799 | Acc: 34.38% | Time: 0.0365s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2712, Acc: 39.71%
测试 - Loss: 2.2649, Acc: 39.66%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 33.88% -> 39.66%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.1362 | Acc: 47.66% | Time: 0.0353s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0894, Acc: 43.47%
测试 - Loss: 2.2180, Acc: 41.43%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 39.66% -> 41.43%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 1.8714 | Acc: 54.69% | Time: 0.0294s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9360, Acc: 47.17%
测试 - Loss: 2.1631, Acc: 43.13%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 41.43% -> 43.13%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 1.7806 | Acc: 50.78% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8355, Acc: 49.18%
测试 - Loss: 1.9411, Acc: 47.11%
学习率: 0.100000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 43.13% -> 47.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.4087 | Acc: 61.72% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7289, Acc: 52.02%
测试 - Loss: 1.9084, Acc: 48.71%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 47.11% -> 48.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.5064 | Acc: 56.25% | Time: 0.0429s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6337, Acc: 54.19%
测试 - Loss: 1.8140, Acc: 50.16%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 48.71% -> 50.16%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.5737 | Acc: 55.47% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5304, Acc: 56.62%
测试 - Loss: 1.7350, Acc: 52.15%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.16% -> 52.15%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.3971 | Acc: 60.16% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4389, Acc: 58.86%
测试 - Loss: 1.7134, Acc: 53.16%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.15% -> 53.16%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.3667 | Acc: 62.50% | Time: 0.0395s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3504, Acc: 61.22%
测试 - Loss: 1.7486, Acc: 53.14%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.1885 | Acc: 61.72% | Time: 0.0253s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3066, Acc: 62.27%
测试 - Loss: 1.6989, Acc: 53.64%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 53.16% -> 53.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.4847 | Acc: 65.62% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2174, Acc: 64.74%
测试 - Loss: 1.5338, Acc: 58.04%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 53.64% -> 58.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.1390 | Acc: 62.50% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2137, Acc: 64.10%
测试 - Loss: 1.5728, Acc: 57.26%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.0605 | Acc: 66.41% | Time: 0.0390s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1236, Acc: 67.12%
测试 - Loss: 1.7053, Acc: 54.39%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.0673 | Acc: 66.41% | Time: 0.0296s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0704, Acc: 68.60%
测试 - Loss: 1.6309, Acc: 57.31%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.7796 | Acc: 76.56% | Time: 0.0308s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0356, Acc: 69.14%
测试 - Loss: 1.6316, Acc: 57.69%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 0.8590 | Acc: 75.00% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9666, Acc: 71.17%
测试 - Loss: 1.5415, Acc: 58.31%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.04% -> 58.31%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 0.9505 | Acc: 67.97% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9378, Acc: 71.67%
测试 - Loss: 1.4402, Acc: 61.19%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.31% -> 61.19%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 0.8340 | Acc: 72.66% | Time: 0.0361s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9011, Acc: 72.41%
测试 - Loss: 1.4893, Acc: 59.79%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.8257 | Acc: 72.66% | Time: 0.0272s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9072, Acc: 72.78%
测试 - Loss: 1.4147, Acc: 61.23%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.19% -> 61.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.8024 | Acc: 71.09% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8474, Acc: 74.57%
测试 - Loss: 1.4601, Acc: 61.64%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.23% -> 61.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.6575 | Acc: 83.59% | Time: 0.0324s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8125, Acc: 75.12%
测试 - Loss: 1.5681, Acc: 59.39%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.6452 | Acc: 78.91% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8032, Acc: 75.74%
测试 - Loss: 1.3922, Acc: 62.56%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.64% -> 62.56%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.7728 | Acc: 71.09% | Time: 0.0355s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7766, Acc: 76.09%
测试 - Loss: 1.4870, Acc: 60.98%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.7250 | Acc: 73.44% | Time: 0.0427s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7376, Acc: 76.98%
测试 - Loss: 1.6027, Acc: 59.36%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.8149 | Acc: 78.12% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7216, Acc: 77.76%
测试 - Loss: 1.5612, Acc: 59.32%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.5093 | Acc: 86.72% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6904, Acc: 78.84%
测试 - Loss: 1.3949, Acc: 63.13%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.56% -> 63.13%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.5613 | Acc: 83.59% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6919, Acc: 78.52%
测试 - Loss: 1.5302, Acc: 61.86%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.7614 | Acc: 73.44% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6711, Acc: 79.59%
测试 - Loss: 1.7800, Acc: 58.35%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.6127 | Acc: 79.69% | Time: 0.0474s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6711, Acc: 79.41%
测试 - Loss: 1.3784, Acc: 63.76%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 63.13% -> 63.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.5394 | Acc: 82.81% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6193, Acc: 81.10%
测试 - Loss: 1.4827, Acc: 63.09%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.6357 | Acc: 81.25% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6178, Acc: 80.94%
测试 - Loss: 1.4719, Acc: 62.39%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.5451 | Acc: 83.59% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6155, Acc: 80.90%
测试 - Loss: 1.6283, Acc: 60.01%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.6508 | Acc: 78.12% | Time: 0.0256s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5910, Acc: 81.61%
测试 - Loss: 1.5428, Acc: 61.91%
学习率: 0.100000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.4693 | Acc: 87.50% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5789, Acc: 81.71%
测试 - Loss: 1.6063, Acc: 61.04%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.3997 | Acc: 88.28% | Time: 0.0265s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5785, Acc: 81.82%
测试 - Loss: 1.5640, Acc: 61.44%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.6358 | Acc: 81.25% | Time: 0.0327s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5659, Acc: 82.43%
测试 - Loss: 1.4912, Acc: 63.08%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.5713 | Acc: 84.38% | Time: 0.0324s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5444, Acc: 82.98%
测试 - Loss: 1.4973, Acc: 61.59%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.5749 | Acc: 80.47% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5486, Acc: 82.68%
测试 - Loss: 1.4466, Acc: 63.70%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4340 | Acc: 85.16% | Time: 0.0343s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5458, Acc: 82.97%
测试 - Loss: 1.4932, Acc: 62.65%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.3314 | Acc: 89.06% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5301, Acc: 83.26%
测试 - Loss: 1.6860, Acc: 60.63%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.4030 | Acc: 87.50% | Time: 0.0415s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2860, Acc: 91.65%
测试 - Loss: 0.9863, Acc: 73.76%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 63.76% -> 73.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1436 | Acc: 97.66% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1753, Acc: 95.46%
测试 - Loss: 0.9786, Acc: 74.38%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.76% -> 74.38%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.1241 | Acc: 94.53% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1390, Acc: 96.58%
测试 - Loss: 0.9829, Acc: 74.62%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.38% -> 74.62%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1116 | Acc: 98.44% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1229, Acc: 97.00%
测试 - Loss: 0.9892, Acc: 74.43%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.0731 | Acc: 98.44% | Time: 0.0375s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1048, Acc: 97.80%
测试 - Loss: 1.0000, Acc: 74.48%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.0810 | Acc: 98.44% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0975, Acc: 97.71%
测试 - Loss: 1.0084, Acc: 74.71%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.62% -> 74.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0744 | Acc: 97.66% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0860, Acc: 98.06%
测试 - Loss: 1.0052, Acc: 74.64%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0732 | Acc: 98.44% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0754, Acc: 98.38%
测试 - Loss: 1.0162, Acc: 74.66%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0696 | Acc: 99.22% | Time: 0.0256s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0733, Acc: 98.54%
测试 - Loss: 1.0221, Acc: 74.73%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.71% -> 74.73%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0646 | Acc: 98.44% | Time: 0.0405s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0687, Acc: 98.72%
测试 - Loss: 1.0408, Acc: 74.57%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0363 | Acc: 100.00% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0616, Acc: 98.86%
测试 - Loss: 1.0347, Acc: 74.61%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0430 | Acc: 100.00% | Time: 0.0361s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0581, Acc: 98.93%
测试 - Loss: 1.0454, Acc: 74.54%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0322 | Acc: 100.00% | Time: 0.0353s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0542, Acc: 99.08%
测试 - Loss: 1.0473, Acc: 74.54%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0678 | Acc: 98.44% | Time: 0.0254s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0493, Acc: 99.21%
测试 - Loss: 1.0603, Acc: 74.63%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0365 | Acc: 99.22% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0479, Acc: 99.22%
测试 - Loss: 1.0551, Acc: 74.97%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.73% -> 74.97%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0428 | Acc: 99.22% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0452, Acc: 99.22%
测试 - Loss: 1.0539, Acc: 74.94%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0372 | Acc: 99.22% | Time: 0.0294s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0441, Acc: 99.24%
测试 - Loss: 1.0620, Acc: 74.70%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0421 | Acc: 99.22% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0395, Acc: 99.37%
测试 - Loss: 1.0599, Acc: 74.92%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0274 | Acc: 100.00% | Time: 0.0301s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0351, Acc: 99.56%
测试 - Loss: 1.0671, Acc: 75.00%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.97% -> 75.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0342 | Acc: 100.00% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0336, Acc: 99.62%
测试 - Loss: 1.0729, Acc: 75.06%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.00% -> 75.06%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0305 | Acc: 99.22% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0325, Acc: 99.55%
测试 - Loss: 1.0791, Acc: 74.90%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0367 | Acc: 98.44% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0333, Acc: 99.51%
测试 - Loss: 1.0836, Acc: 74.76%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0185 | Acc: 100.00% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0320, Acc: 99.54%
测试 - Loss: 1.0825, Acc: 74.68%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0352 | Acc: 99.22% | Time: 0.0318s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0311, Acc: 99.57%
测试 - Loss: 1.0779, Acc: 74.93%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0230 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0284, Acc: 99.62%
测试 - Loss: 1.0843, Acc: 74.80%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0184 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0275, Acc: 99.69%
测试 - Loss: 1.0830, Acc: 74.87%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0229 | Acc: 100.00% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0268, Acc: 99.66%
测试 - Loss: 1.0896, Acc: 74.87%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0203 | Acc: 100.00% | Time: 0.0327s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0250, Acc: 99.74%
测试 - Loss: 1.0960, Acc: 75.09%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.06% -> 75.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0214 | Acc: 100.00% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0231, Acc: 99.85%
测试 - Loss: 1.0955, Acc: 75.10%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.09% -> 75.10%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0189 | Acc: 100.00% | Time: 0.0346s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0245, Acc: 99.70%
测试 - Loss: 1.0953, Acc: 74.83%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0319 | Acc: 99.22% | Time: 0.0360s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0218, Acc: 99.80%
测试 - Loss: 1.0831, Acc: 75.34%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.10% -> 75.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0177 | Acc: 100.00% | Time: 0.0362s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0237, Acc: 99.73%
测试 - Loss: 1.0978, Acc: 75.17%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0290 | Acc: 99.22% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0229, Acc: 99.77%
测试 - Loss: 1.0890, Acc: 75.35%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.34% -> 75.35%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0358 | Acc: 99.22% | Time: 0.0338s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0203, Acc: 99.80%
测试 - Loss: 1.0893, Acc: 75.17%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0170 | Acc: 100.00% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0198, Acc: 99.86%
测试 - Loss: 1.0985, Acc: 75.05%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0193 | Acc: 100.00% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0201, Acc: 99.82%
测试 - Loss: 1.0983, Acc: 75.06%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0100 | Acc: 100.00% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.79%
测试 - Loss: 1.0921, Acc: 75.11%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0114 | Acc: 100.00% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0193, Acc: 99.83%
测试 - Loss: 1.0889, Acc: 75.19%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0339 | Acc: 99.22% | Time: 0.0267s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0181, Acc: 99.83%
测试 - Loss: 1.0905, Acc: 75.46%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.35% -> 75.46%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0215 | Acc: 99.22% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0174, Acc: 99.83%
测试 - Loss: 1.0855, Acc: 75.22%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0124 | Acc: 100.00% | Time: 0.0371s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0176, Acc: 99.83%
测试 - Loss: 1.1010, Acc: 75.12%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0110 | Acc: 100.00% | Time: 0.0270s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0170, Acc: 99.83%
测试 - Loss: 1.0939, Acc: 75.20%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0166 | Acc: 100.00% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0180, Acc: 99.82%
测试 - Loss: 1.0935, Acc: 75.27%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0126 | Acc: 100.00% | Time: 0.0359s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0164, Acc: 99.86%
测试 - Loss: 1.0954, Acc: 75.12%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0093 | Acc: 100.00% | Time: 0.0327s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0170, Acc: 99.84%
测试 - Loss: 1.0917, Acc: 75.23%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0237 | Acc: 99.22% | Time: 0.0401s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0175, Acc: 99.82%
测试 - Loss: 1.0850, Acc: 75.31%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0196 | Acc: 100.00% | Time: 0.0304s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0173, Acc: 99.82%
测试 - Loss: 1.0981, Acc: 75.04%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0226 | Acc: 100.00% | Time: 0.0272s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0143, Acc: 99.92%
测试 - Loss: 1.0885, Acc: 75.21%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0133 | Acc: 100.00% | Time: 0.0253s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0155, Acc: 99.87%
测试 - Loss: 1.0911, Acc: 75.06%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0064 | Acc: 100.00% | Time: 0.0267s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0150, Acc: 99.91%
测试 - Loss: 1.0853, Acc: 75.36%
学习率: 0.001000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 731.59秒 (12.19分钟)
平均每epoch: 7.32秒
最佳测试准确率: 75.46%
保存最终模型到: ./experiments/group_4_batch_size_impact_across_training_modes_and_hardware/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth

训练完成!
