====================================================================================================
Experiment: hp_resnet50_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "hp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    4
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode hp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,4 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/hp_resnet50_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-14T22:48:35.453529
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : hp
  gpu_ids                  : [1, 2, 3, 4]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/hp_resnet50_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 128
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 4: NVIDIA GeForce RTX 4090

使用训练模式: HP

启动混合并行训练...
使用 4 个GPU: [1, 2, 3, 4]
模型实例数: 2
每个模型使用GPU数: 2
每个GPU的batch size: 128
有效batch size: 128
  模型 0: GPU [1, 2] (主GPU: 1)
  模型 1: GPU [3, 4] (主GPU: 3)

进程 0 开始初始化
GPU组: [1, 2]
主GPU: 1 (用于分布式通信)
模型并行GPU: [1, 2]
进程 0 分布式环境初始化完成
模型并行模型创建完成
设备映射: {'conv1': 'cuda:1', 'bn1': 'cuda:1', 'layer1': 'cuda:1', 'layer2': 'cuda:1', 'layer3': 'cuda:2', 'layer4': 'cuda:2', 'avg_pool': 'cuda:2', 'fc': 'cuda:2'}
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/196] Loss: 4.7945 | Acc: 1.56% | Time: 0.7194s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.29GB
Rank 0 | Epoch: 0 [100/196] Loss: 4.5703 | Acc: 1.39% | Time: 0.0470s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.29GB

训练 - Loss: 4.8988, Acc: 1.72%
测试 - Loss: 4.4344, Acc: 2.67%
学习率: 0.100000, 时间: 27.83s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 0.00% -> 2.67%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/196] Loss: 4.4531 | Acc: 0.00% | Time: 0.0557s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB
Rank 0 | Epoch: 1 [100/196] Loss: 4.3048 | Acc: 3.26% | Time: 0.0431s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 4.2597, Acc: 3.85%
测试 - Loss: 4.0952, Acc: 5.22%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 2.67% -> 5.22%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/196] Loss: 4.2054 | Acc: 7.03% | Time: 0.0541s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB
Rank 0 | Epoch: 2 [100/196] Loss: 3.9321 | Acc: 5.95% | Time: 0.0489s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 4.0200, Acc: 6.55%
测试 - Loss: 3.8731, Acc: 9.15%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 5.22% -> 9.15%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/196] Loss: 3.7022 | Acc: 14.06% | Time: 0.0475s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 3 [100/196] Loss: 3.7027 | Acc: 8.95% | Time: 0.0466s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 3.8265, Acc: 9.61%
测试 - Loss: 3.7337, Acc: 10.95%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 9.15% -> 10.95%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/196] Loss: 3.7670 | Acc: 10.16% | Time: 0.0598s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 4 [100/196] Loss: 3.5978 | Acc: 11.70% | Time: 0.0507s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 3.6403, Acc: 12.33%
测试 - Loss: 3.5578, Acc: 14.69%
学习率: 0.100000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 10.95% -> 14.69%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/196] Loss: 3.5400 | Acc: 12.50% | Time: 0.0565s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 5 [100/196] Loss: 3.4596 | Acc: 15.28% | Time: 0.0463s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 3.4578, Acc: 16.10%
测试 - Loss: 3.3184, Acc: 18.98%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 14.69% -> 18.98%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/196] Loss: 3.1014 | Acc: 25.00% | Time: 0.0532s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 6 [100/196] Loss: 3.2316 | Acc: 19.14% | Time: 0.0470s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 3.2535, Acc: 19.88%
测试 - Loss: 3.2486, Acc: 21.60%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 18.98% -> 21.60%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/196] Loss: 3.2625 | Acc: 21.09% | Time: 0.0627s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 7 [100/196] Loss: 3.1628 | Acc: 22.35% | Time: 0.0485s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 3.0722, Acc: 23.47%
测试 - Loss: 3.0062, Acc: 24.21%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 21.60% -> 24.21%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/196] Loss: 2.9176 | Acc: 26.56% | Time: 0.0581s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 8 [100/196] Loss: 2.8798 | Acc: 26.90% | Time: 0.0477s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 2.8511, Acc: 27.62%
测试 - Loss: 2.9456, Acc: 27.82%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 24.21% -> 27.82%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/196] Loss: 2.7904 | Acc: 21.88% | Time: 0.0586s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 9 [100/196] Loss: 2.5142 | Acc: 30.44% | Time: 0.0498s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 2.6804, Acc: 31.23%
测试 - Loss: 2.6702, Acc: 31.46%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 27.82% -> 31.46%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/196] Loss: 2.6603 | Acc: 32.81% | Time: 0.0557s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 10 [100/196] Loss: 2.7021 | Acc: 34.03% | Time: 0.0491s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 2.4850, Acc: 35.26%
测试 - Loss: 2.5315, Acc: 34.92%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 31.46% -> 34.92%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/196] Loss: 2.3487 | Acc: 38.28% | Time: 0.0562s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 11 [100/196] Loss: 2.0582 | Acc: 37.97% | Time: 0.0521s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 2.2820, Acc: 39.08%
测试 - Loss: 2.3627, Acc: 38.83%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 34.92% -> 38.83%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/196] Loss: 2.2421 | Acc: 40.62% | Time: 0.0745s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 12 [100/196] Loss: 2.1510 | Acc: 42.12% | Time: 0.0481s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 2.1413, Acc: 42.64%
测试 - Loss: 2.2422, Acc: 41.04%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 38.83% -> 41.04%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/196] Loss: 1.9695 | Acc: 45.31% | Time: 0.0544s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 13 [100/196] Loss: 2.0237 | Acc: 44.91% | Time: 0.0537s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 2.0177, Acc: 45.14%
测试 - Loss: 2.1240, Acc: 43.24%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 41.04% -> 43.24%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/196] Loss: 1.9788 | Acc: 42.19% | Time: 0.0541s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 14 [100/196] Loss: 1.7224 | Acc: 48.32% | Time: 0.0462s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.8974, Acc: 48.11%
测试 - Loss: 1.9750, Acc: 46.54%
学习率: 0.100000, 时间: 18.12s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 43.24% -> 46.54%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/196] Loss: 1.7156 | Acc: 48.44% | Time: 0.0559s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 15 [100/196] Loss: 1.7838 | Acc: 49.40% | Time: 0.0459s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.8098, Acc: 49.63%
测试 - Loss: 2.1238, Acc: 44.16%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/196] Loss: 1.6992 | Acc: 52.34% | Time: 0.0559s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 16 [100/196] Loss: 1.8552 | Acc: 52.38% | Time: 0.0420s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.7134, Acc: 52.09%
测试 - Loss: 1.8674, Acc: 49.54%
学习率: 0.100000, 时间: 18.06s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 46.54% -> 49.54%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/196] Loss: 1.7099 | Acc: 50.78% | Time: 0.0579s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 17 [100/196] Loss: 1.3741 | Acc: 53.72% | Time: 0.0401s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.6553, Acc: 53.43%
测试 - Loss: 1.8717, Acc: 49.73%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 49.54% -> 49.73%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/196] Loss: 1.7798 | Acc: 50.78% | Time: 0.0495s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 18 [100/196] Loss: 1.4402 | Acc: 55.54% | Time: 0.0460s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.5805, Acc: 55.63%
测试 - Loss: 1.8766, Acc: 49.29%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/196] Loss: 1.4376 | Acc: 60.16% | Time: 0.0533s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 19 [100/196] Loss: 1.6133 | Acc: 56.33% | Time: 0.0500s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.5304, Acc: 56.42%
测试 - Loss: 1.8675, Acc: 49.18%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/196] Loss: 1.2905 | Acc: 64.84% | Time: 0.0520s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 20 [100/196] Loss: 1.4347 | Acc: 58.78% | Time: 0.0456s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.4592, Acc: 58.70%
测试 - Loss: 1.8233, Acc: 51.16%
学习率: 0.100000, 时间: 18.05s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 49.73% -> 51.16%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/196] Loss: 1.5451 | Acc: 54.69% | Time: 0.0488s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 21 [100/196] Loss: 1.3857 | Acc: 59.28% | Time: 0.0518s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.4279, Acc: 58.91%
测试 - Loss: 1.6618, Acc: 54.24%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 51.16% -> 54.24%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/196] Loss: 1.1145 | Acc: 68.75% | Time: 0.0557s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 22 [100/196] Loss: 1.4485 | Acc: 61.01% | Time: 0.0471s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.3883, Acc: 60.24%
测试 - Loss: 1.7044, Acc: 52.95%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/196] Loss: 1.3130 | Acc: 60.94% | Time: 0.0513s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 23 [100/196] Loss: 1.2601 | Acc: 61.97% | Time: 0.0471s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.3282, Acc: 61.61%
测试 - Loss: 1.9628, Acc: 49.37%
学习率: 0.100000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/196] Loss: 1.2189 | Acc: 64.06% | Time: 0.0567s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 24 [100/196] Loss: 1.2603 | Acc: 62.58% | Time: 0.0450s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.3147, Acc: 62.07%
测试 - Loss: 1.8013, Acc: 52.76%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/196] Loss: 1.1978 | Acc: 65.62% | Time: 0.0494s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 25 [100/196] Loss: 1.3222 | Acc: 63.71% | Time: 0.0454s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.2782, Acc: 62.99%
测试 - Loss: 1.8735, Acc: 51.74%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/196] Loss: 1.2293 | Acc: 62.50% | Time: 0.0574s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 26 [100/196] Loss: 1.1488 | Acc: 65.08% | Time: 0.0499s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.2435, Acc: 64.14%
测试 - Loss: 1.6370, Acc: 55.94%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 54.24% -> 55.94%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/196] Loss: 1.1978 | Acc: 64.84% | Time: 0.0540s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 27 [100/196] Loss: 1.0141 | Acc: 65.33% | Time: 0.0474s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.2007, Acc: 64.94%
测试 - Loss: 1.7111, Acc: 54.71%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/196] Loss: 1.4481 | Acc: 54.69% | Time: 0.0497s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 28 [100/196] Loss: 1.3715 | Acc: 65.22% | Time: 0.0488s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.2002, Acc: 65.08%
测试 - Loss: 1.6640, Acc: 55.80%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/196] Loss: 1.1437 | Acc: 65.62% | Time: 0.0455s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 29 [100/196] Loss: 0.9988 | Acc: 67.41% | Time: 0.0541s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.1537, Acc: 66.42%
测试 - Loss: 1.7116, Acc: 54.60%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/196] Loss: 0.9846 | Acc: 71.09% | Time: 0.0586s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 30 [100/196] Loss: 1.1687 | Acc: 67.71% | Time: 0.0490s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.1393, Acc: 66.55%
测试 - Loss: 1.6995, Acc: 54.99%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/196] Loss: 1.1230 | Acc: 70.31% | Time: 0.0555s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 31 [100/196] Loss: 1.3621 | Acc: 67.33% | Time: 0.0455s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.1251, Acc: 66.66%
测试 - Loss: 1.8595, Acc: 52.43%
学习率: 0.100000, 时间: 18.12s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/196] Loss: 1.0881 | Acc: 71.09% | Time: 0.0516s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 32 [100/196] Loss: 0.9711 | Acc: 68.68% | Time: 0.0517s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.0945, Acc: 67.86%
测试 - Loss: 1.9205, Acc: 51.83%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/196] Loss: 1.2530 | Acc: 64.84% | Time: 0.0521s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 33 [100/196] Loss: 1.0075 | Acc: 69.35% | Time: 0.0516s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.0719, Acc: 68.54%
测试 - Loss: 1.8158, Acc: 52.64%
学习率: 0.100000, 时间: 18.05s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/196] Loss: 0.9711 | Acc: 73.44% | Time: 0.0517s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 34 [100/196] Loss: 0.8602 | Acc: 69.94% | Time: 0.0525s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.0591, Acc: 68.83%
测试 - Loss: 1.8434, Acc: 53.33%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/196] Loss: 1.1040 | Acc: 70.31% | Time: 0.0480s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 35 [100/196] Loss: 1.0906 | Acc: 69.35% | Time: 0.0456s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.0513, Acc: 68.80%
测试 - Loss: 1.6021, Acc: 57.39%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 55.94% -> 57.39%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/196] Loss: 0.9713 | Acc: 68.75% | Time: 0.0529s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 36 [100/196] Loss: 0.8881 | Acc: 69.83% | Time: 0.0483s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.0391, Acc: 69.19%
测试 - Loss: 1.7662, Acc: 53.82%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/196] Loss: 1.1280 | Acc: 62.50% | Time: 0.0510s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 37 [100/196] Loss: 0.9867 | Acc: 70.12% | Time: 0.0435s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 1.0288, Acc: 69.70%
测试 - Loss: 1.5071, Acc: 58.99%
学习率: 0.100000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 57.39% -> 58.99%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/196] Loss: 0.8168 | Acc: 75.00% | Time: 0.0538s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 38 [100/196] Loss: 1.0421 | Acc: 70.65% | Time: 0.0462s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9956, Acc: 70.50%
测试 - Loss: 1.6603, Acc: 57.44%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/196] Loss: 0.8970 | Acc: 71.88% | Time: 0.0477s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 39 [100/196] Loss: 0.9732 | Acc: 71.57% | Time: 0.0499s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9776, Acc: 71.19%
测试 - Loss: 1.6523, Acc: 56.72%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/196] Loss: 0.9102 | Acc: 74.22% | Time: 0.0511s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 40 [100/196] Loss: 1.1624 | Acc: 71.49% | Time: 0.0492s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9664, Acc: 71.08%
测试 - Loss: 1.5977, Acc: 57.72%
学习率: 0.100000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/196] Loss: 0.7462 | Acc: 79.69% | Time: 0.0531s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 41 [100/196] Loss: 0.9712 | Acc: 72.15% | Time: 0.0486s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9531, Acc: 71.28%
测试 - Loss: 1.6098, Acc: 57.99%
学习率: 0.100000, 时间: 18.06s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/196] Loss: 0.7039 | Acc: 78.12% | Time: 0.0520s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 42 [100/196] Loss: 0.7765 | Acc: 72.83% | Time: 0.0450s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9412, Acc: 72.12%
测试 - Loss: 1.5729, Acc: 59.04%
学习率: 0.100000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 58.99% -> 59.04%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/196] Loss: 0.9240 | Acc: 71.09% | Time: 0.0582s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 43 [100/196] Loss: 0.9420 | Acc: 73.19% | Time: 0.0440s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9251, Acc: 72.41%
测试 - Loss: 1.5275, Acc: 59.10%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 59.04% -> 59.10%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/196] Loss: 0.9117 | Acc: 75.78% | Time: 0.0553s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 44 [100/196] Loss: 0.9526 | Acc: 72.88% | Time: 0.0479s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9365, Acc: 71.98%
测试 - Loss: 1.5266, Acc: 59.54%
学习率: 0.100000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 59.10% -> 59.54%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/196] Loss: 1.0339 | Acc: 68.75% | Time: 0.0603s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 45 [100/196] Loss: 1.2508 | Acc: 73.82% | Time: 0.0491s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9096, Acc: 72.81%
测试 - Loss: 1.5557, Acc: 59.35%
学习率: 0.100000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/196] Loss: 0.8616 | Acc: 73.44% | Time: 0.0634s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 46 [100/196] Loss: 0.9094 | Acc: 73.68% | Time: 0.0530s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9083, Acc: 72.78%
测试 - Loss: 1.7458, Acc: 55.34%
学习率: 0.100000, 时间: 18.19s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/196] Loss: 0.8182 | Acc: 76.56% | Time: 0.0570s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 47 [100/196] Loss: 0.9097 | Acc: 73.34% | Time: 0.0456s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9105, Acc: 72.66%
测试 - Loss: 1.4711, Acc: 60.98%
学习率: 0.100000, 时间: 18.21s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 59.54% -> 60.98%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/196] Loss: 0.7765 | Acc: 76.56% | Time: 0.0552s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 48 [100/196] Loss: 0.9409 | Acc: 73.24% | Time: 0.0503s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.9038, Acc: 72.69%
测试 - Loss: 1.5882, Acc: 59.17%
学习率: 0.100000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/196] Loss: 0.6379 | Acc: 84.38% | Time: 0.0564s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 49 [100/196] Loss: 0.8225 | Acc: 74.87% | Time: 0.0436s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.8864, Acc: 73.51%
测试 - Loss: 1.5880, Acc: 58.20%
学习率: 0.010000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/196] Loss: 0.6611 | Acc: 82.03% | Time: 0.0577s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 50 [100/196] Loss: 0.6518 | Acc: 82.76% | Time: 0.0625s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.5251, Acc: 84.57%
测试 - Loss: 0.9421, Acc: 72.66%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 60.98% -> 72.66%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/196] Loss: 0.3586 | Acc: 92.19% | Time: 0.0673s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 51 [100/196] Loss: 0.3496 | Acc: 88.87% | Time: 0.0552s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.3837, Acc: 88.77%
测试 - Loss: 0.9434, Acc: 73.17%
学习率: 0.010000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 72.66% -> 73.17%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/196] Loss: 0.3838 | Acc: 86.72% | Time: 0.0490s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 52 [100/196] Loss: 0.3157 | Acc: 89.87% | Time: 0.0488s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.3388, Acc: 89.92%
测试 - Loss: 0.9378, Acc: 73.66%
学习率: 0.010000, 时间: 18.15s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 73.17% -> 73.66%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/196] Loss: 0.3740 | Acc: 88.28% | Time: 0.0449s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 53 [100/196] Loss: 0.2807 | Acc: 91.65% | Time: 0.0483s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.2942, Acc: 91.46%
测试 - Loss: 0.9446, Acc: 73.65%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/196] Loss: 0.2391 | Acc: 93.75% | Time: 0.0470s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 54 [100/196] Loss: 0.1586 | Acc: 92.65% | Time: 0.0512s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.2638, Acc: 92.49%
测试 - Loss: 0.9620, Acc: 73.59%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/196] Loss: 0.2503 | Acc: 90.62% | Time: 0.0454s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 55 [100/196] Loss: 0.2380 | Acc: 93.11% | Time: 0.0631s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.2446, Acc: 92.81%
测试 - Loss: 0.9740, Acc: 73.88%
学习率: 0.010000, 时间: 18.18s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 73.66% -> 73.88%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/196] Loss: 0.2233 | Acc: 92.19% | Time: 0.0506s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 56 [100/196] Loss: 0.2184 | Acc: 94.09% | Time: 0.0490s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.2184, Acc: 93.74%
测试 - Loss: 0.9814, Acc: 73.79%
学习率: 0.010000, 时间: 18.22s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/196] Loss: 0.1860 | Acc: 93.75% | Time: 0.0471s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 57 [100/196] Loss: 0.1877 | Acc: 94.62% | Time: 0.0511s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1973, Acc: 94.27%
测试 - Loss: 1.0012, Acc: 73.58%
学习率: 0.010000, 时间: 18.12s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/196] Loss: 0.1549 | Acc: 95.31% | Time: 0.0507s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 58 [100/196] Loss: 0.1504 | Acc: 95.02% | Time: 0.0450s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1818, Acc: 94.93%
测试 - Loss: 1.0182, Acc: 73.43%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/196] Loss: 0.1194 | Acc: 97.66% | Time: 0.0547s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 59 [100/196] Loss: 0.2058 | Acc: 95.41% | Time: 0.0521s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1706, Acc: 95.26%
测试 - Loss: 1.0233, Acc: 73.89%
学习率: 0.010000, 时间: 18.14s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
最佳准确率更新: 73.88% -> 73.89%
保存最佳模型到: ./checkpoints/best_model_hybrid.pth
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/196] Loss: 0.1271 | Acc: 97.66% | Time: 0.0590s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 60 [100/196] Loss: 0.1404 | Acc: 96.20% | Time: 0.0418s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1507, Acc: 95.87%
测试 - Loss: 1.0429, Acc: 73.04%
学习率: 0.010000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/196] Loss: 0.0734 | Acc: 99.22% | Time: 0.0504s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 61 [100/196] Loss: 0.1744 | Acc: 96.23% | Time: 0.0440s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1419, Acc: 96.26%
测试 - Loss: 1.0464, Acc: 73.63%
学习率: 0.010000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/196] Loss: 0.0738 | Acc: 100.00% | Time: 0.0437s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 62 [100/196] Loss: 0.1729 | Acc: 96.60% | Time: 0.0462s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1288, Acc: 96.60%
测试 - Loss: 1.0666, Acc: 73.17%
学习率: 0.010000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/196] Loss: 0.1045 | Acc: 96.88% | Time: 0.0504s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 63 [100/196] Loss: 0.0941 | Acc: 97.29% | Time: 0.0486s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1164, Acc: 97.02%
测试 - Loss: 1.0946, Acc: 73.08%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/196] Loss: 0.0972 | Acc: 96.88% | Time: 0.0477s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 64 [100/196] Loss: 0.1238 | Acc: 97.14% | Time: 0.0442s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1088, Acc: 97.18%
测试 - Loss: 1.0986, Acc: 73.24%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/196] Loss: 0.1087 | Acc: 97.66% | Time: 0.0493s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 65 [100/196] Loss: 0.0849 | Acc: 97.70% | Time: 0.0491s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.1000, Acc: 97.56%
测试 - Loss: 1.0887, Acc: 73.21%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/196] Loss: 0.1099 | Acc: 99.22% | Time: 0.0474s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 66 [100/196] Loss: 0.0620 | Acc: 98.13% | Time: 0.0471s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0925, Acc: 97.85%
测试 - Loss: 1.1187, Acc: 73.03%
学习率: 0.010000, 时间: 18.13s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/196] Loss: 0.0702 | Acc: 99.22% | Time: 0.0437s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 67 [100/196] Loss: 0.1496 | Acc: 98.10% | Time: 0.0473s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0887, Acc: 97.96%
测试 - Loss: 1.1307, Acc: 73.53%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/196] Loss: 0.0410 | Acc: 99.22% | Time: 0.0486s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 68 [100/196] Loss: 0.0715 | Acc: 98.10% | Time: 0.0508s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0840, Acc: 97.94%
测试 - Loss: 1.1417, Acc: 73.35%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/196] Loss: 0.0968 | Acc: 97.66% | Time: 0.0473s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 69 [100/196] Loss: 0.0598 | Acc: 98.21% | Time: 0.0440s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0823, Acc: 98.10%
测试 - Loss: 1.1397, Acc: 73.05%
学习率: 0.010000, 时间: 18.11s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/196] Loss: 0.0580 | Acc: 100.00% | Time: 0.0573s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 70 [100/196] Loss: 0.0397 | Acc: 98.41% | Time: 0.0441s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0723, Acc: 98.36%
测试 - Loss: 1.1621, Acc: 73.20%
学习率: 0.010000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/196] Loss: 0.0779 | Acc: 96.88% | Time: 0.0461s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 71 [100/196] Loss: 0.0699 | Acc: 98.40% | Time: 0.0587s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0710, Acc: 98.32%
测试 - Loss: 1.1606, Acc: 72.96%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/196] Loss: 0.0466 | Acc: 100.00% | Time: 0.0514s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 72 [100/196] Loss: 0.0405 | Acc: 98.65% | Time: 0.0462s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0669, Acc: 98.57%
测试 - Loss: 1.1444, Acc: 73.06%
学习率: 0.010000, 时间: 18.06s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/196] Loss: 0.0694 | Acc: 96.88% | Time: 0.0565s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 73 [100/196] Loss: 0.0321 | Acc: 98.59% | Time: 0.0449s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0642, Acc: 98.56%
测试 - Loss: 1.1546, Acc: 73.52%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/196] Loss: 0.0509 | Acc: 98.44% | Time: 0.0495s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 74 [100/196] Loss: 0.0482 | Acc: 98.73% | Time: 0.0491s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0625, Acc: 98.57%
测试 - Loss: 1.1705, Acc: 73.07%
学习率: 0.010000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/196] Loss: 0.0639 | Acc: 98.44% | Time: 0.0574s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 75 [100/196] Loss: 0.0744 | Acc: 98.84% | Time: 0.0474s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0582, Acc: 98.76%
测试 - Loss: 1.1580, Acc: 73.64%
学习率: 0.010000, 时间: 18.13s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/196] Loss: 0.0616 | Acc: 98.44% | Time: 0.0519s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 76 [100/196] Loss: 0.0531 | Acc: 98.92% | Time: 0.0496s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0539, Acc: 98.85%
测试 - Loss: 1.1673, Acc: 72.93%
学习率: 0.010000, 时间: 18.13s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/196] Loss: 0.0416 | Acc: 99.22% | Time: 0.0568s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 77 [100/196] Loss: 0.0865 | Acc: 99.03% | Time: 0.0461s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0526, Acc: 98.92%
测试 - Loss: 1.1780, Acc: 73.06%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/196] Loss: 0.0296 | Acc: 100.00% | Time: 0.0549s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 78 [100/196] Loss: 0.0680 | Acc: 98.81% | Time: 0.0463s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0551, Acc: 98.76%
测试 - Loss: 1.1713, Acc: 73.22%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/196] Loss: 0.0402 | Acc: 98.44% | Time: 0.0530s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 79 [100/196] Loss: 0.0487 | Acc: 98.92% | Time: 0.0495s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0502, Acc: 98.94%
测试 - Loss: 1.1858, Acc: 73.21%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/196] Loss: 0.0249 | Acc: 100.00% | Time: 0.0586s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 80 [100/196] Loss: 0.0376 | Acc: 98.99% | Time: 0.0473s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0520, Acc: 98.86%
测试 - Loss: 1.1917, Acc: 72.91%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/196] Loss: 0.0453 | Acc: 99.22% | Time: 0.0454s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 81 [100/196] Loss: 0.0485 | Acc: 99.04% | Time: 0.0504s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0492, Acc: 99.03%
测试 - Loss: 1.1923, Acc: 72.77%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/196] Loss: 0.0324 | Acc: 100.00% | Time: 0.0500s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 82 [100/196] Loss: 0.0407 | Acc: 99.16% | Time: 0.0460s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0509, Acc: 98.96%
测试 - Loss: 1.2021, Acc: 72.70%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/196] Loss: 0.0618 | Acc: 97.66% | Time: 0.0533s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 83 [100/196] Loss: 0.0488 | Acc: 99.05% | Time: 0.0560s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0471, Acc: 98.98%
测试 - Loss: 1.1998, Acc: 73.01%
学习率: 0.010000, 时间: 18.16s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/196] Loss: 0.0667 | Acc: 96.09% | Time: 0.0519s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 84 [100/196] Loss: 0.0304 | Acc: 99.06% | Time: 0.0488s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0473, Acc: 98.99%
测试 - Loss: 1.2019, Acc: 72.98%
学习率: 0.010000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/196] Loss: 0.0270 | Acc: 100.00% | Time: 0.0593s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 85 [100/196] Loss: 0.0318 | Acc: 98.95% | Time: 0.0501s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0510, Acc: 98.87%
测试 - Loss: 1.2234, Acc: 72.40%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/196] Loss: 0.0450 | Acc: 98.44% | Time: 0.0500s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 86 [100/196] Loss: 0.0357 | Acc: 99.07% | Time: 0.0446s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0445, Acc: 99.13%
测试 - Loss: 1.2110, Acc: 73.30%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/196] Loss: 0.0329 | Acc: 99.22% | Time: 0.0557s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 87 [100/196] Loss: 0.0308 | Acc: 99.24% | Time: 0.0467s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0438, Acc: 99.18%
测试 - Loss: 1.2044, Acc: 72.91%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/196] Loss: 0.0211 | Acc: 100.00% | Time: 0.0701s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 88 [100/196] Loss: 0.0352 | Acc: 99.25% | Time: 0.0382s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0432, Acc: 99.20%
测试 - Loss: 1.2018, Acc: 72.98%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/196] Loss: 0.0320 | Acc: 99.22% | Time: 0.0573s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 89 [100/196] Loss: 0.0319 | Acc: 98.98% | Time: 0.0442s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0447, Acc: 99.04%
测试 - Loss: 1.2105, Acc: 72.99%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/196] Loss: 0.0632 | Acc: 97.66% | Time: 0.0638s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 90 [100/196] Loss: 0.0611 | Acc: 99.04% | Time: 0.0540s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0444, Acc: 99.09%
测试 - Loss: 1.2049, Acc: 73.00%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/196] Loss: 0.0326 | Acc: 100.00% | Time: 0.0542s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 91 [100/196] Loss: 0.0683 | Acc: 99.01% | Time: 0.0579s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0458, Acc: 98.98%
测试 - Loss: 1.1867, Acc: 72.88%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/196] Loss: 0.0232 | Acc: 100.00% | Time: 0.0498s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 92 [100/196] Loss: 0.0313 | Acc: 99.16% | Time: 0.0398s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0447, Acc: 99.13%
测试 - Loss: 1.2036, Acc: 72.86%
学习率: 0.010000, 时间: 18.10s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/196] Loss: 0.0286 | Acc: 100.00% | Time: 0.0504s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 93 [100/196] Loss: 0.0978 | Acc: 99.09% | Time: 0.0467s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0464, Acc: 99.07%
测试 - Loss: 1.2224, Acc: 72.31%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/196] Loss: 0.0370 | Acc: 100.00% | Time: 0.0522s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 94 [100/196] Loss: 0.0670 | Acc: 99.06% | Time: 0.0461s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0462, Acc: 99.06%
测试 - Loss: 1.2203, Acc: 72.31%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/196] Loss: 0.0373 | Acc: 99.22% | Time: 0.0542s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 95 [100/196] Loss: 0.0739 | Acc: 99.16% | Time: 0.0461s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0420, Acc: 99.15%
测试 - Loss: 1.2208, Acc: 72.87%
学习率: 0.010000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/196] Loss: 0.0415 | Acc: 100.00% | Time: 0.0450s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 96 [100/196] Loss: 0.0745 | Acc: 99.05% | Time: 0.0446s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0465, Acc: 99.04%
测试 - Loss: 1.2207, Acc: 72.17%
学习率: 0.010000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/196] Loss: 0.0534 | Acc: 98.44% | Time: 0.0581s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 97 [100/196] Loss: 0.0820 | Acc: 98.93% | Time: 0.0470s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0482, Acc: 98.92%
测试 - Loss: 1.2285, Acc: 72.62%
学习率: 0.010000, 时间: 18.07s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/196] Loss: 0.0883 | Acc: 97.66% | Time: 0.0501s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 98 [100/196] Loss: 0.0430 | Acc: 98.89% | Time: 0.0492s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0497, Acc: 98.92%
测试 - Loss: 1.2156, Acc: 72.50%
学习率: 0.010000, 时间: 18.08s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/196] Loss: 0.0758 | Acc: 97.66% | Time: 0.0495s | GPU1: 0.02GB/2.70GB | GPU2: 0.27GB/1.45GB
Rank 0 | Epoch: 99 [100/196] Loss: 0.0247 | Acc: 99.02% | Time: 0.0551s | GPU1: 0.02GB/2.70GB | GPU2: 0.28GB/1.45GB

训练 - Loss: 0.0493, Acc: 98.95%
测试 - Loss: 1.2122, Acc: 72.39%
学习率: 0.001000, 时间: 18.09s
GPU内存使用:
  GPU 1 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 2 - 已分配: 0.27GB, 已保留: 1.45GB
  GPU 3 - 已分配: 0.02GB, 已保留: 2.70GB
  GPU 4 - 已分配: 0.27GB, 已保留: 1.45GB
保存checkpoint到: ./checkpoints/checkpoint_hybrid_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 1952.96秒 (32.55分钟)
平均每epoch: 19.53秒
最佳测试准确率: 73.89%
保存最终模型到: ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/hp_resnet50_bs128_gpu4_nw2_chunks0.pth

训练完成!
