====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-09T23:53:28.219992
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.8045 | Acc: 0.78% | Time: 1.5368s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.1313, Acc: 1.14%
测试 - Loss: 4.5851, Acc: 1.60%
学习率: 0.100000, 时间: 15.78s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 1.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.6021 | Acc: 1.56% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.5339, Acc: 2.14%
测试 - Loss: 4.4107, Acc: 2.61%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 1.60% -> 2.61%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.3552 | Acc: 3.12% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.2757, Acc: 3.69%
测试 - Loss: 4.1470, Acc: 5.01%
学习率: 0.100000, 时间: 5.99s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 2.61% -> 5.01%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.9318 | Acc: 3.12% | Time: 0.0337s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.0248, Acc: 6.57%
测试 - Loss: 3.9276, Acc: 8.13%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 5.01% -> 8.13%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.8254 | Acc: 8.59% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.8331, Acc: 9.35%
测试 - Loss: 3.7349, Acc: 10.82%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 8.13% -> 10.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.8219 | Acc: 8.59% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.6755, Acc: 12.36%
测试 - Loss: 3.6111, Acc: 13.24%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 10.82% -> 13.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.5934 | Acc: 10.94% | Time: 0.0394s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.5138, Acc: 14.76%
测试 - Loss: 3.3913, Acc: 18.10%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 13.24% -> 18.10%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.3601 | Acc: 16.41% | Time: 0.0386s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.3140, Acc: 18.45%
测试 - Loss: 3.3648, Acc: 18.12%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 18.10% -> 18.12%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 3.2432 | Acc: 11.72% | Time: 0.0347s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.0629, Acc: 23.30%
测试 - Loss: 2.9949, Acc: 25.03%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 18.12% -> 25.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.9647 | Acc: 25.00% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.8850, Acc: 26.58%
测试 - Loss: 2.8447, Acc: 27.75%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 25.03% -> 27.75%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.8305 | Acc: 30.47% | Time: 0.0374s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.6906, Acc: 30.14%
测试 - Loss: 2.8788, Acc: 29.41%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 27.75% -> 29.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.6521 | Acc: 33.59% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.5143, Acc: 33.88%
测试 - Loss: 2.4795, Acc: 35.57%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 29.41% -> 35.57%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.4773 | Acc: 34.38% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.3247, Acc: 37.90%
测试 - Loss: 2.4719, Acc: 35.78%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 35.57% -> 35.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 2.2181 | Acc: 41.41% | Time: 0.0355s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.1793, Acc: 40.84%
测试 - Loss: 2.3847, Acc: 37.74%
学习率: 0.100000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 35.78% -> 37.74%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.7882 | Acc: 50.78% | Time: 0.0379s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0701, Acc: 43.88%
测试 - Loss: 2.2424, Acc: 41.09%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 37.74% -> 41.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.7534 | Acc: 50.00% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9429, Acc: 46.42%
测试 - Loss: 2.0736, Acc: 45.04%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 41.09% -> 45.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.8181 | Acc: 47.66% | Time: 0.0319s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8436, Acc: 48.71%
测试 - Loss: 2.0735, Acc: 45.73%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 45.04% -> 45.73%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.6179 | Acc: 51.56% | Time: 0.0280s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7307, Acc: 51.85%
测试 - Loss: 1.9729, Acc: 46.99%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 45.73% -> 46.99%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.7658 | Acc: 50.00% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6179, Acc: 54.02%
测试 - Loss: 1.8317, Acc: 50.14%
学习率: 0.100000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 46.99% -> 50.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.4617 | Acc: 53.12% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5428, Acc: 55.94%
测试 - Loss: 2.0402, Acc: 47.49%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.6851 | Acc: 48.44% | Time: 0.0295s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4588, Acc: 58.14%
测试 - Loss: 1.7478, Acc: 52.84%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.14% -> 52.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.2576 | Acc: 63.28% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4180, Acc: 59.35%
测试 - Loss: 1.7892, Acc: 54.41%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.84% -> 54.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.2432 | Acc: 60.94% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3452, Acc: 61.26%
测试 - Loss: 1.8130, Acc: 51.97%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.2243 | Acc: 64.06% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2587, Acc: 63.11%
测试 - Loss: 1.9339, Acc: 50.87%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 1.0115 | Acc: 70.31% | Time: 0.0244s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2399, Acc: 63.42%
测试 - Loss: 1.5793, Acc: 57.43%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 54.41% -> 57.43%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 1.1228 | Acc: 64.06% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1496, Acc: 65.78%
测试 - Loss: 1.5589, Acc: 56.67%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 1.0011 | Acc: 65.62% | Time: 0.0263s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1254, Acc: 66.60%
测试 - Loss: 1.6762, Acc: 54.87%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 1.1837 | Acc: 62.50% | Time: 0.0246s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0706, Acc: 67.68%
测试 - Loss: 1.5378, Acc: 58.13%
学习率: 0.100000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 57.43% -> 58.13%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 1.1157 | Acc: 65.62% | Time: 0.0340s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0545, Acc: 68.14%
测试 - Loss: 1.5636, Acc: 57.97%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.9263 | Acc: 75.00% | Time: 0.0286s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9902, Acc: 70.61%
测试 - Loss: 1.6288, Acc: 56.15%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.7623 | Acc: 77.34% | Time: 0.0290s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9505, Acc: 71.51%
测试 - Loss: 1.4993, Acc: 59.67%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.13% -> 59.67%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.7008 | Acc: 79.69% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9245, Acc: 72.41%
测试 - Loss: 1.4334, Acc: 60.89%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.67% -> 60.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8260 | Acc: 75.00% | Time: 0.0340s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9134, Acc: 72.43%
测试 - Loss: 1.6175, Acc: 56.57%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.8673 | Acc: 73.44% | Time: 0.0272s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8489, Acc: 74.37%
测试 - Loss: 1.4839, Acc: 60.29%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.8648 | Acc: 73.44% | Time: 0.0319s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8391, Acc: 74.28%
测试 - Loss: 1.5974, Acc: 58.30%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.5638 | Acc: 84.38% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8039, Acc: 75.54%
测试 - Loss: 1.5713, Acc: 59.14%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.6781 | Acc: 78.12% | Time: 0.0289s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8012, Acc: 75.51%
测试 - Loss: 1.4536, Acc: 60.86%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.7502 | Acc: 74.22% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7819, Acc: 76.54%
测试 - Loss: 1.6415, Acc: 57.83%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.6968 | Acc: 82.03% | Time: 0.0377s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7542, Acc: 76.82%
测试 - Loss: 1.5121, Acc: 60.21%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.5898 | Acc: 82.03% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7256, Acc: 77.56%
测试 - Loss: 1.3730, Acc: 63.14%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.89% -> 63.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.5085 | Acc: 83.59% | Time: 0.0368s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6959, Acc: 78.28%
测试 - Loss: 1.5140, Acc: 61.08%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6553 | Acc: 82.81% | Time: 0.0290s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7156, Acc: 78.29%
测试 - Loss: 1.4790, Acc: 62.19%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.5784 | Acc: 82.81% | Time: 0.0318s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6732, Acc: 79.22%
测试 - Loss: 1.6683, Acc: 59.08%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.6100 | Acc: 78.91% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6751, Acc: 79.16%
测试 - Loss: 1.6705, Acc: 58.42%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.5889 | Acc: 82.81% | Time: 0.0324s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6555, Acc: 79.34%
测试 - Loss: 1.5816, Acc: 60.00%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.8343 | Acc: 74.22% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6390, Acc: 80.26%
测试 - Loss: 1.4388, Acc: 62.35%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.5758 | Acc: 81.25% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6287, Acc: 80.07%
测试 - Loss: 1.4492, Acc: 61.66%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.5566 | Acc: 85.16% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6006, Acc: 81.48%
测试 - Loss: 1.5048, Acc: 61.69%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4907 | Acc: 85.16% | Time: 0.0290s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6092, Acc: 80.85%
测试 - Loss: 1.7666, Acc: 58.42%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.4111 | Acc: 86.72% | Time: 0.0299s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6009, Acc: 80.90%
测试 - Loss: 1.6019, Acc: 59.98%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.7459 | Acc: 77.34% | Time: 0.0346s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.3356, Acc: 90.18%
测试 - Loss: 0.9730, Acc: 73.17%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 63.14% -> 73.17%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1701 | Acc: 97.66% | Time: 0.0431s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2175, Acc: 94.26%
测试 - Loss: 0.9684, Acc: 73.89%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.17% -> 73.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.2376 | Acc: 92.97% | Time: 0.0302s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1821, Acc: 95.42%
测试 - Loss: 0.9722, Acc: 73.74%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1339 | Acc: 98.44% | Time: 0.0269s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1613, Acc: 95.98%
测试 - Loss: 0.9815, Acc: 73.84%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.1143 | Acc: 98.44% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1427, Acc: 96.50%
测试 - Loss: 0.9836, Acc: 73.88%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.1050 | Acc: 95.31% | Time: 0.0255s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1288, Acc: 97.11%
测试 - Loss: 0.9944, Acc: 73.70%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.1037 | Acc: 99.22% | Time: 0.0260s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1136, Acc: 97.71%
测试 - Loss: 0.9910, Acc: 74.18%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.89% -> 74.18%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.1025 | Acc: 96.88% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1104, Acc: 97.54%
测试 - Loss: 1.0066, Acc: 73.98%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.1147 | Acc: 97.66% | Time: 0.0337s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1005, Acc: 97.70%
测试 - Loss: 1.0211, Acc: 73.88%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0653 | Acc: 100.00% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0961, Acc: 98.02%
测试 - Loss: 1.0274, Acc: 73.78%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0764 | Acc: 99.22% | Time: 0.0303s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0882, Acc: 98.32%
测试 - Loss: 1.0249, Acc: 73.88%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0658 | Acc: 99.22% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0828, Acc: 98.31%
测试 - Loss: 1.0248, Acc: 73.97%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0423 | Acc: 98.44% | Time: 0.0284s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0789, Acc: 98.42%
测试 - Loss: 1.0359, Acc: 74.19%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.18% -> 74.19%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0448 | Acc: 99.22% | Time: 0.0333s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0713, Acc: 98.71%
测试 - Loss: 1.0426, Acc: 73.95%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0628 | Acc: 98.44% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0674, Acc: 98.66%
测试 - Loss: 1.0409, Acc: 74.22%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.19% -> 74.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0659 | Acc: 98.44% | Time: 0.0428s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0631, Acc: 98.86%
测试 - Loss: 1.0495, Acc: 74.03%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0695 | Acc: 99.22% | Time: 0.0253s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0601, Acc: 98.98%
测试 - Loss: 1.0512, Acc: 73.91%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0526 | Acc: 99.22% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0578, Acc: 98.91%
测试 - Loss: 1.0525, Acc: 74.16%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0650 | Acc: 98.44% | Time: 0.0280s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0526, Acc: 99.19%
测试 - Loss: 1.0559, Acc: 74.34%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.22% -> 74.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0471 | Acc: 99.22% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0526, Acc: 99.14%
测试 - Loss: 1.0640, Acc: 74.10%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0465 | Acc: 99.22% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0482, Acc: 99.21%
测试 - Loss: 1.0699, Acc: 74.01%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0350 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0479, Acc: 99.26%
测试 - Loss: 1.0707, Acc: 73.78%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0329 | Acc: 99.22% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0462, Acc: 99.37%
测试 - Loss: 1.0712, Acc: 74.28%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0453 | Acc: 100.00% | Time: 0.0262s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0444, Acc: 99.38%
测试 - Loss: 1.0717, Acc: 74.15%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0458 | Acc: 99.22% | Time: 0.0301s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0401, Acc: 99.46%
测试 - Loss: 1.0770, Acc: 74.30%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0271 | Acc: 100.00% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0364, Acc: 99.60%
测试 - Loss: 1.0803, Acc: 74.08%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0263 | Acc: 100.00% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0377, Acc: 99.50%
测试 - Loss: 1.0773, Acc: 74.00%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0388 | Acc: 99.22% | Time: 0.0258s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0340, Acc: 99.62%
测试 - Loss: 1.0809, Acc: 74.28%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0302 | Acc: 100.00% | Time: 0.0426s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0333, Acc: 99.60%
测试 - Loss: 1.0737, Acc: 74.32%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0215 | Acc: 100.00% | Time: 0.0273s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0323, Acc: 99.60%
测试 - Loss: 1.0779, Acc: 74.42%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.34% -> 74.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0226 | Acc: 100.00% | Time: 0.0362s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0305, Acc: 99.67%
测试 - Loss: 1.0818, Acc: 74.58%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.42% -> 74.58%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0255 | Acc: 100.00% | Time: 0.0373s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0302, Acc: 99.70%
测试 - Loss: 1.0824, Acc: 74.39%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0205 | Acc: 100.00% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0283, Acc: 99.73%
测试 - Loss: 1.0928, Acc: 74.24%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0347 | Acc: 99.22% | Time: 0.0261s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0285, Acc: 99.64%
测试 - Loss: 1.0830, Acc: 74.76%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.58% -> 74.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0362 | Acc: 99.22% | Time: 0.0301s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0294, Acc: 99.66%
测试 - Loss: 1.0931, Acc: 74.28%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0325 | Acc: 100.00% | Time: 0.0296s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0287, Acc: 99.71%
测试 - Loss: 1.0880, Acc: 74.47%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0131 | Acc: 100.00% | Time: 0.0417s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0252, Acc: 99.78%
测试 - Loss: 1.0923, Acc: 74.54%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0192 | Acc: 100.00% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0259, Acc: 99.74%
测试 - Loss: 1.0876, Acc: 74.26%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0201 | Acc: 100.00% | Time: 0.0266s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0249, Acc: 99.74%
测试 - Loss: 1.0884, Acc: 74.47%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0325 | Acc: 99.22% | Time: 0.0402s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0232, Acc: 99.80%
测试 - Loss: 1.0961, Acc: 74.16%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0156 | Acc: 100.00% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0238, Acc: 99.78%
测试 - Loss: 1.0946, Acc: 74.08%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0184 | Acc: 100.00% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0242, Acc: 99.75%
测试 - Loss: 1.0927, Acc: 74.53%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0254 | Acc: 100.00% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0228, Acc: 99.81%
测试 - Loss: 1.0910, Acc: 74.27%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0208 | Acc: 99.22% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0219, Acc: 99.85%
测试 - Loss: 1.0867, Acc: 74.50%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0162 | Acc: 100.00% | Time: 0.0355s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0213, Acc: 99.79%
测试 - Loss: 1.0919, Acc: 74.41%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0439 | Acc: 99.22% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0225, Acc: 99.80%
测试 - Loss: 1.1022, Acc: 74.29%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0219 | Acc: 100.00% | Time: 0.0303s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0212, Acc: 99.81%
测试 - Loss: 1.1015, Acc: 74.35%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0433 | Acc: 98.44% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.78%
测试 - Loss: 1.0925, Acc: 74.25%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0169 | Acc: 100.00% | Time: 0.0254s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0199, Acc: 99.85%
测试 - Loss: 1.1014, Acc: 74.19%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0240 | Acc: 99.22% | Time: 0.0355s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0203, Acc: 99.86%
测试 - Loss: 1.0881, Acc: 74.54%
学习率: 0.001000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 696.07秒 (11.60分钟)
平均每epoch: 6.96秒
最佳测试准确率: 74.76%
保存最终模型到: ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth

训练完成!
