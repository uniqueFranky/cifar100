====================================================================================================
Experiment: ddp_resnet50_bs128_gpu2_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 2
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/ddp_resnet50_bs128_gpu2_nw2_chunks0.pth
Start Time: 2025-12-09T23:32:48.407065
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2]
  num_gpus                 : 2
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/ddp_resnet50_bs128_gpu2_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 256
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 2 个GPU: [1, 2]
每个GPU的batch size: 128
有效batch size: 256
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/196] Loss: 4.7755 | Acc: 0.00% | Time: 0.4954s | GPU Mem: 0.29GB/3.77GB
Rank 0 | Epoch: 0 [100/196] Loss: 4.5552 | Acc: 1.37% | Time: 0.0267s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.7424, Acc: 2.06%
测试 - Loss: 4.2729, Acc: 4.02%
学习率: 0.100000, 时间: 19.57s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 0.00% -> 4.02%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/196] Loss: 4.2742 | Acc: 0.78% | Time: 0.0367s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 1 [100/196] Loss: 4.1763 | Acc: 4.73% | Time: 0.0237s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 4.0856, Acc: 5.88%
测试 - Loss: 3.9398, Acc: 7.85%
学习率: 0.100000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 4.02% -> 7.85%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/196] Loss: 4.1120 | Acc: 6.25% | Time: 0.0307s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 2 [100/196] Loss: 3.8467 | Acc: 8.89% | Time: 0.0340s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 3.8077, Acc: 10.16%
测试 - Loss: 3.6388, Acc: 12.81%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 7.85% -> 12.81%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/196] Loss: 3.4029 | Acc: 18.75% | Time: 0.0330s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 3 [100/196] Loss: 3.3847 | Acc: 13.75% | Time: 0.0249s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 3.5367, Acc: 14.87%
测试 - Loss: 3.4123, Acc: 17.25%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 12.81% -> 17.25%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/196] Loss: 3.3097 | Acc: 21.88% | Time: 0.0363s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 4 [100/196] Loss: 3.1732 | Acc: 18.38% | Time: 0.0330s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 3.2880, Acc: 19.33%
测试 - Loss: 3.2074, Acc: 20.63%
学习率: 0.100000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 17.25% -> 20.63%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/196] Loss: 3.2167 | Acc: 21.88% | Time: 0.0339s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 5 [100/196] Loss: 3.1545 | Acc: 22.76% | Time: 0.0249s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 3.0817, Acc: 23.18%
测试 - Loss: 3.0098, Acc: 25.72%
学习率: 0.100000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 20.63% -> 25.72%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/196] Loss: 2.7175 | Acc: 34.38% | Time: 0.0314s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 6 [100/196] Loss: 2.9098 | Acc: 26.32% | Time: 0.0312s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 2.8937, Acc: 27.01%
测试 - Loss: 2.8104, Acc: 29.22%
学习率: 0.100000, 时间: 10.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 25.72% -> 29.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/196] Loss: 2.9277 | Acc: 28.12% | Time: 0.0335s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 7 [100/196] Loss: 2.8379 | Acc: 29.32% | Time: 0.0278s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 2.7136, Acc: 30.66%
测试 - Loss: 2.7001, Acc: 31.25%
学习率: 0.100000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 29.22% -> 31.25%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/196] Loss: 2.6828 | Acc: 25.78% | Time: 0.0411s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 8 [100/196] Loss: 2.5156 | Acc: 34.11% | Time: 0.0250s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 2.5086, Acc: 34.57%
测试 - Loss: 2.8992, Acc: 29.70%
学习率: 0.100000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/196] Loss: 2.3253 | Acc: 35.94% | Time: 0.0347s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 9 [100/196] Loss: 2.3358 | Acc: 37.03% | Time: 0.0346s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 2.3498, Acc: 37.93%
测试 - Loss: 2.4283, Acc: 37.48%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 31.25% -> 37.48%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/196] Loss: 2.3617 | Acc: 42.19% | Time: 0.0324s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 10 [100/196] Loss: 2.4110 | Acc: 41.35% | Time: 0.0259s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 2.1620, Acc: 41.88%
测试 - Loss: 2.2727, Acc: 40.34%
学习率: 0.100000, 时间: 10.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 37.48% -> 40.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/196] Loss: 1.9648 | Acc: 41.41% | Time: 0.0335s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 11 [100/196] Loss: 1.7995 | Acc: 44.91% | Time: 0.0251s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.9916, Acc: 45.51%
测试 - Loss: 2.2310, Acc: 44.25%
学习率: 0.100000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 40.34% -> 44.25%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/196] Loss: 1.9905 | Acc: 42.19% | Time: 0.0300s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 12 [100/196] Loss: 1.9171 | Acc: 48.25% | Time: 0.0216s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.8758, Acc: 48.58%
测试 - Loss: 2.0065, Acc: 46.62%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 44.25% -> 46.62%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/196] Loss: 1.7045 | Acc: 50.00% | Time: 0.0395s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 13 [100/196] Loss: 1.7367 | Acc: 51.20% | Time: 0.0238s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.7516, Acc: 51.18%
测试 - Loss: 2.0322, Acc: 46.65%
学习率: 0.100000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 46.62% -> 46.65%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/196] Loss: 1.7967 | Acc: 46.09% | Time: 0.0398s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 14 [100/196] Loss: 1.5879 | Acc: 53.23% | Time: 0.0290s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.6579, Acc: 53.11%
测试 - Loss: 1.8602, Acc: 49.70%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 46.65% -> 49.70%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/196] Loss: 1.3794 | Acc: 56.25% | Time: 0.0338s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 15 [100/196] Loss: 1.6124 | Acc: 55.25% | Time: 0.0233s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.5795, Acc: 55.20%
测试 - Loss: 1.8254, Acc: 50.72%
学习率: 0.100000, 时间: 10.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 49.70% -> 50.72%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/196] Loss: 1.5347 | Acc: 60.16% | Time: 0.0405s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 16 [100/196] Loss: 1.5492 | Acc: 57.46% | Time: 0.0263s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.5118, Acc: 56.96%
测试 - Loss: 1.7492, Acc: 52.09%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 50.72% -> 52.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/196] Loss: 1.5202 | Acc: 60.16% | Time: 0.0296s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 17 [100/196] Loss: 1.4326 | Acc: 58.33% | Time: 0.0237s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.4596, Acc: 58.10%
测试 - Loss: 1.6779, Acc: 54.38%
学习率: 0.100000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 52.09% -> 54.38%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/196] Loss: 1.4024 | Acc: 61.72% | Time: 0.0357s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 18 [100/196] Loss: 1.2570 | Acc: 60.38% | Time: 0.0292s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.3781, Acc: 60.11%
测试 - Loss: 1.7710, Acc: 52.28%
学习率: 0.100000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/196] Loss: 1.2657 | Acc: 65.62% | Time: 0.0324s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 19 [100/196] Loss: 1.2277 | Acc: 61.69% | Time: 0.0245s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.3401, Acc: 61.32%
测试 - Loss: 1.6873, Acc: 53.66%
学习率: 0.100000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/196] Loss: 1.2037 | Acc: 66.41% | Time: 0.0317s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 20 [100/196] Loss: 1.2873 | Acc: 63.35% | Time: 0.0235s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.2739, Acc: 63.18%
测试 - Loss: 1.7233, Acc: 52.99%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/196] Loss: 1.3363 | Acc: 60.16% | Time: 0.0319s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 21 [100/196] Loss: 1.2610 | Acc: 64.26% | Time: 0.0240s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.2644, Acc: 63.71%
测试 - Loss: 1.6953, Acc: 53.72%
学习率: 0.100000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/196] Loss: 0.9783 | Acc: 67.97% | Time: 0.0292s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 22 [100/196] Loss: 1.2727 | Acc: 65.91% | Time: 0.0252s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.2206, Acc: 64.51%
测试 - Loss: 1.7323, Acc: 53.57%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/196] Loss: 1.1330 | Acc: 65.62% | Time: 0.0299s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 23 [100/196] Loss: 1.1772 | Acc: 66.22% | Time: 0.0261s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.1696, Acc: 65.54%
测试 - Loss: 1.6703, Acc: 55.32%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 54.38% -> 55.32%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/196] Loss: 0.9661 | Acc: 71.88% | Time: 0.0270s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 24 [100/196] Loss: 1.1852 | Acc: 66.38% | Time: 0.0248s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.1621, Acc: 65.99%
测试 - Loss: 1.7081, Acc: 54.81%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/196] Loss: 1.0508 | Acc: 66.41% | Time: 0.0306s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 25 [100/196] Loss: 1.1020 | Acc: 67.19% | Time: 0.0244s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.1308, Acc: 66.50%
测试 - Loss: 2.0217, Acc: 50.39%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/196] Loss: 1.0998 | Acc: 64.84% | Time: 0.0304s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 26 [100/196] Loss: 0.9493 | Acc: 68.78% | Time: 0.0238s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.0969, Acc: 67.81%
测试 - Loss: 1.6710, Acc: 55.58%
学习率: 0.100000, 时间: 10.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 55.32% -> 55.58%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/196] Loss: 1.0142 | Acc: 64.84% | Time: 0.0326s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 27 [100/196] Loss: 0.9541 | Acc: 68.19% | Time: 0.0233s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.0932, Acc: 67.72%
测试 - Loss: 1.5749, Acc: 58.48%
学习率: 0.100000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 55.58% -> 58.48%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/196] Loss: 1.1415 | Acc: 66.41% | Time: 0.0313s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 28 [100/196] Loss: 1.1624 | Acc: 68.76% | Time: 0.0236s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.0735, Acc: 68.40%
测试 - Loss: 1.5723, Acc: 57.81%
学习率: 0.100000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/196] Loss: 0.9383 | Acc: 71.88% | Time: 0.0300s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 29 [100/196] Loss: 1.0000 | Acc: 69.51% | Time: 0.0245s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.0381, Acc: 69.44%
测试 - Loss: 1.5055, Acc: 59.07%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 58.48% -> 59.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/196] Loss: 0.9338 | Acc: 72.66% | Time: 0.0333s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 30 [100/196] Loss: 0.9920 | Acc: 70.28% | Time: 0.0249s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.0193, Acc: 69.46%
测试 - Loss: 1.7164, Acc: 55.13%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/196] Loss: 0.9913 | Acc: 67.19% | Time: 0.0283s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 31 [100/196] Loss: 1.1073 | Acc: 70.68% | Time: 0.0253s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 1.0149, Acc: 69.95%
测试 - Loss: 1.6594, Acc: 56.21%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/196] Loss: 0.8970 | Acc: 74.22% | Time: 0.0361s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 32 [100/196] Loss: 0.9383 | Acc: 70.83% | Time: 0.0232s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9950, Acc: 70.12%
测试 - Loss: 1.6308, Acc: 57.10%
学习率: 0.100000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/196] Loss: 1.0971 | Acc: 68.75% | Time: 0.0393s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 33 [100/196] Loss: 0.9857 | Acc: 72.17% | Time: 0.0237s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9665, Acc: 71.34%
测试 - Loss: 1.6185, Acc: 56.44%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/196] Loss: 0.7662 | Acc: 80.47% | Time: 0.0300s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 34 [100/196] Loss: 0.9427 | Acc: 72.80% | Time: 0.0343s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9706, Acc: 71.60%
测试 - Loss: 1.5180, Acc: 59.14%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 59.07% -> 59.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/196] Loss: 1.0372 | Acc: 68.75% | Time: 0.0341s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 35 [100/196] Loss: 1.0852 | Acc: 71.87% | Time: 0.0234s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9531, Acc: 71.36%
测试 - Loss: 1.6264, Acc: 56.76%
学习率: 0.100000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/196] Loss: 0.8136 | Acc: 76.56% | Time: 0.0362s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 36 [100/196] Loss: 0.9135 | Acc: 72.45% | Time: 0.0285s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9351, Acc: 71.84%
测试 - Loss: 1.6066, Acc: 58.81%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/196] Loss: 0.9510 | Acc: 68.75% | Time: 0.0259s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 37 [100/196] Loss: 1.0327 | Acc: 72.25% | Time: 0.0276s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9497, Acc: 71.72%
测试 - Loss: 1.6354, Acc: 57.83%
学习率: 0.100000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/196] Loss: 0.7269 | Acc: 78.91% | Time: 0.0250s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 38 [100/196] Loss: 0.9903 | Acc: 73.03% | Time: 0.0273s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.9245, Acc: 72.44%
测试 - Loss: 1.8785, Acc: 51.62%
学习率: 0.100000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/196] Loss: 0.7765 | Acc: 75.78% | Time: 0.0298s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 39 [100/196] Loss: 0.8692 | Acc: 73.14% | Time: 0.0342s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8940, Acc: 72.98%
测试 - Loss: 1.6795, Acc: 57.40%
学习率: 0.100000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/196] Loss: 0.8441 | Acc: 74.22% | Time: 0.0330s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 40 [100/196] Loss: 1.0182 | Acc: 73.73% | Time: 0.0242s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8986, Acc: 73.20%
测试 - Loss: 1.6504, Acc: 56.50%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/196] Loss: 0.8364 | Acc: 71.09% | Time: 0.0307s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 41 [100/196] Loss: 0.7849 | Acc: 74.61% | Time: 0.0240s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8709, Acc: 73.80%
测试 - Loss: 1.5667, Acc: 59.35%
学习率: 0.100000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 59.14% -> 59.35%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/196] Loss: 0.6703 | Acc: 80.47% | Time: 0.0378s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 42 [100/196] Loss: 0.8083 | Acc: 74.47% | Time: 0.0239s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8754, Acc: 73.91%
测试 - Loss: 1.5554, Acc: 58.39%
学习率: 0.100000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/196] Loss: 0.8005 | Acc: 75.78% | Time: 0.0327s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 43 [100/196] Loss: 0.7349 | Acc: 75.03% | Time: 0.0237s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8630, Acc: 74.03%
测试 - Loss: 1.4320, Acc: 61.43%
学习率: 0.100000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 59.35% -> 61.43%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/196] Loss: 0.9242 | Acc: 78.12% | Time: 0.0294s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 44 [100/196] Loss: 0.9309 | Acc: 74.69% | Time: 0.0345s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8734, Acc: 73.68%
测试 - Loss: 1.7721, Acc: 56.19%
学习率: 0.100000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/196] Loss: 0.9805 | Acc: 73.44% | Time: 0.0325s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 45 [100/196] Loss: 0.9091 | Acc: 75.36% | Time: 0.0263s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8428, Acc: 74.63%
测试 - Loss: 1.4233, Acc: 62.21%
学习率: 0.100000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 61.43% -> 62.21%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/196] Loss: 0.8399 | Acc: 78.91% | Time: 0.0371s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 46 [100/196] Loss: 0.9444 | Acc: 74.71% | Time: 0.0239s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8470, Acc: 74.35%
测试 - Loss: 1.5791, Acc: 58.67%
学习率: 0.100000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/196] Loss: 0.7626 | Acc: 73.44% | Time: 0.0311s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 47 [100/196] Loss: 0.8871 | Acc: 75.30% | Time: 0.0249s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8379, Acc: 74.80%
测试 - Loss: 1.6899, Acc: 57.16%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/196] Loss: 0.6713 | Acc: 75.78% | Time: 0.0256s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 48 [100/196] Loss: 0.8083 | Acc: 75.36% | Time: 0.0249s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8364, Acc: 74.57%
测试 - Loss: 1.4643, Acc: 61.23%
学习率: 0.100000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/196] Loss: 0.6746 | Acc: 78.12% | Time: 0.0345s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 49 [100/196] Loss: 0.7842 | Acc: 76.02% | Time: 0.0235s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.8180, Acc: 75.16%
测试 - Loss: 1.7028, Acc: 57.47%
学习率: 0.010000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/196] Loss: 0.6391 | Acc: 82.81% | Time: 0.0349s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 50 [100/196] Loss: 0.5781 | Acc: 83.54% | Time: 0.0250s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.4809, Acc: 85.60%
测试 - Loss: 0.8873, Acc: 74.51%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 62.21% -> 74.51%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/196] Loss: 0.3228 | Acc: 92.19% | Time: 0.0336s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 51 [100/196] Loss: 0.3707 | Acc: 90.11% | Time: 0.0247s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.3372, Acc: 90.30%
测试 - Loss: 0.8842, Acc: 75.11%
学习率: 0.010000, 时间: 10.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 74.51% -> 75.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/196] Loss: 0.3059 | Acc: 89.06% | Time: 0.0336s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 52 [100/196] Loss: 0.2546 | Acc: 91.79% | Time: 0.0251s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.2864, Acc: 91.69%
测试 - Loss: 0.8844, Acc: 75.21%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 75.11% -> 75.21%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/196] Loss: 0.2818 | Acc: 91.41% | Time: 0.0327s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 53 [100/196] Loss: 0.2862 | Acc: 93.02% | Time: 0.0246s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.2515, Acc: 92.82%
测试 - Loss: 0.8883, Acc: 75.43%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 75.21% -> 75.43%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/196] Loss: 0.2066 | Acc: 95.31% | Time: 0.0334s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 54 [100/196] Loss: 0.1833 | Acc: 93.96% | Time: 0.0273s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.2252, Acc: 93.76%
测试 - Loss: 0.9090, Acc: 75.45%
学习率: 0.010000, 时间: 10.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 75.43% -> 75.45%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/196] Loss: 0.2322 | Acc: 92.97% | Time: 0.0341s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 55 [100/196] Loss: 0.1704 | Acc: 94.71% | Time: 0.0274s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.2012, Acc: 94.54%
测试 - Loss: 0.9127, Acc: 75.34%
学习率: 0.010000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/196] Loss: 0.2241 | Acc: 92.19% | Time: 0.0348s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 56 [100/196] Loss: 0.2017 | Acc: 95.09% | Time: 0.0231s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1844, Acc: 94.86%
测试 - Loss: 0.9217, Acc: 75.29%
学习率: 0.010000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/196] Loss: 0.1467 | Acc: 96.09% | Time: 0.0303s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 57 [100/196] Loss: 0.1721 | Acc: 95.92% | Time: 0.0252s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1649, Acc: 95.60%
测试 - Loss: 0.9369, Acc: 75.53%
学习率: 0.010000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 75.45% -> 75.53%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/196] Loss: 0.1904 | Acc: 94.53% | Time: 0.0417s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 58 [100/196] Loss: 0.1378 | Acc: 96.17% | Time: 0.0234s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1519, Acc: 95.96%
测试 - Loss: 0.9390, Acc: 75.62%
学习率: 0.010000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 75.53% -> 75.62%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/196] Loss: 0.1244 | Acc: 96.88% | Time: 0.0282s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 59 [100/196] Loss: 0.1250 | Acc: 96.64% | Time: 0.0237s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1351, Acc: 96.46%
测试 - Loss: 0.9679, Acc: 75.28%
学习率: 0.010000, 时间: 10.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/196] Loss: 0.0711 | Acc: 99.22% | Time: 0.0315s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 60 [100/196] Loss: 0.1137 | Acc: 96.97% | Time: 0.0285s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1279, Acc: 96.81%
测试 - Loss: 0.9590, Acc: 75.74%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
最佳准确率更新: 75.62% -> 75.74%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/196] Loss: 0.0982 | Acc: 96.88% | Time: 0.0340s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 61 [100/196] Loss: 0.1825 | Acc: 97.18% | Time: 0.0249s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1157, Acc: 97.20%
测试 - Loss: 0.9757, Acc: 75.45%
学习率: 0.010000, 时间: 10.80s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/196] Loss: 0.0707 | Acc: 98.44% | Time: 0.0197s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 62 [100/196] Loss: 0.1340 | Acc: 97.48% | Time: 0.0238s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.1078, Acc: 97.34%
测试 - Loss: 0.9852, Acc: 75.52%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/196] Loss: 0.0562 | Acc: 99.22% | Time: 0.0334s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 63 [100/196] Loss: 0.0704 | Acc: 97.91% | Time: 0.0270s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0937, Acc: 97.76%
测试 - Loss: 0.9892, Acc: 75.26%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/196] Loss: 0.0803 | Acc: 99.22% | Time: 0.0251s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 64 [100/196] Loss: 0.1567 | Acc: 98.06% | Time: 0.0239s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0878, Acc: 98.06%
测试 - Loss: 0.9924, Acc: 75.33%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/196] Loss: 0.1039 | Acc: 96.88% | Time: 0.0396s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 65 [100/196] Loss: 0.0794 | Acc: 98.47% | Time: 0.0269s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0800, Acc: 98.30%
测试 - Loss: 1.0048, Acc: 75.16%
学习率: 0.010000, 时间: 10.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/196] Loss: 0.1222 | Acc: 97.66% | Time: 0.0304s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 66 [100/196] Loss: 0.0684 | Acc: 98.38% | Time: 0.0285s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0777, Acc: 98.32%
测试 - Loss: 1.0192, Acc: 75.17%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/196] Loss: 0.0642 | Acc: 98.44% | Time: 0.0308s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 67 [100/196] Loss: 0.0870 | Acc: 98.59% | Time: 0.0236s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0711, Acc: 98.54%
测试 - Loss: 1.0215, Acc: 75.43%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/196] Loss: 0.0437 | Acc: 99.22% | Time: 0.0293s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 68 [100/196] Loss: 0.0630 | Acc: 98.69% | Time: 0.0232s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0656, Acc: 98.68%
测试 - Loss: 1.0365, Acc: 74.80%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/196] Loss: 0.0704 | Acc: 98.44% | Time: 0.0322s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 69 [100/196] Loss: 0.0536 | Acc: 98.72% | Time: 0.0278s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0640, Acc: 98.68%
测试 - Loss: 1.0176, Acc: 75.51%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/196] Loss: 0.0506 | Acc: 99.22% | Time: 0.0368s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 70 [100/196] Loss: 0.0464 | Acc: 98.88% | Time: 0.0287s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0601, Acc: 98.80%
测试 - Loss: 1.0456, Acc: 75.31%
学习率: 0.010000, 时间: 10.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/196] Loss: 0.0517 | Acc: 99.22% | Time: 0.0288s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 71 [100/196] Loss: 0.0622 | Acc: 99.02% | Time: 0.0232s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0544, Acc: 98.92%
测试 - Loss: 1.0375, Acc: 75.48%
学习率: 0.010000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/196] Loss: 0.0346 | Acc: 99.22% | Time: 0.0396s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 72 [100/196] Loss: 0.0578 | Acc: 99.22% | Time: 0.0281s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0535, Acc: 99.04%
测试 - Loss: 1.0658, Acc: 74.61%
学习率: 0.010000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/196] Loss: 0.0452 | Acc: 100.00% | Time: 0.0292s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 73 [100/196] Loss: 0.0324 | Acc: 98.99% | Time: 0.0248s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0527, Acc: 99.00%
测试 - Loss: 1.0394, Acc: 75.13%
学习率: 0.010000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/196] Loss: 0.0347 | Acc: 99.22% | Time: 0.0301s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 74 [100/196] Loss: 0.0486 | Acc: 99.28% | Time: 0.0287s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0470, Acc: 99.25%
测试 - Loss: 1.0440, Acc: 75.36%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/196] Loss: 0.0533 | Acc: 99.22% | Time: 0.0272s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 75 [100/196] Loss: 0.0275 | Acc: 99.27% | Time: 0.0283s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0451, Acc: 99.20%
测试 - Loss: 1.0452, Acc: 75.50%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/196] Loss: 0.0238 | Acc: 100.00% | Time: 0.0324s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 76 [100/196] Loss: 0.0256 | Acc: 99.33% | Time: 0.0254s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0430, Acc: 99.23%
测试 - Loss: 1.0469, Acc: 75.48%
学习率: 0.010000, 时间: 10.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/196] Loss: 0.0482 | Acc: 99.22% | Time: 0.0315s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 77 [100/196] Loss: 0.0554 | Acc: 99.40% | Time: 0.0292s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0431, Acc: 99.19%
测试 - Loss: 1.0645, Acc: 75.32%
学习率: 0.010000, 时间: 10.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/196] Loss: 0.0201 | Acc: 100.00% | Time: 0.0241s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 78 [100/196] Loss: 0.0529 | Acc: 99.50% | Time: 0.0233s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0400, Acc: 99.40%
测试 - Loss: 1.0443, Acc: 75.52%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/196] Loss: 0.0178 | Acc: 100.00% | Time: 0.0296s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 79 [100/196] Loss: 0.0368 | Acc: 99.50% | Time: 0.0302s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0374, Acc: 99.40%
测试 - Loss: 1.0587, Acc: 75.46%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/196] Loss: 0.0530 | Acc: 96.88% | Time: 0.0329s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 80 [100/196] Loss: 0.0528 | Acc: 99.36% | Time: 0.0295s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0369, Acc: 99.40%
测试 - Loss: 1.0612, Acc: 75.40%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/196] Loss: 0.0221 | Acc: 100.00% | Time: 0.0289s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 81 [100/196] Loss: 0.0126 | Acc: 99.39% | Time: 0.0247s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0382, Acc: 99.33%
测试 - Loss: 1.0605, Acc: 75.26%
学习率: 0.010000, 时间: 10.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/196] Loss: 0.0437 | Acc: 99.22% | Time: 0.0303s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 82 [100/196] Loss: 0.0344 | Acc: 99.36% | Time: 0.0242s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0352, Acc: 99.40%
测试 - Loss: 1.0601, Acc: 75.08%
学习率: 0.010000, 时间: 10.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/196] Loss: 0.0346 | Acc: 99.22% | Time: 0.0291s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 83 [100/196] Loss: 0.0159 | Acc: 99.50% | Time: 0.0248s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0349, Acc: 99.42%
测试 - Loss: 1.0703, Acc: 74.93%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/196] Loss: 0.0349 | Acc: 100.00% | Time: 0.0289s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 84 [100/196] Loss: 0.0192 | Acc: 99.52% | Time: 0.0241s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0347, Acc: 99.42%
测试 - Loss: 1.0745, Acc: 75.03%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/196] Loss: 0.0552 | Acc: 97.66% | Time: 0.0305s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 85 [100/196] Loss: 0.0232 | Acc: 99.43% | Time: 0.0234s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0343, Acc: 99.48%
测试 - Loss: 1.0738, Acc: 74.73%
学习率: 0.010000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/196] Loss: 0.0426 | Acc: 98.44% | Time: 0.0280s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 86 [100/196] Loss: 0.0343 | Acc: 99.49% | Time: 0.0250s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0362, Acc: 99.40%
测试 - Loss: 1.1016, Acc: 74.85%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/196] Loss: 0.0261 | Acc: 99.22% | Time: 0.0284s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 87 [100/196] Loss: 0.0310 | Acc: 99.34% | Time: 0.0243s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0338, Acc: 99.42%
测试 - Loss: 1.0772, Acc: 74.96%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/196] Loss: 0.0181 | Acc: 100.00% | Time: 0.0317s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 88 [100/196] Loss: 0.0252 | Acc: 99.54% | Time: 0.0288s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0323, Acc: 99.50%
测试 - Loss: 1.0785, Acc: 75.16%
学习率: 0.010000, 时间: 10.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/196] Loss: 0.0344 | Acc: 100.00% | Time: 0.0330s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 89 [100/196] Loss: 0.0306 | Acc: 99.49% | Time: 0.0239s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0330, Acc: 99.46%
测试 - Loss: 1.0740, Acc: 75.02%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/196] Loss: 0.0162 | Acc: 100.00% | Time: 0.0356s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 90 [100/196] Loss: 0.0532 | Acc: 99.57% | Time: 0.0237s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0310, Acc: 99.54%
测试 - Loss: 1.1009, Acc: 74.55%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/196] Loss: 0.0509 | Acc: 99.22% | Time: 0.0358s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 91 [100/196] Loss: 0.0195 | Acc: 99.48% | Time: 0.0243s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0316, Acc: 99.51%
测试 - Loss: 1.0814, Acc: 75.07%
学习率: 0.010000, 时间: 10.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/196] Loss: 0.0141 | Acc: 100.00% | Time: 0.0265s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 92 [100/196] Loss: 0.0334 | Acc: 99.43% | Time: 0.0235s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0318, Acc: 99.47%
测试 - Loss: 1.1003, Acc: 75.01%
学习率: 0.010000, 时间: 10.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/196] Loss: 0.0193 | Acc: 100.00% | Time: 0.0293s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 93 [100/196] Loss: 0.0237 | Acc: 99.41% | Time: 0.0255s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0335, Acc: 99.46%
测试 - Loss: 1.0788, Acc: 75.12%
学习率: 0.010000, 时间: 10.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/196] Loss: 0.0397 | Acc: 99.22% | Time: 0.0289s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 94 [100/196] Loss: 0.0278 | Acc: 99.39% | Time: 0.0283s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0316, Acc: 99.48%
测试 - Loss: 1.0846, Acc: 74.81%
学习率: 0.010000, 时间: 10.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/196] Loss: 0.0195 | Acc: 100.00% | Time: 0.0300s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 95 [100/196] Loss: 0.0581 | Acc: 99.40% | Time: 0.0245s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0336, Acc: 99.41%
测试 - Loss: 1.0941, Acc: 74.79%
学习率: 0.010000, 时间: 10.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/196] Loss: 0.0190 | Acc: 100.00% | Time: 0.0287s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 96 [100/196] Loss: 0.0526 | Acc: 99.61% | Time: 0.0308s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0320, Acc: 99.52%
测试 - Loss: 1.0878, Acc: 74.70%
学习率: 0.010000, 时间: 10.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/196] Loss: 0.0350 | Acc: 99.22% | Time: 0.0269s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 97 [100/196] Loss: 0.0342 | Acc: 99.46% | Time: 0.0250s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0324, Acc: 99.43%
测试 - Loss: 1.0958, Acc: 74.83%
学习率: 0.010000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/196] Loss: 0.0345 | Acc: 99.22% | Time: 0.0369s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 98 [100/196] Loss: 0.0292 | Acc: 99.27% | Time: 0.0240s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0362, Acc: 99.28%
测试 - Loss: 1.0810, Acc: 74.85%
学习率: 0.010000, 时间: 10.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/196] Loss: 0.0408 | Acc: 99.22% | Time: 0.0328s | GPU Mem: 0.29GB/3.93GB
Rank 0 | Epoch: 99 [100/196] Loss: 0.0201 | Acc: 99.30% | Time: 0.0299s | GPU Mem: 0.29GB/3.93GB

训练 - Loss: 0.0355, Acc: 99.38%
测试 - Loss: 1.0913, Acc: 74.86%
学习率: 0.001000, 时间: 10.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.93GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.93GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 1221.58秒 (20.36分钟)
平均每epoch: 12.22秒
最佳测试准确率: 75.74%
保存最终模型到: ./experiments/group_1_training_mode_and_hardware_configuration_comparison/checkpoints/ddp_resnet50_bs128_gpu2_nw2_chunks0.pth

训练完成!
