====================================================================================================
Experiment: ddp_resnet34_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet34",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet34 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet34_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T02:52:20.321389
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet34
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet34_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.7992 | Acc: 0.00% | Time: 0.5915s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 4.0519, Acc: 9.05%
测试 - Loss: 3.7072, Acc: 12.92%
学习率: 0.100000, 时间: 13.75s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 0.00% -> 12.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 3.8288 | Acc: 6.25% | Time: 0.0317s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 3.4300, Acc: 17.11%
测试 - Loss: 3.5190, Acc: 17.07%
学习率: 0.100000, 时间: 4.22s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 12.92% -> 17.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 3.1938 | Acc: 21.09% | Time: 0.0298s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 3.0490, Acc: 23.62%
测试 - Loss: 3.0060, Acc: 25.60%
学习率: 0.100000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 17.07% -> 25.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 2.6677 | Acc: 28.12% | Time: 0.0240s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 2.6956, Acc: 30.59%
测试 - Loss: 2.9112, Acc: 27.98%
学习率: 0.100000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 25.60% -> 27.98%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 2.3871 | Acc: 36.72% | Time: 0.0277s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 2.3252, Acc: 38.19%
测试 - Loss: 2.5669, Acc: 34.33%
学习率: 0.100000, 时间: 3.94s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 27.98% -> 34.33%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 2.0757 | Acc: 38.28% | Time: 0.0271s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 2.0756, Acc: 44.06%
测试 - Loss: 2.2662, Acc: 41.27%
学习率: 0.100000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 34.33% -> 41.27%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 1.5695 | Acc: 54.69% | Time: 0.0278s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.8531, Acc: 48.78%
测试 - Loss: 2.1515, Acc: 44.27%
学习率: 0.100000, 时间: 4.37s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 41.27% -> 44.27%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 1.8437 | Acc: 50.00% | Time: 0.0315s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.6903, Acc: 52.89%
测试 - Loss: 1.8558, Acc: 49.42%
学习率: 0.100000, 时间: 4.08s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 44.27% -> 49.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 1.5040 | Acc: 53.12% | Time: 0.0286s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.5363, Acc: 55.90%
测试 - Loss: 1.9376, Acc: 48.35%
学习率: 0.100000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 1.5817 | Acc: 53.91% | Time: 0.0274s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.4251, Acc: 58.79%
测试 - Loss: 1.9043, Acc: 50.13%
学习率: 0.100000, 时间: 4.13s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 49.42% -> 50.13%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 1.5111 | Acc: 57.81% | Time: 0.0252s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.3122, Acc: 61.72%
测试 - Loss: 1.9600, Acc: 49.34%
学习率: 0.100000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 1.2177 | Acc: 58.59% | Time: 0.0285s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.2479, Acc: 63.36%
测试 - Loss: 1.7508, Acc: 53.24%
学习率: 0.100000, 时间: 4.08s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 50.13% -> 53.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 1.0718 | Acc: 68.75% | Time: 0.0314s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.1602, Acc: 65.79%
测试 - Loss: 1.6832, Acc: 55.31%
学习率: 0.100000, 时间: 4.12s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 53.24% -> 55.31%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 0.9982 | Acc: 67.97% | Time: 0.0284s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.0985, Acc: 67.68%
测试 - Loss: 1.5517, Acc: 57.75%
学习率: 0.100000, 时间: 4.11s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 55.31% -> 57.75%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 0.7940 | Acc: 77.34% | Time: 0.0252s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 1.0299, Acc: 69.27%
测试 - Loss: 1.4971, Acc: 59.34%
学习率: 0.100000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 57.75% -> 59.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 0.8123 | Acc: 77.34% | Time: 0.0323s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.9760, Acc: 71.02%
测试 - Loss: 1.4545, Acc: 60.46%
学习率: 0.100000, 时间: 3.98s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 59.34% -> 60.46%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 0.9399 | Acc: 69.53% | Time: 0.0304s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.9319, Acc: 72.10%
测试 - Loss: 1.5298, Acc: 59.18%
学习率: 0.100000, 时间: 3.97s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 0.8300 | Acc: 71.88% | Time: 0.0286s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.8916, Acc: 73.16%
测试 - Loss: 1.4449, Acc: 61.63%
学习率: 0.100000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 60.46% -> 61.63%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 0.8573 | Acc: 78.12% | Time: 0.0238s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.8454, Acc: 74.14%
测试 - Loss: 1.5282, Acc: 59.75%
学习率: 0.100000, 时间: 3.99s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 0.7734 | Acc: 77.34% | Time: 0.0297s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.8132, Acc: 75.22%
测试 - Loss: 1.4924, Acc: 60.61%
学习率: 0.100000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 0.8082 | Acc: 76.56% | Time: 0.0254s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.7717, Acc: 76.67%
测试 - Loss: 1.4632, Acc: 61.28%
学习率: 0.100000, 时间: 4.08s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 0.7525 | Acc: 79.69% | Time: 0.0258s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.7369, Acc: 77.62%
测试 - Loss: 1.4718, Acc: 61.78%
学习率: 0.100000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 61.63% -> 61.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 0.5913 | Acc: 78.91% | Time: 0.0243s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.7131, Acc: 78.18%
测试 - Loss: 1.3959, Acc: 63.16%
学习率: 0.100000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 61.78% -> 63.16%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 0.6551 | Acc: 78.12% | Time: 0.0273s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.6771, Acc: 78.92%
测试 - Loss: 1.5443, Acc: 60.80%
学习率: 0.100000, 时间: 4.19s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.3820 | Acc: 87.50% | Time: 0.0237s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.6566, Acc: 79.31%
测试 - Loss: 1.3647, Acc: 63.86%
学习率: 0.100000, 时间: 3.98s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 63.16% -> 63.86%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 0.5385 | Acc: 85.16% | Time: 0.0342s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.6185, Acc: 80.81%
测试 - Loss: 1.5061, Acc: 62.13%
学习率: 0.100000, 时间: 3.97s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 0.7207 | Acc: 75.00% | Time: 0.0184s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5939, Acc: 81.66%
测试 - Loss: 1.5537, Acc: 60.54%
学习率: 0.100000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 0.5397 | Acc: 86.72% | Time: 0.0286s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5690, Acc: 82.28%
测试 - Loss: 1.6001, Acc: 59.85%
学习率: 0.100000, 时间: 4.12s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.5375 | Acc: 83.59% | Time: 0.0208s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5836, Acc: 81.65%
测试 - Loss: 1.4831, Acc: 63.43%
学习率: 0.100000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.4153 | Acc: 89.06% | Time: 0.0293s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5410, Acc: 82.93%
测试 - Loss: 1.4348, Acc: 63.67%
学习率: 0.100000, 时间: 4.07s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.4032 | Acc: 85.16% | Time: 0.0282s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5225, Acc: 83.54%
测试 - Loss: 1.5271, Acc: 61.78%
学习率: 0.100000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.2845 | Acc: 92.19% | Time: 0.0246s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5129, Acc: 83.77%
测试 - Loss: 1.4427, Acc: 63.54%
学习率: 0.100000, 时间: 4.02s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.5392 | Acc: 82.03% | Time: 0.0220s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.5152, Acc: 83.90%
测试 - Loss: 1.4002, Acc: 64.37%
学习率: 0.100000, 时间: 4.13s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 63.86% -> 64.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.4074 | Acc: 86.72% | Time: 0.0275s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4899, Acc: 84.85%
测试 - Loss: 1.4283, Acc: 64.18%
学习率: 0.100000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.4788 | Acc: 84.38% | Time: 0.0262s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4923, Acc: 84.56%
测试 - Loss: 1.6201, Acc: 60.83%
学习率: 0.100000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.3514 | Acc: 90.62% | Time: 0.0327s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4575, Acc: 85.58%
测试 - Loss: 1.4393, Acc: 63.84%
学习率: 0.100000, 时间: 4.09s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.3848 | Acc: 87.50% | Time: 0.0286s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4668, Acc: 85.27%
测试 - Loss: 1.5692, Acc: 62.06%
学习率: 0.100000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.4115 | Acc: 88.28% | Time: 0.0265s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4653, Acc: 85.36%
测试 - Loss: 1.4813, Acc: 64.05%
学习率: 0.100000, 时间: 4.02s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.3121 | Acc: 90.62% | Time: 0.0317s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4504, Acc: 85.85%
测试 - Loss: 1.5248, Acc: 63.65%
学习率: 0.100000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.2612 | Acc: 93.75% | Time: 0.0264s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4281, Acc: 86.72%
测试 - Loss: 1.6693, Acc: 62.38%
学习率: 0.100000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.3689 | Acc: 89.84% | Time: 0.0267s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4179, Acc: 86.83%
测试 - Loss: 1.4494, Acc: 64.57%
学习率: 0.100000, 时间: 4.13s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 64.37% -> 64.57%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.4142 | Acc: 88.28% | Time: 0.0295s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4204, Acc: 87.02%
测试 - Loss: 1.5390, Acc: 63.03%
学习率: 0.100000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.3690 | Acc: 89.06% | Time: 0.0256s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4254, Acc: 86.78%
测试 - Loss: 1.7806, Acc: 60.21%
学习率: 0.100000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.3458 | Acc: 89.06% | Time: 0.0283s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.4163, Acc: 86.96%
测试 - Loss: 1.5662, Acc: 63.42%
学习率: 0.100000, 时间: 4.15s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.3756 | Acc: 89.84% | Time: 0.0264s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.3887, Acc: 87.66%
测试 - Loss: 1.4717, Acc: 65.87%
学习率: 0.100000, 时间: 4.09s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 64.57% -> 65.87%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.4922 | Acc: 88.28% | Time: 0.0204s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.3798, Acc: 88.10%
测试 - Loss: 1.6792, Acc: 61.83%
学习率: 0.100000, 时间: 4.13s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.4899 | Acc: 85.16% | Time: 0.0308s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.3921, Acc: 87.61%
测试 - Loss: 1.6491, Acc: 62.06%
学习率: 0.100000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.4232 | Acc: 85.16% | Time: 0.0315s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.3774, Acc: 88.06%
测试 - Loss: 1.6445, Acc: 62.72%
学习率: 0.100000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.3036 | Acc: 89.84% | Time: 0.0306s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.3794, Acc: 87.83%
测试 - Loss: 1.5466, Acc: 64.82%
学习率: 0.100000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.2652 | Acc: 89.84% | Time: 0.0271s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.3646, Acc: 88.78%
测试 - Loss: 1.4733, Acc: 65.77%
学习率: 0.010000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.3795 | Acc: 88.28% | Time: 0.0244s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.1691, Acc: 95.13%
测试 - Loss: 1.0134, Acc: 74.25%
学习率: 0.010000, 时间: 4.09s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 65.87% -> 74.25%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.0684 | Acc: 99.22% | Time: 0.0287s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0914, Acc: 97.89%
测试 - Loss: 0.9994, Acc: 74.92%
学习率: 0.010000, 时间: 4.12s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 74.25% -> 74.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.0670 | Acc: 99.22% | Time: 0.0261s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0717, Acc: 98.36%
测试 - Loss: 1.0054, Acc: 75.05%
学习率: 0.010000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 74.92% -> 75.05%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.0553 | Acc: 98.44% | Time: 0.0295s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0570, Acc: 98.94%
测试 - Loss: 0.9992, Acc: 74.97%
学习率: 0.010000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.0352 | Acc: 99.22% | Time: 0.0184s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0501, Acc: 99.06%
测试 - Loss: 0.9997, Acc: 75.47%
学习率: 0.010000, 时间: 4.09s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.05% -> 75.47%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.0400 | Acc: 99.22% | Time: 0.0282s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0451, Acc: 99.18%
测试 - Loss: 0.9963, Acc: 75.71%
学习率: 0.010000, 时间: 4.02s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.47% -> 75.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0486 | Acc: 98.44% | Time: 0.0320s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0395, Acc: 99.32%
测试 - Loss: 0.9980, Acc: 75.70%
学习率: 0.010000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0344 | Acc: 99.22% | Time: 0.0293s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0352, Acc: 99.45%
测试 - Loss: 1.0000, Acc: 75.56%
学习率: 0.010000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0299 | Acc: 99.22% | Time: 0.0313s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0337, Acc: 99.46%
测试 - Loss: 0.9998, Acc: 75.72%
学习率: 0.010000, 时间: 4.02s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.71% -> 75.72%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0276 | Acc: 100.00% | Time: 0.0248s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0306, Acc: 99.52%
测试 - Loss: 1.0025, Acc: 75.86%
学习率: 0.010000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.72% -> 75.86%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0177 | Acc: 100.00% | Time: 0.0268s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0295, Acc: 99.52%
测试 - Loss: 0.9951, Acc: 75.89%
学习率: 0.010000, 时间: 3.97s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.86% -> 75.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0347 | Acc: 99.22% | Time: 0.0304s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0272, Acc: 99.64%
测试 - Loss: 1.0016, Acc: 75.91%
学习率: 0.010000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.89% -> 75.91%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0209 | Acc: 99.22% | Time: 0.0278s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0265, Acc: 99.58%
测试 - Loss: 1.0082, Acc: 75.89%
学习率: 0.010000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0201 | Acc: 100.00% | Time: 0.0291s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0241, Acc: 99.74%
测试 - Loss: 1.0054, Acc: 75.67%
学习率: 0.010000, 时间: 3.99s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0208 | Acc: 99.22% | Time: 0.0271s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0224, Acc: 99.66%
测试 - Loss: 1.0067, Acc: 76.17%
学习率: 0.010000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 75.91% -> 76.17%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0139 | Acc: 100.00% | Time: 0.0306s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0210, Acc: 99.74%
测试 - Loss: 1.0070, Acc: 75.88%
学习率: 0.010000, 时间: 4.07s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0228 | Acc: 99.22% | Time: 0.0316s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0206, Acc: 99.75%
测试 - Loss: 1.0070, Acc: 75.82%
学习率: 0.010000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0222 | Acc: 100.00% | Time: 0.0292s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0197, Acc: 99.80%
测试 - Loss: 1.0090, Acc: 76.04%
学习率: 0.010000, 时间: 3.98s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0128 | Acc: 100.00% | Time: 0.0203s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0185, Acc: 99.84%
测试 - Loss: 1.0088, Acc: 75.96%
学习率: 0.010000, 时间: 4.02s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0147 | Acc: 100.00% | Time: 0.0268s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0187, Acc: 99.76%
测试 - Loss: 1.0078, Acc: 76.12%
学习率: 0.010000, 时间: 4.10s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0140 | Acc: 100.00% | Time: 0.0318s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0185, Acc: 99.78%
测试 - Loss: 1.0097, Acc: 76.04%
学习率: 0.010000, 时间: 4.08s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0120 | Acc: 100.00% | Time: 0.0308s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0163, Acc: 99.90%
测试 - Loss: 1.0074, Acc: 75.90%
学习率: 0.010000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0079 | Acc: 100.00% | Time: 0.0286s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0178, Acc: 99.81%
测试 - Loss: 1.0071, Acc: 75.95%
学习率: 0.010000, 时间: 4.02s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0166 | Acc: 100.00% | Time: 0.0292s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0160, Acc: 99.83%
测试 - Loss: 1.0039, Acc: 76.21%
学习率: 0.010000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.17% -> 76.21%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0092 | Acc: 100.00% | Time: 0.0219s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0159, Acc: 99.83%
测试 - Loss: 1.0043, Acc: 76.11%
学习率: 0.010000, 时间: 3.98s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0200 | Acc: 100.00% | Time: 0.0303s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0147, Acc: 99.86%
测试 - Loss: 1.0050, Acc: 76.16%
学习率: 0.010000, 时间: 4.09s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0213 | Acc: 100.00% | Time: 0.0318s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0147, Acc: 99.90%
测试 - Loss: 1.0019, Acc: 76.21%
学习率: 0.010000, 时间: 4.12s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0085 | Acc: 100.00% | Time: 0.0266s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0142, Acc: 99.88%
测试 - Loss: 1.0052, Acc: 75.97%
学习率: 0.010000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0132 | Acc: 100.00% | Time: 0.0300s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0145, Acc: 99.89%
测试 - Loss: 1.0002, Acc: 76.04%
学习率: 0.010000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0118 | Acc: 100.00% | Time: 0.0287s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0130, Acc: 99.90%
测试 - Loss: 1.0003, Acc: 76.13%
学习率: 0.010000, 时间: 3.99s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0089 | Acc: 100.00% | Time: 0.0227s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0127, Acc: 99.91%
测试 - Loss: 0.9977, Acc: 76.19%
学习率: 0.010000, 时间: 4.07s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0068 | Acc: 100.00% | Time: 0.0258s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0137, Acc: 99.90%
测试 - Loss: 0.9959, Acc: 76.15%
学习率: 0.010000, 时间: 4.10s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0087 | Acc: 100.00% | Time: 0.0262s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0125, Acc: 99.91%
测试 - Loss: 0.9945, Acc: 76.21%
学习率: 0.010000, 时间: 4.15s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0095 | Acc: 100.00% | Time: 0.0277s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0127, Acc: 99.90%
测试 - Loss: 0.9942, Acc: 76.13%
学习率: 0.010000, 时间: 4.10s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0137 | Acc: 100.00% | Time: 0.0268s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0131, Acc: 99.89%
测试 - Loss: 0.9969, Acc: 76.22%
学习率: 0.010000, 时间: 4.09s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.21% -> 76.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0132 | Acc: 100.00% | Time: 0.0253s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0132, Acc: 99.86%
测试 - Loss: 0.9994, Acc: 76.28%
学习率: 0.010000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.22% -> 76.28%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0086 | Acc: 100.00% | Time: 0.0291s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0115, Acc: 99.90%
测试 - Loss: 0.9985, Acc: 76.35%
学习率: 0.010000, 时间: 4.04s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.28% -> 76.35%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0132 | Acc: 100.00% | Time: 0.0309s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0124, Acc: 99.90%
测试 - Loss: 0.9925, Acc: 76.34%
学习率: 0.010000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0096 | Acc: 100.00% | Time: 0.0258s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0118, Acc: 99.94%
测试 - Loss: 0.9949, Acc: 76.11%
学习率: 0.010000, 时间: 3.98s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0068 | Acc: 100.00% | Time: 0.0210s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0108, Acc: 99.94%
测试 - Loss: 0.9900, Acc: 76.48%
学习率: 0.010000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.35% -> 76.48%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0066 | Acc: 100.00% | Time: 0.0295s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0111, Acc: 99.94%
测试 - Loss: 0.9930, Acc: 76.41%
学习率: 0.010000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0059 | Acc: 100.00% | Time: 0.0205s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0109, Acc: 99.94%
测试 - Loss: 0.9906, Acc: 76.50%
学习率: 0.010000, 时间: 4.06s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.48% -> 76.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0092 | Acc: 100.00% | Time: 0.0299s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0108, Acc: 99.93%
测试 - Loss: 0.9875, Acc: 76.35%
学习率: 0.010000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0072 | Acc: 100.00% | Time: 0.0222s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0104, Acc: 99.96%
测试 - Loss: 0.9896, Acc: 76.34%
学习率: 0.010000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0069 | Acc: 100.00% | Time: 0.0190s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0109, Acc: 99.91%
测试 - Loss: 0.9856, Acc: 76.40%
学习率: 0.010000, 时间: 4.00s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0182 | Acc: 100.00% | Time: 0.0193s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0121, Acc: 99.88%
测试 - Loss: 0.9860, Acc: 76.28%
学习率: 0.010000, 时间: 4.08s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0083 | Acc: 100.00% | Time: 0.0393s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0112, Acc: 99.93%
测试 - Loss: 0.9861, Acc: 76.32%
学习率: 0.010000, 时间: 4.05s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0092 | Acc: 100.00% | Time: 0.0255s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0106, Acc: 99.95%
测试 - Loss: 0.9834, Acc: 76.40%
学习率: 0.010000, 时间: 4.03s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0105 | Acc: 100.00% | Time: 0.0237s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0098, Acc: 99.96%
测试 - Loss: 0.9854, Acc: 76.38%
学习率: 0.010000, 时间: 4.01s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0053 | Acc: 100.00% | Time: 0.0237s | GPU Mem: 0.26GB/1.61GB

训练 - Loss: 0.0109, Acc: 99.94%
测试 - Loss: 0.9824, Acc: 76.51%
学习率: 0.001000, 时间: 3.95s
GPU内存使用:
  GPU 1 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 2 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 3 - 已分配: 0.26GB, 已保留: 1.61GB
  GPU 5 - 已分配: 0.26GB, 已保留: 1.61GB
最佳准确率更新: 76.50% -> 76.51%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 515.88秒 (8.60分钟)
平均每epoch: 5.16秒
最佳测试准确率: 76.51%
保存最终模型到: ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet34_bs128_gpu4_nw2_chunks0.pth

训练完成!
