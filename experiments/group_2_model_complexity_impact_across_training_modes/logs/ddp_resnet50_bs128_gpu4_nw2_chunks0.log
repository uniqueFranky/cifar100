====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T03:01:16.658377
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.7093 | Acc: 0.00% | Time: 0.5787s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.3424, Acc: 1.14%
测试 - Loss: 4.6277, Acc: 2.34%
学习率: 0.100000, 时间: 15.24s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 2.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.6120 | Acc: 1.56% | Time: 0.0502s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.4020, Acc: 3.05%
测试 - Loss: 4.2313, Acc: 4.52%
学习率: 0.100000, 时间: 5.96s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 2.34% -> 4.52%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.2665 | Acc: 2.34% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.1489, Acc: 5.30%
测试 - Loss: 3.9853, Acc: 7.15%
学习率: 0.100000, 时间: 5.99s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 4.52% -> 7.15%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.7926 | Acc: 10.16% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.9108, Acc: 8.59%
测试 - Loss: 3.7575, Acc: 11.26%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 7.15% -> 11.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.6564 | Acc: 11.72% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.6936, Acc: 11.72%
测试 - Loss: 3.5665, Acc: 14.06%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 11.26% -> 14.06%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.7116 | Acc: 8.59% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.5215, Acc: 15.50%
测试 - Loss: 3.3850, Acc: 17.44%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 14.06% -> 17.44%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.3383 | Acc: 16.41% | Time: 0.0368s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.3177, Acc: 18.69%
测试 - Loss: 3.2168, Acc: 22.00%
学习率: 0.100000, 时间: 5.98s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 17.44% -> 22.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.2173 | Acc: 21.09% | Time: 0.0385s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.1251, Acc: 22.45%
测试 - Loss: 3.0808, Acc: 23.76%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 22.00% -> 23.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 3.0351 | Acc: 17.97% | Time: 0.0299s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.9327, Acc: 26.18%
测试 - Loss: 2.9101, Acc: 27.79%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 23.76% -> 27.79%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.7001 | Acc: 32.03% | Time: 0.0393s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.7919, Acc: 29.20%
测试 - Loss: 2.8445, Acc: 28.54%
学习率: 0.100000, 时间: 5.98s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 27.79% -> 28.54%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.8355 | Acc: 31.25% | Time: 0.0339s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.6334, Acc: 32.76%
测试 - Loss: 2.6445, Acc: 33.51%
学习率: 0.100000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 28.54% -> 33.51%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.5773 | Acc: 38.28% | Time: 0.0286s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.4392, Acc: 36.67%
测试 - Loss: 2.4358, Acc: 37.12%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 33.51% -> 37.12%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.2611 | Acc: 34.38% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2471, Acc: 40.30%
测试 - Loss: 2.4300, Acc: 38.80%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 37.12% -> 38.80%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 2.0114 | Acc: 42.97% | Time: 0.0287s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0978, Acc: 43.30%
测试 - Loss: 2.3769, Acc: 39.50%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 38.80% -> 39.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.5262 | Acc: 60.94% | Time: 0.0273s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9977, Acc: 45.73%
测试 - Loss: 2.2164, Acc: 42.37%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 39.50% -> 42.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.7156 | Acc: 53.91% | Time: 0.0384s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8928, Acc: 47.70%
测试 - Loss: 2.1453, Acc: 43.85%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 42.37% -> 43.85%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.7772 | Acc: 46.88% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8046, Acc: 50.54%
测试 - Loss: 2.0477, Acc: 46.06%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 43.85% -> 46.06%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.5392 | Acc: 53.91% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6856, Acc: 53.26%
测试 - Loss: 1.9377, Acc: 49.57%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 46.06% -> 49.57%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.6048 | Acc: 55.47% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5698, Acc: 55.88%
测试 - Loss: 2.1287, Acc: 48.60%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.4159 | Acc: 62.50% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5148, Acc: 57.24%
测试 - Loss: 1.8554, Acc: 50.58%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 49.57% -> 50.58%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.4147 | Acc: 63.28% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4271, Acc: 59.29%
测试 - Loss: 1.9890, Acc: 51.62%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.58% -> 51.62%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.3056 | Acc: 60.16% | Time: 0.0407s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3657, Acc: 61.08%
测试 - Loss: 1.6446, Acc: 55.65%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 51.62% -> 55.65%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.2550 | Acc: 62.50% | Time: 0.0301s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2954, Acc: 62.26%
测试 - Loss: 1.6575, Acc: 55.81%
学习率: 0.100000, 时间: 5.97s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 55.65% -> 55.81%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.2027 | Acc: 60.94% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2235, Acc: 63.97%
测试 - Loss: 1.7132, Acc: 55.50%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.9882 | Acc: 70.31% | Time: 0.0404s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1970, Acc: 64.70%
测试 - Loss: 1.8357, Acc: 53.75%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 1.1120 | Acc: 65.62% | Time: 0.0286s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1279, Acc: 66.82%
测试 - Loss: 1.6000, Acc: 56.85%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 55.81% -> 56.85%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 0.8685 | Acc: 74.22% | Time: 0.0275s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0644, Acc: 68.54%
测试 - Loss: 1.7749, Acc: 56.39%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 1.1066 | Acc: 66.41% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0317, Acc: 68.71%
测试 - Loss: 1.5862, Acc: 58.08%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 56.85% -> 58.08%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.8820 | Acc: 73.44% | Time: 0.0304s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0281, Acc: 69.66%
测试 - Loss: 1.8144, Acc: 54.85%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.9699 | Acc: 67.19% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9638, Acc: 70.99%
测试 - Loss: 1.4875, Acc: 59.95%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.08% -> 59.95%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.7006 | Acc: 78.91% | Time: 0.0395s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9237, Acc: 72.49%
测试 - Loss: 1.4192, Acc: 61.25%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.95% -> 61.25%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.5935 | Acc: 89.06% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8674, Acc: 74.14%
测试 - Loss: 1.4460, Acc: 61.37%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.25% -> 61.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8278 | Acc: 76.56% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8556, Acc: 73.88%
测试 - Loss: 1.6652, Acc: 57.40%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.7651 | Acc: 81.25% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8093, Acc: 75.21%
测试 - Loss: 1.7206, Acc: 56.28%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.8108 | Acc: 75.00% | Time: 0.0218s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8024, Acc: 75.56%
测试 - Loss: 1.5238, Acc: 60.25%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.6712 | Acc: 78.12% | Time: 0.0423s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7664, Acc: 76.41%
测试 - Loss: 1.5144, Acc: 60.75%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.5900 | Acc: 81.25% | Time: 0.0286s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7673, Acc: 76.38%
测试 - Loss: 1.5334, Acc: 60.14%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.8304 | Acc: 73.44% | Time: 0.0280s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7372, Acc: 77.70%
测试 - Loss: 1.4708, Acc: 61.51%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.37% -> 61.51%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.7569 | Acc: 78.12% | Time: 0.0299s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7127, Acc: 78.21%
测试 - Loss: 1.5403, Acc: 60.36%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.5373 | Acc: 82.81% | Time: 0.0270s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6876, Acc: 78.67%
测试 - Loss: 1.6406, Acc: 59.05%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.7018 | Acc: 75.78% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6789, Acc: 79.08%
测试 - Loss: 1.4732, Acc: 61.56%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.51% -> 61.56%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6695 | Acc: 76.56% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6783, Acc: 79.17%
测试 - Loss: 1.6732, Acc: 59.13%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.5949 | Acc: 82.03% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6353, Acc: 80.28%
测试 - Loss: 1.5711, Acc: 61.50%
学习率: 0.100000, 时间: 5.95s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.6770 | Acc: 78.12% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6180, Acc: 80.96%
测试 - Loss: 1.5691, Acc: 61.07%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.4210 | Acc: 85.16% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6194, Acc: 80.86%
测试 - Loss: 1.5704, Acc: 61.73%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.56% -> 61.73%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.5896 | Acc: 78.91% | Time: 0.0302s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5969, Acc: 81.49%
测试 - Loss: 1.6694, Acc: 60.22%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.5879 | Acc: 82.03% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5728, Acc: 81.74%
测试 - Loss: 1.6519, Acc: 59.01%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.6358 | Acc: 80.47% | Time: 0.0339s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5851, Acc: 82.01%
测试 - Loss: 1.5207, Acc: 62.15%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.73% -> 62.15%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4854 | Acc: 85.94% | Time: 0.0377s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5717, Acc: 82.12%
测试 - Loss: 1.7734, Acc: 58.91%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.4375 | Acc: 85.16% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5818, Acc: 81.78%
测试 - Loss: 1.8026, Acc: 57.31%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.6155 | Acc: 81.25% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.3062, Acc: 91.23%
测试 - Loss: 1.0661, Acc: 72.02%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.15% -> 72.02%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1558 | Acc: 96.88% | Time: 0.0427s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1885, Acc: 94.74%
测试 - Loss: 1.0551, Acc: 72.78%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.02% -> 72.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.1996 | Acc: 93.75% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1594, Acc: 96.04%
测试 - Loss: 1.0614, Acc: 73.14%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.78% -> 73.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1294 | Acc: 98.44% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1352, Acc: 96.70%
测试 - Loss: 1.0730, Acc: 72.96%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.0974 | Acc: 98.44% | Time: 0.0324s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1216, Acc: 97.29%
测试 - Loss: 1.0729, Acc: 72.92%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.1126 | Acc: 96.09% | Time: 0.0302s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1128, Acc: 97.42%
测试 - Loss: 1.0912, Acc: 72.99%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.1131 | Acc: 97.66% | Time: 0.0369s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1016, Acc: 97.77%
测试 - Loss: 1.0798, Acc: 73.23%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.14% -> 73.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0913 | Acc: 97.66% | Time: 0.0361s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0897, Acc: 98.17%
测试 - Loss: 1.0944, Acc: 73.10%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0859 | Acc: 100.00% | Time: 0.0410s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0832, Acc: 98.39%
测试 - Loss: 1.1034, Acc: 73.22%
学习率: 0.010000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0791 | Acc: 97.66% | Time: 0.0333s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0811, Acc: 98.45%
测试 - Loss: 1.1119, Acc: 73.15%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0505 | Acc: 99.22% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0716, Acc: 98.70%
测试 - Loss: 1.1106, Acc: 73.14%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0460 | Acc: 100.00% | Time: 0.0266s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0691, Acc: 98.57%
测试 - Loss: 1.1212, Acc: 72.78%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0415 | Acc: 100.00% | Time: 0.0289s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0663, Acc: 98.77%
测试 - Loss: 1.1175, Acc: 73.14%
学习率: 0.010000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0427 | Acc: 99.22% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0618, Acc: 98.87%
测试 - Loss: 1.1237, Acc: 73.19%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0445 | Acc: 99.22% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0571, Acc: 99.02%
测试 - Loss: 1.1286, Acc: 72.96%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0564 | Acc: 99.22% | Time: 0.0400s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0529, Acc: 99.16%
测试 - Loss: 1.1295, Acc: 73.05%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0838 | Acc: 98.44% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0525, Acc: 99.18%
测试 - Loss: 1.1409, Acc: 73.02%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0630 | Acc: 98.44% | Time: 0.0269s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0478, Acc: 99.31%
测试 - Loss: 1.1429, Acc: 73.06%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0232 | Acc: 100.00% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0472, Acc: 99.28%
测试 - Loss: 1.1407, Acc: 73.06%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0464 | Acc: 99.22% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0430, Acc: 99.42%
测试 - Loss: 1.1438, Acc: 72.93%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0151 | Acc: 100.00% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0416, Acc: 99.43%
测试 - Loss: 1.1470, Acc: 73.17%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0195 | Acc: 100.00% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0412, Acc: 99.45%
测试 - Loss: 1.1523, Acc: 73.23%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0438 | Acc: 99.22% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0391, Acc: 99.40%
测试 - Loss: 1.1580, Acc: 73.14%
学习率: 0.010000, 时间: 5.96s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0262 | Acc: 100.00% | Time: 0.0266s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0359, Acc: 99.57%
测试 - Loss: 1.1573, Acc: 73.05%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0348 | Acc: 99.22% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0354, Acc: 99.50%
测试 - Loss: 1.1647, Acc: 73.20%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0248 | Acc: 100.00% | Time: 0.0379s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0329, Acc: 99.61%
测试 - Loss: 1.1542, Acc: 73.14%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0308 | Acc: 100.00% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0309, Acc: 99.66%
测试 - Loss: 1.1577, Acc: 73.21%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0538 | Acc: 98.44% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0306, Acc: 99.61%
测试 - Loss: 1.1636, Acc: 73.03%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0337 | Acc: 99.22% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0292, Acc: 99.74%
测试 - Loss: 1.1630, Acc: 73.30%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.23% -> 73.30%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0360 | Acc: 99.22% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0289, Acc: 99.64%
测试 - Loss: 1.1706, Acc: 73.14%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0248 | Acc: 99.22% | Time: 0.0434s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0284, Acc: 99.74%
测试 - Loss: 1.1585, Acc: 73.09%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0117 | Acc: 100.00% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0294, Acc: 99.58%
测试 - Loss: 1.1719, Acc: 73.12%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0207 | Acc: 100.00% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0272, Acc: 99.71%
测试 - Loss: 1.1710, Acc: 73.15%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0195 | Acc: 100.00% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0271, Acc: 99.70%
测试 - Loss: 1.1658, Acc: 73.33%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.30% -> 73.33%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0259 | Acc: 100.00% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0245, Acc: 99.79%
测试 - Loss: 1.1783, Acc: 72.91%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0352 | Acc: 100.00% | Time: 0.0295s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0252, Acc: 99.74%
测试 - Loss: 1.1754, Acc: 73.19%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0120 | Acc: 100.00% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0221, Acc: 99.85%
测试 - Loss: 1.1777, Acc: 73.22%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0134 | Acc: 100.00% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0234, Acc: 99.76%
测试 - Loss: 1.1839, Acc: 73.19%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0139 | Acc: 100.00% | Time: 0.0400s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0225, Acc: 99.80%
测试 - Loss: 1.1728, Acc: 73.29%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0147 | Acc: 100.00% | Time: 0.0354s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0208, Acc: 99.87%
测试 - Loss: 1.1702, Acc: 73.41%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.33% -> 73.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0281 | Acc: 99.22% | Time: 0.0387s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0211, Acc: 99.86%
测试 - Loss: 1.1709, Acc: 73.41%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0115 | Acc: 100.00% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0193, Acc: 99.90%
测试 - Loss: 1.1657, Acc: 73.39%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0166 | Acc: 100.00% | Time: 0.0285s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0203, Acc: 99.84%
测试 - Loss: 1.1718, Acc: 73.36%
学习率: 0.010000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0231 | Acc: 99.22% | Time: 0.0319s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0203, Acc: 99.83%
测试 - Loss: 1.1738, Acc: 72.94%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0116 | Acc: 100.00% | Time: 0.0417s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0214, Acc: 99.77%
测试 - Loss: 1.1654, Acc: 73.16%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0267 | Acc: 99.22% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0214, Acc: 99.75%
测试 - Loss: 1.1745, Acc: 73.05%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0170 | Acc: 100.00% | Time: 0.0375s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0189, Acc: 99.90%
测试 - Loss: 1.1769, Acc: 73.43%
学习率: 0.010000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.41% -> 73.43%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0185 | Acc: 100.00% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0182, Acc: 99.89%
测试 - Loss: 1.1626, Acc: 73.23%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0143 | Acc: 100.00% | Time: 0.0281s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0178, Acc: 99.87%
测试 - Loss: 1.1768, Acc: 73.25%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0174 | Acc: 100.00% | Time: 0.0302s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0182, Acc: 99.90%
测试 - Loss: 1.1663, Acc: 73.54%
学习率: 0.001000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.43% -> 73.54%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 722.15秒 (12.04分钟)
平均每epoch: 7.22秒
最佳测试准确率: 73.54%
保存最终模型到: ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth

训练完成!
