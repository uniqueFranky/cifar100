====================================================================================================
Experiment: ddp_resnet18_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet18",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet18 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet18_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T02:45:59.498142
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet18
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet18_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.7093 | Acc: 0.00% | Time: 1.3172s | GPU Mem: 0.14GB/1.10GB

训练 - Loss: 3.9435, Acc: 10.25%
测试 - Loss: 3.7387, Acc: 13.99%
学习率: 0.100000, 时间: 12.46s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 0.00% -> 13.99%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 3.7395 | Acc: 7.03% | Time: 0.0169s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 3.2868, Acc: 20.04%
测试 - Loss: 3.3121, Acc: 19.26%
学习率: 0.100000, 时间: 2.91s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 13.99% -> 19.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 2.9845 | Acc: 26.56% | Time: 0.0212s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 2.8670, Acc: 27.02%
测试 - Loss: 2.8466, Acc: 28.64%
学习率: 0.100000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 19.26% -> 28.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 2.3765 | Acc: 35.16% | Time: 0.0205s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 2.4954, Acc: 34.50%
测试 - Loss: 2.5776, Acc: 34.41%
学习率: 0.100000, 时间: 2.76s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 28.64% -> 34.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 2.2077 | Acc: 36.72% | Time: 0.0204s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 2.1693, Acc: 41.50%
测试 - Loss: 2.4377, Acc: 36.86%
学习率: 0.100000, 时间: 2.73s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 34.41% -> 36.86%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 2.0421 | Acc: 38.28% | Time: 0.0154s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.9654, Acc: 46.21%
测试 - Loss: 2.3795, Acc: 40.46%
学习率: 0.100000, 时间: 2.79s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 36.86% -> 40.46%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 1.4914 | Acc: 56.25% | Time: 0.0219s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.7561, Acc: 51.10%
测试 - Loss: 2.0321, Acc: 45.94%
学习率: 0.100000, 时间: 2.72s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 40.46% -> 45.94%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 1.8540 | Acc: 46.88% | Time: 0.0255s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.5989, Acc: 54.82%
测试 - Loss: 1.8793, Acc: 49.00%
学习率: 0.100000, 时间: 2.67s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 45.94% -> 49.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 1.4029 | Acc: 56.25% | Time: 0.0161s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.4666, Acc: 57.58%
测试 - Loss: 1.7364, Acc: 52.78%
学习率: 0.100000, 时间: 2.72s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 49.00% -> 52.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 1.2535 | Acc: 64.84% | Time: 0.0197s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.3549, Acc: 60.77%
测试 - Loss: 1.8150, Acc: 52.02%
学习率: 0.100000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 1.4149 | Acc: 57.81% | Time: 0.0248s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.2530, Acc: 63.50%
测试 - Loss: 1.7947, Acc: 52.69%
学习率: 0.100000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 1.2533 | Acc: 61.72% | Time: 0.0179s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.1741, Acc: 65.41%
测试 - Loss: 1.7442, Acc: 53.82%
学习率: 0.100000, 时间: 2.80s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 52.78% -> 53.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 1.1894 | Acc: 64.84% | Time: 0.0214s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.1105, Acc: 67.53%
测试 - Loss: 1.5406, Acc: 57.49%
学习率: 0.100000, 时间: 2.66s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 53.82% -> 57.49%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 1.0312 | Acc: 69.53% | Time: 0.0203s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 1.0377, Acc: 69.73%
测试 - Loss: 1.5678, Acc: 57.63%
学习率: 0.100000, 时间: 3.21s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 57.49% -> 57.63%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 0.7781 | Acc: 75.00% | Time: 0.0216s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.9957, Acc: 70.43%
测试 - Loss: 1.4656, Acc: 60.04%
学习率: 0.100000, 时间: 2.65s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 57.63% -> 60.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 0.7788 | Acc: 77.34% | Time: 0.0161s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.9234, Acc: 72.15%
测试 - Loss: 1.6212, Acc: 57.43%
学习率: 0.100000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 0.9141 | Acc: 68.75% | Time: 0.0153s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.8811, Acc: 73.62%
测试 - Loss: 1.4590, Acc: 60.27%
学习率: 0.100000, 时间: 2.72s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 60.04% -> 60.27%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 0.6459 | Acc: 79.69% | Time: 0.0237s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.8304, Acc: 75.17%
测试 - Loss: 1.5994, Acc: 58.51%
学习率: 0.100000, 时间: 2.68s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 0.8055 | Acc: 75.00% | Time: 0.0171s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.7944, Acc: 75.95%
测试 - Loss: 1.4320, Acc: 61.67%
学习率: 0.100000, 时间: 2.65s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 60.27% -> 61.67%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 0.5811 | Acc: 81.25% | Time: 0.0180s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.7545, Acc: 77.00%
测试 - Loss: 1.5667, Acc: 59.45%
学习率: 0.100000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 0.7144 | Acc: 75.78% | Time: 0.0145s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.7165, Acc: 78.23%
测试 - Loss: 1.4523, Acc: 61.24%
学习率: 0.100000, 时间: 2.82s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 0.6421 | Acc: 78.12% | Time: 0.0113s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.6791, Acc: 79.07%
测试 - Loss: 1.4185, Acc: 62.78%
学习率: 0.100000, 时间: 2.70s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 61.67% -> 62.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 0.4694 | Acc: 85.16% | Time: 0.0185s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.6613, Acc: 79.63%
测试 - Loss: 1.4097, Acc: 62.18%
学习率: 0.100000, 时间: 2.71s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 0.6019 | Acc: 84.38% | Time: 0.0133s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.6220, Acc: 80.98%
测试 - Loss: 1.5652, Acc: 61.09%
学习率: 0.100000, 时间: 2.82s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.4230 | Acc: 88.28% | Time: 0.0188s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.6078, Acc: 81.03%
测试 - Loss: 1.5204, Acc: 61.38%
学习率: 0.100000, 时间: 2.80s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 0.5460 | Acc: 80.47% | Time: 0.0219s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.5597, Acc: 82.70%
测试 - Loss: 1.4780, Acc: 62.10%
学习率: 0.100000, 时间: 2.92s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 0.5259 | Acc: 82.03% | Time: 0.0223s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.5251, Acc: 83.62%
测试 - Loss: 1.4922, Acc: 62.28%
学习率: 0.100000, 时间: 2.76s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 0.4194 | Acc: 86.72% | Time: 0.0158s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.5276, Acc: 83.52%
测试 - Loss: 1.5111, Acc: 63.04%
学习率: 0.100000, 时间: 2.89s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 62.78% -> 63.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.3924 | Acc: 86.72% | Time: 0.0144s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.5138, Acc: 84.21%
测试 - Loss: 1.6573, Acc: 60.19%
学习率: 0.100000, 时间: 2.73s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.5366 | Acc: 81.25% | Time: 0.0160s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4980, Acc: 84.43%
测试 - Loss: 1.5620, Acc: 62.34%
学习率: 0.100000, 时间: 2.79s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.4451 | Acc: 85.16% | Time: 0.0172s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4762, Acc: 85.36%
测试 - Loss: 1.4878, Acc: 63.28%
学习率: 0.100000, 时间: 2.71s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 63.04% -> 63.28%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.3385 | Acc: 90.62% | Time: 0.0160s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4582, Acc: 85.73%
测试 - Loss: 1.6319, Acc: 61.21%
学习率: 0.100000, 时间: 2.81s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.4247 | Acc: 87.50% | Time: 0.0167s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4663, Acc: 85.09%
测试 - Loss: 1.5147, Acc: 62.68%
学习率: 0.100000, 时间: 2.84s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.4379 | Acc: 84.38% | Time: 0.0238s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4440, Acc: 86.02%
测试 - Loss: 1.8018, Acc: 58.05%
学习率: 0.100000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.4962 | Acc: 83.59% | Time: 0.0212s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4270, Acc: 86.67%
测试 - Loss: 1.6973, Acc: 60.91%
学习率: 0.100000, 时间: 2.81s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.3734 | Acc: 89.06% | Time: 0.0160s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4252, Acc: 86.54%
测试 - Loss: 1.4759, Acc: 64.18%
学习率: 0.100000, 时间: 2.81s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 63.28% -> 64.18%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.4160 | Acc: 84.38% | Time: 0.0176s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4130, Acc: 87.57%
测试 - Loss: 1.6031, Acc: 62.54%
学习率: 0.100000, 时间: 2.64s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.3551 | Acc: 88.28% | Time: 0.0206s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.4012, Acc: 87.66%
测试 - Loss: 1.5538, Acc: 63.43%
学习率: 0.100000, 时间: 2.68s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.4501 | Acc: 84.38% | Time: 0.0222s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3774, Acc: 88.42%
测试 - Loss: 1.6788, Acc: 60.59%
学习率: 0.100000, 时间: 2.67s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.2558 | Acc: 93.75% | Time: 0.0163s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3802, Acc: 88.36%
测试 - Loss: 1.6967, Acc: 61.53%
学习率: 0.100000, 时间: 3.04s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.3590 | Acc: 89.84% | Time: 0.0120s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3706, Acc: 88.50%
测试 - Loss: 1.5410, Acc: 62.68%
学习率: 0.100000, 时间: 2.67s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.3259 | Acc: 89.84% | Time: 0.0112s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3589, Acc: 88.94%
测试 - Loss: 1.5911, Acc: 62.27%
学习率: 0.100000, 时间: 2.74s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.3743 | Acc: 89.06% | Time: 0.0156s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3615, Acc: 88.75%
测试 - Loss: 1.6570, Acc: 62.23%
学习率: 0.100000, 时间: 2.61s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.2442 | Acc: 92.97% | Time: 0.0149s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3496, Acc: 89.23%
测试 - Loss: 1.6244, Acc: 62.73%
学习率: 0.100000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.3407 | Acc: 94.53% | Time: 0.0133s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3464, Acc: 89.70%
测试 - Loss: 1.5396, Acc: 64.27%
学习率: 0.100000, 时间: 2.70s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 64.18% -> 64.27%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.3262 | Acc: 88.28% | Time: 0.0212s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3258, Acc: 89.90%
测试 - Loss: 1.7708, Acc: 60.58%
学习率: 0.100000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.2786 | Acc: 91.41% | Time: 0.0194s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3283, Acc: 89.88%
测试 - Loss: 1.6716, Acc: 60.87%
学习率: 0.100000, 时间: 2.65s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.3012 | Acc: 91.41% | Time: 0.0159s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3331, Acc: 89.64%
测试 - Loss: 1.7139, Acc: 61.46%
学习率: 0.100000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.2728 | Acc: 92.97% | Time: 0.0200s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3406, Acc: 89.48%
测试 - Loss: 1.7167, Acc: 59.73%
学习率: 0.100000, 时间: 2.61s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.2430 | Acc: 89.84% | Time: 0.0149s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.3230, Acc: 89.91%
测试 - Loss: 1.6437, Acc: 62.56%
学习率: 0.010000, 时间: 2.66s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.3030 | Acc: 89.06% | Time: 0.0178s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.1547, Acc: 96.12%
测试 - Loss: 1.0762, Acc: 72.89%
学习率: 0.010000, 时间: 2.74s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 64.27% -> 72.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.0593 | Acc: 100.00% | Time: 0.0121s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0850, Acc: 98.28%
测试 - Loss: 1.0606, Acc: 73.34%
学习率: 0.010000, 时间: 2.61s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 72.89% -> 73.34%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.0622 | Acc: 99.22% | Time: 0.0168s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0622, Acc: 98.92%
测试 - Loss: 1.0480, Acc: 73.92%
学习率: 0.010000, 时间: 2.68s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 73.34% -> 73.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.0437 | Acc: 99.22% | Time: 0.0213s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0590, Acc: 99.06%
测试 - Loss: 1.0467, Acc: 73.81%
学习率: 0.010000, 时间: 2.60s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.0461 | Acc: 100.00% | Time: 0.0224s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0491, Acc: 99.34%
测试 - Loss: 1.0403, Acc: 74.32%
学习率: 0.010000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 73.92% -> 74.32%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.0352 | Acc: 99.22% | Time: 0.0223s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0462, Acc: 99.38%
测试 - Loss: 1.0406, Acc: 73.95%
学习率: 0.010000, 时间: 2.76s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0607 | Acc: 98.44% | Time: 0.0181s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0391, Acc: 99.51%
测试 - Loss: 1.0400, Acc: 74.21%
学习率: 0.010000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0165 | Acc: 100.00% | Time: 0.0150s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0370, Acc: 99.58%
测试 - Loss: 1.0407, Acc: 74.35%
学习率: 0.010000, 时间: 2.68s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.32% -> 74.35%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0287 | Acc: 100.00% | Time: 0.0152s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0362, Acc: 99.58%
测试 - Loss: 1.0373, Acc: 74.31%
学习率: 0.010000, 时间: 2.68s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0227 | Acc: 100.00% | Time: 0.0146s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0341, Acc: 99.58%
测试 - Loss: 1.0425, Acc: 74.42%
学习率: 0.010000, 时间: 2.86s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.35% -> 74.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0256 | Acc: 100.00% | Time: 0.0234s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0324, Acc: 99.64%
测试 - Loss: 1.0374, Acc: 74.57%
学习率: 0.010000, 时间: 2.68s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.42% -> 74.57%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0202 | Acc: 100.00% | Time: 0.0205s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0307, Acc: 99.74%
测试 - Loss: 1.0397, Acc: 74.44%
学习率: 0.010000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0244 | Acc: 100.00% | Time: 0.0193s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0287, Acc: 99.76%
测试 - Loss: 1.0347, Acc: 74.46%
学习率: 0.010000, 时间: 2.76s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0163 | Acc: 100.00% | Time: 0.0189s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0277, Acc: 99.80%
测试 - Loss: 1.0402, Acc: 74.43%
学习率: 0.010000, 时间: 2.64s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0342 | Acc: 100.00% | Time: 0.0111s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0266, Acc: 99.79%
测试 - Loss: 1.0368, Acc: 74.43%
学习率: 0.010000, 时间: 2.58s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0319 | Acc: 99.22% | Time: 0.0155s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0246, Acc: 99.84%
测试 - Loss: 1.0324, Acc: 74.34%
学习率: 0.010000, 时间: 2.65s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0400 | Acc: 99.22% | Time: 0.0225s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0246, Acc: 99.86%
测试 - Loss: 1.0335, Acc: 74.33%
学习率: 0.010000, 时间: 2.63s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0216 | Acc: 100.00% | Time: 0.0133s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0243, Acc: 99.81%
测试 - Loss: 1.0347, Acc: 74.50%
学习率: 0.010000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0242 | Acc: 100.00% | Time: 0.0154s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0235, Acc: 99.86%
测试 - Loss: 1.0328, Acc: 74.53%
学习率: 0.010000, 时间: 2.73s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0201 | Acc: 100.00% | Time: 0.0187s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0248, Acc: 99.82%
测试 - Loss: 1.0278, Acc: 74.49%
学习率: 0.010000, 时间: 2.94s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0183 | Acc: 99.22% | Time: 0.0126s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0223, Acc: 99.85%
测试 - Loss: 1.0311, Acc: 74.64%
学习率: 0.010000, 时间: 2.85s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.57% -> 74.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0139 | Acc: 100.00% | Time: 0.0189s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0220, Acc: 99.85%
测试 - Loss: 1.0279, Acc: 74.53%
学习率: 0.010000, 时间: 2.85s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0119 | Acc: 100.00% | Time: 0.0158s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0215, Acc: 99.85%
测试 - Loss: 1.0302, Acc: 74.61%
学习率: 0.010000, 时间: 2.82s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0277 | Acc: 100.00% | Time: 0.0131s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0211, Acc: 99.89%
测试 - Loss: 1.0298, Acc: 74.63%
学习率: 0.010000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0207 | Acc: 100.00% | Time: 0.0221s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0203, Acc: 99.89%
测试 - Loss: 1.0237, Acc: 74.41%
学习率: 0.010000, 时间: 2.79s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0226 | Acc: 100.00% | Time: 0.0129s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0197, Acc: 99.87%
测试 - Loss: 1.0218, Acc: 74.62%
学习率: 0.010000, 时间: 2.74s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0217 | Acc: 99.22% | Time: 0.0225s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0198, Acc: 99.89%
测试 - Loss: 1.0198, Acc: 74.62%
学习率: 0.010000, 时间: 2.95s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0201 | Acc: 100.00% | Time: 0.0203s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0198, Acc: 99.90%
测试 - Loss: 1.0197, Acc: 74.62%
学习率: 0.010000, 时间: 2.90s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0166 | Acc: 100.00% | Time: 0.0180s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0190, Acc: 99.90%
测试 - Loss: 1.0165, Acc: 74.81%
学习率: 0.010000, 时间: 2.73s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.64% -> 74.81%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0113 | Acc: 100.00% | Time: 0.0176s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0182, Acc: 99.90%
测试 - Loss: 1.0171, Acc: 74.71%
学习率: 0.010000, 时间: 2.67s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0194 | Acc: 100.00% | Time: 0.0159s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0180, Acc: 99.95%
测试 - Loss: 1.0155, Acc: 74.66%
学习率: 0.010000, 时间: 2.65s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0245 | Acc: 100.00% | Time: 0.0120s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0187, Acc: 99.91%
测试 - Loss: 1.0148, Acc: 74.64%
学习率: 0.010000, 时间: 2.63s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0154 | Acc: 100.00% | Time: 0.0163s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0174, Acc: 99.93%
测试 - Loss: 1.0127, Acc: 74.67%
学习率: 0.010000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0141 | Acc: 100.00% | Time: 0.0226s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0176, Acc: 99.92%
测试 - Loss: 1.0129, Acc: 74.65%
学习率: 0.010000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0191 | Acc: 100.00% | Time: 0.0177s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0172, Acc: 99.94%
测试 - Loss: 1.0094, Acc: 74.82%
学习率: 0.010000, 时间: 2.83s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.81% -> 74.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0205 | Acc: 100.00% | Time: 0.0127s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0177, Acc: 99.93%
测试 - Loss: 1.0096, Acc: 74.90%
学习率: 0.010000, 时间: 2.85s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.82% -> 74.90%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0138 | Acc: 100.00% | Time: 0.0208s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0170, Acc: 99.90%
测试 - Loss: 1.0073, Acc: 74.89%
学习率: 0.010000, 时间: 2.76s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0227 | Acc: 100.00% | Time: 0.0213s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0175, Acc: 99.91%
测试 - Loss: 1.0054, Acc: 74.97%
学习率: 0.010000, 时间: 2.66s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.90% -> 74.97%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0140 | Acc: 100.00% | Time: 0.0183s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0174, Acc: 99.95%
测试 - Loss: 1.0037, Acc: 74.95%
学习率: 0.010000, 时间: 2.69s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0174 | Acc: 100.00% | Time: 0.0227s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0161, Acc: 99.94%
测试 - Loss: 1.0041, Acc: 75.11%
学习率: 0.010000, 时间: 2.87s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 74.97% -> 75.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0190 | Acc: 100.00% | Time: 0.0215s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0170, Acc: 99.94%
测试 - Loss: 1.0078, Acc: 74.95%
学习率: 0.010000, 时间: 2.81s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0126 | Acc: 100.00% | Time: 0.0197s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0163, Acc: 99.96%
测试 - Loss: 1.0039, Acc: 74.92%
学习率: 0.010000, 时间: 2.96s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0142 | Acc: 100.00% | Time: 0.0122s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0162, Acc: 99.90%
测试 - Loss: 1.0012, Acc: 74.91%
学习率: 0.010000, 时间: 2.86s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0127 | Acc: 100.00% | Time: 0.0172s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0169, Acc: 99.92%
测试 - Loss: 0.9996, Acc: 75.02%
学习率: 0.010000, 时间: 2.76s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0160 | Acc: 100.00% | Time: 0.0129s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0164, Acc: 99.91%
测试 - Loss: 1.0017, Acc: 74.95%
学习率: 0.010000, 时间: 2.85s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0217 | Acc: 99.22% | Time: 0.0144s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0165, Acc: 99.93%
测试 - Loss: 0.9962, Acc: 75.08%
学习率: 0.010000, 时间: 2.72s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0177 | Acc: 100.00% | Time: 0.0142s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0166, Acc: 99.93%
测试 - Loss: 0.9990, Acc: 75.10%
学习率: 0.010000, 时间: 2.74s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0139 | Acc: 100.00% | Time: 0.0228s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0168, Acc: 99.96%
测试 - Loss: 0.9994, Acc: 74.98%
学习率: 0.010000, 时间: 2.71s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0167 | Acc: 100.00% | Time: 0.0179s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0158, Acc: 99.94%
测试 - Loss: 0.9967, Acc: 75.08%
学习率: 0.010000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0155 | Acc: 100.00% | Time: 0.0201s | GPU Mem: 0.15GB/1.10GB

训练 - Loss: 0.0151, Acc: 99.97%
测试 - Loss: 0.9977, Acc: 75.24%
学习率: 0.001000, 时间: 2.75s
GPU内存使用:
  GPU 1 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 2 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 3 - 已分配: 0.15GB, 已保留: 1.10GB
  GPU 5 - 已分配: 0.15GB, 已保留: 1.10GB
最佳准确率更新: 75.11% -> 75.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 358.66秒 (5.98分钟)
平均每epoch: 3.59秒
最佳测试准确率: 75.24%
保存最终模型到: ./experiments/group_2_model_complexity_impact_across_training_modes/checkpoints/ddp_resnet18_bs128_gpu4_nw2_chunks0.pth

训练完成!
