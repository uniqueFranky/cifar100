====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw0_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 0,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 0 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw0_chunks0.pth
Start Time: 2025-12-10T07:25:36.147810
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 0
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw0_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.7033 | Acc: 0.00% | Time: 0.6374s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.0882, Acc: 1.51%
测试 - Loss: 4.7852, Acc: 3.02%
学习率: 0.100000, 时间: 13.01s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 3.02%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.5295 | Acc: 3.91% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.3149, Acc: 4.49%
测试 - Loss: 4.1421, Acc: 5.76%
学习率: 0.100000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 3.02% -> 5.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.0790 | Acc: 8.59% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.0175, Acc: 7.42%
测试 - Loss: 3.9259, Acc: 8.30%
学习率: 0.100000, 时间: 12.55s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 5.76% -> 8.30%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.8239 | Acc: 7.81% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.8432, Acc: 9.78%
测试 - Loss: 3.7471, Acc: 11.56%
学习率: 0.100000, 时间: 12.50s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 8.30% -> 11.56%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.6126 | Acc: 12.50% | Time: 0.0278s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.6244, Acc: 13.27%
测试 - Loss: 3.5141, Acc: 15.44%
学习率: 0.100000, 时间: 12.36s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 11.56% -> 15.44%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.6491 | Acc: 9.38% | Time: 0.0287s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.4590, Acc: 16.10%
测试 - Loss: 3.3667, Acc: 18.29%
学习率: 0.100000, 时间: 12.50s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 15.44% -> 18.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.2443 | Acc: 21.88% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.2992, Acc: 19.10%
测试 - Loss: 3.2141, Acc: 21.44%
学习率: 0.100000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 18.29% -> 21.44%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.1733 | Acc: 21.09% | Time: 0.0284s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.1428, Acc: 22.30%
测试 - Loss: 3.1803, Acc: 22.42%
学习率: 0.100000, 时间: 12.70s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 21.44% -> 22.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 3.0467 | Acc: 19.53% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.9633, Acc: 25.66%
测试 - Loss: 3.0356, Acc: 25.39%
学习率: 0.100000, 时间: 12.75s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 22.42% -> 25.39%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.8161 | Acc: 31.25% | Time: 0.0247s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.8628, Acc: 27.81%
测试 - Loss: 2.8705, Acc: 28.02%
学习率: 0.100000, 时间: 12.26s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 25.39% -> 28.02%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.7820 | Acc: 22.66% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.7259, Acc: 30.84%
测试 - Loss: 2.6910, Acc: 31.76%
学习率: 0.100000, 时间: 12.64s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 28.02% -> 31.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.5876 | Acc: 35.94% | Time: 0.0308s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.5570, Acc: 33.78%
测试 - Loss: 2.5943, Acc: 33.96%
学习率: 0.100000, 时间: 12.47s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 31.76% -> 33.96%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.4892 | Acc: 30.47% | Time: 0.0287s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.4168, Acc: 37.18%
测试 - Loss: 2.5340, Acc: 35.19%
学习率: 0.100000, 时间: 12.47s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 33.96% -> 35.19%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 2.2409 | Acc: 39.06% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2846, Acc: 39.39%
测试 - Loss: 2.3839, Acc: 38.29%
学习率: 0.100000, 时间: 12.64s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 35.19% -> 38.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.7660 | Acc: 49.22% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.1861, Acc: 41.97%
测试 - Loss: 2.3940, Acc: 37.92%
学习率: 0.100000, 时间: 12.55s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.7922 | Acc: 53.91% | Time: 0.0343s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0695, Acc: 44.16%
测试 - Loss: 2.1700, Acc: 43.07%
学习率: 0.100000, 时间: 12.49s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 38.29% -> 43.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.9090 | Acc: 50.00% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9417, Acc: 47.37%
测试 - Loss: 2.1657, Acc: 43.50%
学习率: 0.100000, 时间: 12.47s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 43.07% -> 43.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.7073 | Acc: 51.56% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8217, Acc: 49.73%
测试 - Loss: 1.9884, Acc: 47.50%
学习率: 0.100000, 时间: 12.52s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 43.50% -> 47.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.7774 | Acc: 52.34% | Time: 0.0268s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7096, Acc: 52.37%
测试 - Loss: 1.9276, Acc: 48.60%
学习率: 0.100000, 时间: 12.42s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 47.50% -> 48.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.6987 | Acc: 53.12% | Time: 0.0304s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6487, Acc: 53.61%
测试 - Loss: 1.9148, Acc: 48.36%
学习率: 0.100000, 时间: 12.71s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.7333 | Acc: 50.00% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5422, Acc: 56.58%
测试 - Loss: 1.8346, Acc: 50.66%
学习率: 0.100000, 时间: 12.53s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 48.60% -> 50.66%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.4951 | Acc: 56.25% | Time: 0.0275s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5012, Acc: 57.12%
测试 - Loss: 1.7361, Acc: 53.37%
学习率: 0.100000, 时间: 12.60s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.66% -> 53.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.2601 | Acc: 63.28% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4197, Acc: 59.71%
测试 - Loss: 1.7523, Acc: 53.01%
学习率: 0.100000, 时间: 12.50s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.2951 | Acc: 56.25% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3217, Acc: 61.94%
测试 - Loss: 1.9256, Acc: 50.48%
学习率: 0.100000, 时间: 12.63s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 1.1157 | Acc: 64.84% | Time: 0.0308s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2974, Acc: 61.89%
测试 - Loss: 1.7530, Acc: 54.96%
学习率: 0.100000, 时间: 12.61s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 53.37% -> 54.96%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 1.1183 | Acc: 71.09% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2310, Acc: 64.16%
测试 - Loss: 1.9001, Acc: 54.91%
学习率: 0.100000, 时间: 12.42s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 1.1570 | Acc: 64.84% | Time: 0.0382s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1727, Acc: 65.62%
测试 - Loss: 1.6903, Acc: 54.90%
学习率: 0.100000, 时间: 12.56s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 1.0973 | Acc: 68.75% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1403, Acc: 65.86%
测试 - Loss: 1.6854, Acc: 54.76%
学习率: 0.100000, 时间: 12.53s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 1.0063 | Acc: 68.75% | Time: 0.0289s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0872, Acc: 67.89%
测试 - Loss: 1.6394, Acc: 56.84%
学习率: 0.100000, 时间: 12.60s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 54.96% -> 56.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.9837 | Acc: 71.88% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0361, Acc: 69.64%
测试 - Loss: 1.6895, Acc: 56.22%
学习率: 0.100000, 时间: 12.51s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.7608 | Acc: 74.22% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0048, Acc: 70.56%
测试 - Loss: 1.5457, Acc: 59.12%
学习率: 0.100000, 时间: 12.47s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 56.84% -> 59.12%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.7329 | Acc: 81.25% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9610, Acc: 71.59%
测试 - Loss: 1.6603, Acc: 56.65%
学习率: 0.100000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8871 | Acc: 74.22% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9425, Acc: 71.39%
测试 - Loss: 1.5558, Acc: 58.79%
学习率: 0.100000, 时间: 12.51s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.8953 | Acc: 75.78% | Time: 0.0289s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8863, Acc: 73.32%
测试 - Loss: 1.5454, Acc: 58.92%
学习率: 0.100000, 时间: 12.77s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.9232 | Acc: 71.09% | Time: 0.0267s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8727, Acc: 73.70%
测试 - Loss: 1.6749, Acc: 57.38%
学习率: 0.100000, 时间: 12.60s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.7415 | Acc: 73.44% | Time: 0.0287s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8358, Acc: 74.86%
测试 - Loss: 1.7142, Acc: 57.35%
学习率: 0.100000, 时间: 12.53s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.6940 | Acc: 77.34% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8319, Acc: 74.89%
测试 - Loss: 1.5829, Acc: 59.24%
学习率: 0.100000, 时间: 12.54s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.12% -> 59.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.6549 | Acc: 79.69% | Time: 0.0268s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8008, Acc: 75.79%
测试 - Loss: 1.6152, Acc: 58.72%
学习率: 0.100000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.6521 | Acc: 79.69% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7853, Acc: 76.06%
测试 - Loss: 1.5826, Acc: 59.84%
学习率: 0.100000, 时间: 12.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.24% -> 59.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.6106 | Acc: 80.47% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7294, Acc: 77.41%
测试 - Loss: 1.6136, Acc: 59.69%
学习率: 0.100000, 时间: 12.44s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.7116 | Acc: 76.56% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7364, Acc: 77.63%
测试 - Loss: 1.5296, Acc: 60.50%
学习率: 0.100000, 时间: 12.35s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.84% -> 60.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6305 | Acc: 78.91% | Time: 0.0289s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7137, Acc: 78.04%
测试 - Loss: 1.6002, Acc: 59.94%
学习率: 0.100000, 时间: 12.33s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.5343 | Acc: 83.59% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6803, Acc: 79.01%
测试 - Loss: 1.7156, Acc: 57.49%
学习率: 0.100000, 时间: 12.49s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.6177 | Acc: 77.34% | Time: 0.0253s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6837, Acc: 78.76%
测试 - Loss: 1.7929, Acc: 56.92%
学习率: 0.100000, 时间: 12.58s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.5407 | Acc: 82.81% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6692, Acc: 79.19%
测试 - Loss: 1.5863, Acc: 61.00%
学习率: 0.100000, 时间: 12.51s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.50% -> 61.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.7471 | Acc: 80.47% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6446, Acc: 80.38%
测试 - Loss: 1.7370, Acc: 57.88%
学习率: 0.100000, 时间: 12.42s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.5789 | Acc: 82.03% | Time: 0.0285s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6315, Acc: 80.63%
测试 - Loss: 1.5749, Acc: 60.20%
学习率: 0.100000, 时间: 12.39s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.5207 | Acc: 82.81% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6344, Acc: 80.05%
测试 - Loss: 1.5697, Acc: 60.84%
学习率: 0.100000, 时间: 12.24s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4903 | Acc: 82.03% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5957, Acc: 81.54%
测试 - Loss: 1.8748, Acc: 56.32%
学习率: 0.100000, 时间: 12.59s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.4417 | Acc: 85.94% | Time: 0.0288s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5909, Acc: 81.67%
测试 - Loss: 1.5821, Acc: 60.04%
学习率: 0.010000, 时间: 12.41s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.5292 | Acc: 80.47% | Time: 0.0350s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.3286, Acc: 90.51%
测试 - Loss: 1.0928, Acc: 71.03%
学习率: 0.010000, 时间: 12.59s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.00% -> 71.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1762 | Acc: 97.66% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2094, Acc: 94.25%
测试 - Loss: 1.0815, Acc: 71.24%
学习率: 0.010000, 时间: 12.66s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 71.03% -> 71.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.1782 | Acc: 95.31% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1744, Acc: 95.64%
测试 - Loss: 1.0836, Acc: 71.82%
学习率: 0.010000, 时间: 12.39s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 71.24% -> 71.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1401 | Acc: 98.44% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1525, Acc: 96.37%
测试 - Loss: 1.0910, Acc: 71.67%
学习率: 0.010000, 时间: 12.41s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.1507 | Acc: 97.66% | Time: 0.0294s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1358, Acc: 96.88%
测试 - Loss: 1.0938, Acc: 72.05%
学习率: 0.010000, 时间: 12.08s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 71.82% -> 72.05%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.0880 | Acc: 97.66% | Time: 0.0318s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1229, Acc: 97.25%
测试 - Loss: 1.1011, Acc: 72.09%
学习率: 0.010000, 时间: 12.38s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.05% -> 72.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.1075 | Acc: 99.22% | Time: 0.0278s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1121, Acc: 97.59%
测试 - Loss: 1.0961, Acc: 71.95%
学习率: 0.010000, 时间: 12.19s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0753 | Acc: 98.44% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1036, Acc: 97.82%
测试 - Loss: 1.1088, Acc: 71.94%
学习率: 0.010000, 时间: 12.38s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0891 | Acc: 97.66% | Time: 0.0265s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0932, Acc: 98.22%
测试 - Loss: 1.1110, Acc: 71.90%
学习率: 0.010000, 时间: 12.45s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0805 | Acc: 99.22% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0915, Acc: 98.17%
测试 - Loss: 1.1210, Acc: 71.95%
学习率: 0.010000, 时间: 12.59s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0550 | Acc: 100.00% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0833, Acc: 98.33%
测试 - Loss: 1.1193, Acc: 71.98%
学习率: 0.010000, 时间: 12.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0813 | Acc: 97.66% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0794, Acc: 98.55%
测试 - Loss: 1.1241, Acc: 71.96%
学习率: 0.010000, 时间: 12.76s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0720 | Acc: 99.22% | Time: 0.0270s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0748, Acc: 98.63%
测试 - Loss: 1.1245, Acc: 71.99%
学习率: 0.010000, 时间: 12.64s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0624 | Acc: 98.44% | Time: 0.0281s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0702, Acc: 98.74%
测试 - Loss: 1.1268, Acc: 72.21%
学习率: 0.010000, 时间: 12.58s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.09% -> 72.21%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0345 | Acc: 100.00% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0651, Acc: 98.95%
测试 - Loss: 1.1329, Acc: 72.26%
学习率: 0.010000, 时间: 12.53s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.21% -> 72.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0618 | Acc: 99.22% | Time: 0.0335s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0617, Acc: 98.91%
测试 - Loss: 1.1287, Acc: 72.37%
学习率: 0.010000, 时间: 12.51s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.26% -> 72.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0671 | Acc: 99.22% | Time: 0.0265s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0608, Acc: 98.98%
测试 - Loss: 1.1360, Acc: 72.00%
学习率: 0.010000, 时间: 12.49s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0500 | Acc: 100.00% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0540, Acc: 99.16%
测试 - Loss: 1.1433, Acc: 72.27%
学习率: 0.010000, 时间: 12.52s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0683 | Acc: 98.44% | Time: 0.0280s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0521, Acc: 99.22%
测试 - Loss: 1.1504, Acc: 72.31%
学习率: 0.010000, 时间: 12.35s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0538 | Acc: 99.22% | Time: 0.0265s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0525, Acc: 99.14%
测试 - Loss: 1.1490, Acc: 72.17%
学习率: 0.010000, 时间: 12.49s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0200 | Acc: 100.00% | Time: 0.0285s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0446, Acc: 99.43%
测试 - Loss: 1.1564, Acc: 72.35%
学习率: 0.010000, 时间: 12.58s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0351 | Acc: 100.00% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0464, Acc: 99.36%
测试 - Loss: 1.1620, Acc: 71.99%
学习率: 0.010000, 时间: 12.41s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0249 | Acc: 100.00% | Time: 0.0265s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0440, Acc: 99.46%
测试 - Loss: 1.1544, Acc: 72.47%
学习率: 0.010000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.37% -> 72.47%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0443 | Acc: 100.00% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0418, Acc: 99.50%
测试 - Loss: 1.1635, Acc: 72.31%
学习率: 0.010000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0413 | Acc: 100.00% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0403, Acc: 99.49%
测试 - Loss: 1.1730, Acc: 72.13%
学习率: 0.010000, 时间: 12.52s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0272 | Acc: 100.00% | Time: 0.0268s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0377, Acc: 99.56%
测试 - Loss: 1.1640, Acc: 72.20%
学习率: 0.010000, 时间: 12.77s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0326 | Acc: 100.00% | Time: 0.0286s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0375, Acc: 99.55%
测试 - Loss: 1.1585, Acc: 72.42%
学习率: 0.010000, 时间: 12.26s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0366 | Acc: 99.22% | Time: 0.0296s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0345, Acc: 99.59%
测试 - Loss: 1.1713, Acc: 72.32%
学习率: 0.010000, 时间: 12.53s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0410 | Acc: 99.22% | Time: 0.0280s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0351, Acc: 99.62%
测试 - Loss: 1.1672, Acc: 72.18%
学习率: 0.010000, 时间: 12.39s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0268 | Acc: 100.00% | Time: 0.0273s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0321, Acc: 99.61%
测试 - Loss: 1.1680, Acc: 72.09%
学习率: 0.010000, 时间: 12.25s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0452 | Acc: 99.22% | Time: 0.0286s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0314, Acc: 99.69%
测试 - Loss: 1.1698, Acc: 72.47%
学习率: 0.010000, 时间: 12.67s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0224 | Acc: 100.00% | Time: 0.0270s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0320, Acc: 99.64%
测试 - Loss: 1.1752, Acc: 72.39%
学习率: 0.010000, 时间: 12.39s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0538 | Acc: 98.44% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0294, Acc: 99.74%
测试 - Loss: 1.1746, Acc: 72.50%
学习率: 0.010000, 时间: 12.55s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.47% -> 72.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0350 | Acc: 99.22% | Time: 0.0299s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0293, Acc: 99.70%
测试 - Loss: 1.1750, Acc: 72.33%
学习率: 0.010000, 时间: 12.27s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0347 | Acc: 100.00% | Time: 0.0296s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0285, Acc: 99.76%
测试 - Loss: 1.1735, Acc: 72.48%
学习率: 0.010000, 时间: 12.60s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0290 | Acc: 100.00% | Time: 0.0350s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0275, Acc: 99.74%
测试 - Loss: 1.1788, Acc: 72.80%
学习率: 0.010000, 时间: 12.62s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.50% -> 72.80%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0160 | Acc: 100.00% | Time: 0.0263s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0272, Acc: 99.75%
测试 - Loss: 1.1763, Acc: 72.52%
学习率: 0.010000, 时间: 12.38s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0204 | Acc: 100.00% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0267, Acc: 99.78%
测试 - Loss: 1.1786, Acc: 72.47%
学习率: 0.010000, 时间: 12.43s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0132 | Acc: 100.00% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0252, Acc: 99.76%
测试 - Loss: 1.1759, Acc: 72.33%
学习率: 0.010000, 时间: 12.49s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0252 | Acc: 99.22% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0233, Acc: 99.82%
测试 - Loss: 1.1743, Acc: 72.51%
学习率: 0.010000, 时间: 12.60s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0254 | Acc: 100.00% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0241, Acc: 99.87%
测试 - Loss: 1.1723, Acc: 72.36%
学习率: 0.010000, 时间: 12.52s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0242 | Acc: 99.22% | Time: 0.0261s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0239, Acc: 99.77%
测试 - Loss: 1.1688, Acc: 72.72%
学习率: 0.010000, 时间: 12.50s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0120 | Acc: 100.00% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0246, Acc: 99.76%
测试 - Loss: 1.1796, Acc: 72.24%
学习率: 0.010000, 时间: 12.56s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0196 | Acc: 100.00% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0227, Acc: 99.78%
测试 - Loss: 1.1775, Acc: 72.67%
学习率: 0.010000, 时间: 12.42s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0237 | Acc: 100.00% | Time: 0.0275s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0223, Acc: 99.80%
测试 - Loss: 1.1792, Acc: 72.61%
学习率: 0.010000, 时间: 12.55s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0292 | Acc: 100.00% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0239, Acc: 99.79%
测试 - Loss: 1.1751, Acc: 72.78%
学习率: 0.010000, 时间: 12.48s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0290 | Acc: 100.00% | Time: 0.0278s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0218, Acc: 99.84%
测试 - Loss: 1.1840, Acc: 72.44%
学习率: 0.010000, 时间: 12.37s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0358 | Acc: 99.22% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0207, Acc: 99.88%
测试 - Loss: 1.1750, Acc: 72.71%
学习率: 0.010000, 时间: 12.39s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0171 | Acc: 100.00% | Time: 0.0295s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0214, Acc: 99.78%
测试 - Loss: 1.1766, Acc: 72.79%
学习率: 0.010000, 时间: 12.25s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0164 | Acc: 100.00% | Time: 0.0455s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0202, Acc: 99.89%
测试 - Loss: 1.1756, Acc: 72.74%
学习率: 0.001000, 时间: 12.45s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 1439.69秒 (23.99分钟)
平均每epoch: 14.40秒
最佳测试准确率: 72.80%
保存最终模型到: ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw0_chunks0.pth

训练完成!
