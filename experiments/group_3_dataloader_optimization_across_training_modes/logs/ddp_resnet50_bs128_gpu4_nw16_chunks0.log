====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw16_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 16,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 16 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw16_chunks0.pth
Start Time: 2025-12-10T08:41:22.684865
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 16
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw16_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.8146 | Acc: 0.00% | Time: 2.5596s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.9720, Acc: 1.24%
测试 - Loss: 4.4580, Acc: 2.69%
学习率: 0.100000, 时间: 76.59s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 2.69%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.4918 | Acc: 2.34% | Time: 0.0340s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.1769, Acc: 5.14%
测试 - Loss: 3.9587, Acc: 8.29%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 2.69% -> 8.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 3.8799 | Acc: 10.94% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.8329, Acc: 10.05%
测试 - Loss: 3.7151, Acc: 11.65%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 8.29% -> 11.65%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.4571 | Acc: 10.16% | Time: 0.0298s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.5806, Acc: 14.25%
测试 - Loss: 3.4212, Acc: 17.02%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 11.65% -> 17.02%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.3756 | Acc: 15.62% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.3177, Acc: 19.30%
测试 - Loss: 3.1751, Acc: 21.92%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 17.02% -> 21.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.1849 | Acc: 18.75% | Time: 0.0374s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.0834, Acc: 23.99%
测试 - Loss: 2.9818, Acc: 25.39%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 21.92% -> 25.39%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 2.8087 | Acc: 25.78% | Time: 0.0429s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.8530, Acc: 27.67%
测试 - Loss: 2.7662, Acc: 29.93%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 25.39% -> 29.93%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 2.7230 | Acc: 28.12% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.6337, Acc: 31.89%
测试 - Loss: 2.7481, Acc: 31.39%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 29.93% -> 31.39%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 2.5210 | Acc: 28.91% | Time: 0.0285s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.3821, Acc: 37.23%
测试 - Loss: 2.8589, Acc: 30.50%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.3352 | Acc: 41.41% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2016, Acc: 40.87%
测试 - Loss: 2.2519, Acc: 41.12%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 31.39% -> 41.12%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.3122 | Acc: 39.84% | Time: 0.0287s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0403, Acc: 44.46%
测试 - Loss: 2.1011, Acc: 43.47%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 41.12% -> 43.47%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 1.9068 | Acc: 48.44% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8712, Acc: 48.50%
测试 - Loss: 2.1040, Acc: 44.30%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 43.47% -> 44.30%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 1.8929 | Acc: 48.44% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7412, Acc: 51.89%
测试 - Loss: 2.0488, Acc: 45.77%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 44.30% -> 45.77%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 1.5868 | Acc: 59.38% | Time: 0.0337s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6343, Acc: 53.81%
测试 - Loss: 1.7713, Acc: 52.06%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 45.77% -> 52.06%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.2535 | Acc: 64.84% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5314, Acc: 56.52%
测试 - Loss: 1.8103, Acc: 50.53%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.3361 | Acc: 62.50% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4766, Acc: 57.53%
测试 - Loss: 1.7896, Acc: 52.18%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.06% -> 52.18%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.3405 | Acc: 60.94% | Time: 0.0403s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3879, Acc: 59.75%
测试 - Loss: 1.7291, Acc: 52.76%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.18% -> 52.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.1896 | Acc: 63.28% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3090, Acc: 61.98%
测试 - Loss: 1.5808, Acc: 56.64%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.76% -> 56.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.4916 | Acc: 61.72% | Time: 0.0319s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2413, Acc: 63.91%
测试 - Loss: 1.6590, Acc: 55.37%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.0718 | Acc: 66.41% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1981, Acc: 65.04%
测试 - Loss: 1.6399, Acc: 54.98%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.2451 | Acc: 63.28% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1548, Acc: 66.29%
测试 - Loss: 1.5123, Acc: 58.00%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 56.64% -> 58.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.1318 | Acc: 66.41% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1146, Acc: 66.95%
测试 - Loss: 1.4992, Acc: 59.44%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.00% -> 59.44%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.0252 | Acc: 68.75% | Time: 0.0351s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0554, Acc: 69.03%
测试 - Loss: 1.4932, Acc: 59.36%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.0037 | Acc: 65.62% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0066, Acc: 70.24%
测试 - Loss: 1.7216, Acc: 55.60%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.7624 | Acc: 78.91% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9908, Acc: 70.36%
测试 - Loss: 1.6017, Acc: 57.97%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 0.9358 | Acc: 71.09% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9267, Acc: 71.51%
测试 - Loss: 1.5050, Acc: 59.88%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.44% -> 59.88%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 0.8327 | Acc: 74.22% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8803, Acc: 73.41%
测试 - Loss: 1.5776, Acc: 58.15%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 0.8195 | Acc: 76.56% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8671, Acc: 73.15%
测试 - Loss: 1.4841, Acc: 60.66%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.88% -> 60.66%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.7847 | Acc: 78.12% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8513, Acc: 74.31%
测试 - Loss: 1.7080, Acc: 57.31%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.6889 | Acc: 81.25% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7985, Acc: 75.86%
测试 - Loss: 1.4156, Acc: 62.04%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.66% -> 62.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.5729 | Acc: 86.72% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7619, Acc: 76.84%
测试 - Loss: 1.4771, Acc: 62.54%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.04% -> 62.54%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.5071 | Acc: 85.16% | Time: 0.0289s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7566, Acc: 76.89%
测试 - Loss: 1.5665, Acc: 60.03%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.6997 | Acc: 81.25% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7418, Acc: 77.29%
测试 - Loss: 1.4564, Acc: 62.05%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.6953 | Acc: 75.78% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7137, Acc: 77.80%
测试 - Loss: 1.5602, Acc: 60.57%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.5880 | Acc: 83.59% | Time: 0.0339s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6960, Acc: 78.53%
测试 - Loss: 1.4803, Acc: 61.24%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.5627 | Acc: 82.03% | Time: 0.0320s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6705, Acc: 79.02%
测试 - Loss: 1.5279, Acc: 61.00%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.6016 | Acc: 85.16% | Time: 0.0350s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6689, Acc: 79.71%
测试 - Loss: 1.4901, Acc: 62.22%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.5990 | Acc: 81.25% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6557, Acc: 80.10%
测试 - Loss: 1.7208, Acc: 58.81%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.5511 | Acc: 80.47% | Time: 0.0376s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6424, Acc: 80.12%
测试 - Loss: 1.6830, Acc: 59.20%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.4605 | Acc: 85.94% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6088, Acc: 80.86%
测试 - Loss: 1.5748, Acc: 60.85%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.4525 | Acc: 86.72% | Time: 0.0371s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5992, Acc: 81.10%
测试 - Loss: 1.4504, Acc: 63.09%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.54% -> 63.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6054 | Acc: 83.59% | Time: 0.0278s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6160, Acc: 80.54%
测试 - Loss: 1.4961, Acc: 62.45%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.5359 | Acc: 84.38% | Time: 0.0343s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5635, Acc: 82.62%
测试 - Loss: 1.6391, Acc: 60.20%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.5227 | Acc: 82.03% | Time: 0.0418s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5877, Acc: 81.79%
测试 - Loss: 1.4720, Acc: 63.60%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 63.09% -> 63.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.5595 | Acc: 83.59% | Time: 0.0351s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5592, Acc: 82.46%
测试 - Loss: 1.4608, Acc: 63.30%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.6135 | Acc: 79.69% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5657, Acc: 82.30%
测试 - Loss: 1.5640, Acc: 62.02%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.4370 | Acc: 86.72% | Time: 0.0320s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5300, Acc: 83.38%
测试 - Loss: 1.5168, Acc: 62.74%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.3989 | Acc: 89.84% | Time: 0.0389s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5331, Acc: 83.26%
测试 - Loss: 1.6918, Acc: 59.64%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4823 | Acc: 85.16% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5237, Acc: 83.30%
测试 - Loss: 1.7511, Acc: 58.22%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.3898 | Acc: 86.72% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5243, Acc: 83.63%
测试 - Loss: 1.5082, Acc: 62.97%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.4200 | Acc: 87.50% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2693, Acc: 92.18%
测试 - Loss: 1.0182, Acc: 73.07%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 63.60% -> 73.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1307 | Acc: 97.66% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1645, Acc: 95.67%
测试 - Loss: 0.9973, Acc: 74.05%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.07% -> 74.05%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.1492 | Acc: 95.31% | Time: 0.0346s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1320, Acc: 96.97%
测试 - Loss: 1.0006, Acc: 74.09%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.05% -> 74.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1140 | Acc: 96.88% | Time: 0.0354s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1154, Acc: 97.31%
测试 - Loss: 1.0129, Acc: 73.72%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.0958 | Acc: 97.66% | Time: 0.0329s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1014, Acc: 97.71%
测试 - Loss: 1.0156, Acc: 73.83%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.0648 | Acc: 99.22% | Time: 0.0260s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0922, Acc: 98.03%
测试 - Loss: 1.0201, Acc: 74.17%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.09% -> 74.17%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0793 | Acc: 98.44% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0821, Acc: 98.35%
测试 - Loss: 1.0226, Acc: 74.05%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0664 | Acc: 99.22% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0741, Acc: 98.73%
测试 - Loss: 1.0289, Acc: 74.15%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0472 | Acc: 100.00% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0727, Acc: 98.57%
测试 - Loss: 1.0286, Acc: 74.46%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.17% -> 74.46%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0512 | Acc: 100.00% | Time: 0.0338s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0655, Acc: 98.74%
测试 - Loss: 1.0394, Acc: 74.24%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0320 | Acc: 100.00% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0608, Acc: 98.96%
测试 - Loss: 1.0422, Acc: 74.32%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0488 | Acc: 100.00% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0573, Acc: 98.97%
测试 - Loss: 1.0457, Acc: 74.35%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0357 | Acc: 100.00% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0543, Acc: 99.07%
测试 - Loss: 1.0489, Acc: 74.29%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0513 | Acc: 97.66% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0493, Acc: 99.21%
测试 - Loss: 1.0520, Acc: 74.52%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.46% -> 74.52%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0259 | Acc: 100.00% | Time: 0.0524s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0485, Acc: 99.14%
测试 - Loss: 1.0539, Acc: 74.70%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.52% -> 74.70%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0636 | Acc: 96.88% | Time: 0.0354s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0441, Acc: 99.26%
测试 - Loss: 1.0543, Acc: 74.30%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0675 | Acc: 97.66% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0431, Acc: 99.31%
测试 - Loss: 1.0588, Acc: 74.58%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0337 | Acc: 100.00% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0411, Acc: 99.44%
测试 - Loss: 1.0643, Acc: 74.59%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0333 | Acc: 99.22% | Time: 0.0369s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0402, Acc: 99.38%
测试 - Loss: 1.0748, Acc: 74.59%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0385 | Acc: 99.22% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0383, Acc: 99.46%
测试 - Loss: 1.0719, Acc: 74.68%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0271 | Acc: 100.00% | Time: 0.0308s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0343, Acc: 99.59%
测试 - Loss: 1.0734, Acc: 74.83%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.70% -> 74.83%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0249 | Acc: 100.00% | Time: 0.0343s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0358, Acc: 99.53%
测试 - Loss: 1.0776, Acc: 74.71%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0202 | Acc: 100.00% | Time: 0.0408s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0353, Acc: 99.45%
测试 - Loss: 1.0836, Acc: 74.66%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0339 | Acc: 100.00% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0316, Acc: 99.70%
测试 - Loss: 1.0744, Acc: 74.68%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0369 | Acc: 99.22% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0317, Acc: 99.50%
测试 - Loss: 1.0766, Acc: 75.14%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.83% -> 75.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0198 | Acc: 100.00% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0286, Acc: 99.69%
测试 - Loss: 1.0724, Acc: 74.98%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0393 | Acc: 100.00% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0277, Acc: 99.74%
测试 - Loss: 1.0775, Acc: 74.92%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0248 | Acc: 100.00% | Time: 0.0402s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0268, Acc: 99.69%
测试 - Loss: 1.0838, Acc: 75.07%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0181 | Acc: 100.00% | Time: 0.0347s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0251, Acc: 99.74%
测试 - Loss: 1.0826, Acc: 74.81%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0210 | Acc: 100.00% | Time: 0.0353s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0241, Acc: 99.82%
测试 - Loss: 1.0776, Acc: 74.97%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0471 | Acc: 98.44% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0257, Acc: 99.68%
测试 - Loss: 1.0820, Acc: 74.91%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0132 | Acc: 100.00% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0240, Acc: 99.78%
测试 - Loss: 1.0857, Acc: 75.06%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0159 | Acc: 100.00% | Time: 0.0408s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0236, Acc: 99.77%
测试 - Loss: 1.0859, Acc: 74.80%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0246 | Acc: 100.00% | Time: 0.0335s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0239, Acc: 99.73%
测试 - Loss: 1.0782, Acc: 75.10%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0210 | Acc: 100.00% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0214, Acc: 99.84%
测试 - Loss: 1.0789, Acc: 74.97%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0271 | Acc: 100.00% | Time: 0.0308s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0214, Acc: 99.81%
测试 - Loss: 1.0852, Acc: 75.25%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.14% -> 75.25%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0124 | Acc: 100.00% | Time: 0.0365s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0197, Acc: 99.88%
测试 - Loss: 1.0865, Acc: 74.71%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0213 | Acc: 100.00% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.82%
测试 - Loss: 1.0841, Acc: 75.00%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0210 | Acc: 100.00% | Time: 0.0369s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0204, Acc: 99.80%
测试 - Loss: 1.0866, Acc: 74.90%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0169 | Acc: 100.00% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0181, Acc: 99.86%
测试 - Loss: 1.0839, Acc: 74.94%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0091 | Acc: 100.00% | Time: 0.0471s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0198, Acc: 99.82%
测试 - Loss: 1.0907, Acc: 74.84%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0180 | Acc: 100.00% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0189, Acc: 99.86%
测试 - Loss: 1.0857, Acc: 75.02%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0243 | Acc: 100.00% | Time: 0.0390s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0177, Acc: 99.86%
测试 - Loss: 1.0878, Acc: 74.81%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0143 | Acc: 100.00% | Time: 0.0395s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0178, Acc: 99.86%
测试 - Loss: 1.0875, Acc: 74.99%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0158 | Acc: 100.00% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0188, Acc: 99.79%
测试 - Loss: 1.0794, Acc: 75.16%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0203 | Acc: 99.22% | Time: 0.0322s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0178, Acc: 99.82%
测试 - Loss: 1.0820, Acc: 75.19%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0162 | Acc: 100.00% | Time: 0.0373s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0177, Acc: 99.89%
测试 - Loss: 1.0886, Acc: 75.06%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0301 | Acc: 100.00% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0179, Acc: 99.86%
测试 - Loss: 1.0745, Acc: 75.50%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.25% -> 75.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0214 | Acc: 100.00% | Time: 0.0355s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0178, Acc: 99.84%
测试 - Loss: 1.0843, Acc: 75.04%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0104 | Acc: 100.00% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0162, Acc: 99.91%
测试 - Loss: 1.0809, Acc: 75.02%
学习率: 0.001000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 833.49秒 (13.89分钟)
平均每epoch: 8.33秒
最佳测试准确率: 75.50%
保存最终模型到: ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw16_chunks0.pth

训练完成!
