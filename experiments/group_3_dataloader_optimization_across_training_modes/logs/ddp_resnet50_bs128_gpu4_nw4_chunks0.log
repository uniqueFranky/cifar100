====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw4_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 4,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 4 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw4_chunks0.pth
Start Time: 2025-12-10T08:14:56.311298
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 4
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw4_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.7990 | Acc: 0.78% | Time: 1.4590s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.1085, Acc: 1.15%
测试 - Loss: 4.6048, Acc: 1.11%
学习率: 0.100000, 时间: 23.80s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 1.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.6311 | Acc: 0.78% | Time: 0.0418s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.5843, Acc: 1.77%
测试 - Loss: 4.5186, Acc: 1.96%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 1.11% -> 1.96%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.5036 | Acc: 1.56% | Time: 0.0502s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.3655, Acc: 3.38%
测试 - Loss: 4.1532, Acc: 4.95%
学习率: 0.100000, 时间: 5.98s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 1.96% -> 4.95%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.9813 | Acc: 4.69% | Time: 0.0384s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.0586, Acc: 6.18%
测试 - Loss: 3.9001, Acc: 8.26%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 4.95% -> 8.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.8952 | Acc: 8.59% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.8329, Acc: 9.43%
测试 - Loss: 3.6959, Acc: 11.89%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 8.26% -> 11.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.8515 | Acc: 6.25% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.6465, Acc: 12.74%
测试 - Loss: 3.5419, Acc: 14.06%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 11.89% -> 14.06%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.5286 | Acc: 12.50% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.4671, Acc: 15.62%
测试 - Loss: 3.3421, Acc: 18.80%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 14.06% -> 18.80%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.3914 | Acc: 19.53% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.2308, Acc: 19.80%
测试 - Loss: 3.1183, Acc: 21.99%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 18.80% -> 21.99%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 3.0485 | Acc: 14.84% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.9590, Acc: 24.49%
测试 - Loss: 2.8686, Acc: 26.22%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 21.99% -> 26.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.7692 | Acc: 28.12% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.7302, Acc: 29.61%
测试 - Loss: 2.8736, Acc: 27.86%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 26.22% -> 27.86%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.7484 | Acc: 26.56% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.4974, Acc: 33.97%
测试 - Loss: 2.6329, Acc: 32.10%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 27.86% -> 32.10%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.4752 | Acc: 39.06% | Time: 0.0327s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2747, Acc: 39.54%
测试 - Loss: 2.3632, Acc: 37.84%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 32.10% -> 37.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.1190 | Acc: 46.09% | Time: 0.0368s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.1045, Acc: 42.45%
测试 - Loss: 2.2334, Acc: 40.10%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 37.84% -> 40.10%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 2.0656 | Acc: 44.53% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9706, Acc: 45.23%
测试 - Loss: 2.2505, Acc: 40.93%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 40.10% -> 40.93%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.6025 | Acc: 50.78% | Time: 0.0395s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8644, Acc: 48.01%
测试 - Loss: 1.9996, Acc: 45.69%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 40.93% -> 45.69%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.6274 | Acc: 56.25% | Time: 0.0320s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7560, Acc: 50.61%
测试 - Loss: 1.8820, Acc: 48.76%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 45.69% -> 48.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.7060 | Acc: 51.56% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6730, Acc: 53.05%
测试 - Loss: 1.8003, Acc: 50.38%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 48.76% -> 50.38%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.4152 | Acc: 62.50% | Time: 0.0277s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5898, Acc: 55.02%
测试 - Loss: 1.7424, Acc: 52.03%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.38% -> 52.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.6213 | Acc: 56.25% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4895, Acc: 57.41%
测试 - Loss: 1.9180, Acc: 49.16%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.4033 | Acc: 62.50% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4366, Acc: 58.74%
测试 - Loss: 1.8915, Acc: 49.32%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.5523 | Acc: 57.03% | Time: 0.0368s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3751, Acc: 60.27%
测试 - Loss: 1.8330, Acc: 50.99%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.3050 | Acc: 62.50% | Time: 0.0343s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3446, Acc: 61.18%
测试 - Loss: 1.6630, Acc: 54.78%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.03% -> 54.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.2304 | Acc: 60.16% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2671, Acc: 63.30%
测试 - Loss: 1.6521, Acc: 54.78%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.2160 | Acc: 60.16% | Time: 0.0296s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1868, Acc: 64.62%
测试 - Loss: 1.7149, Acc: 54.76%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.9822 | Acc: 70.31% | Time: 0.0449s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1778, Acc: 65.21%
测试 - Loss: 1.5921, Acc: 57.22%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 54.78% -> 57.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 1.0355 | Acc: 65.62% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1083, Acc: 66.69%
测试 - Loss: 1.5270, Acc: 57.82%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 57.22% -> 57.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 1.0120 | Acc: 64.84% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0496, Acc: 68.70%
测试 - Loss: 1.4778, Acc: 59.14%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 57.82% -> 59.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 1.0626 | Acc: 66.41% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0246, Acc: 69.38%
测试 - Loss: 1.5513, Acc: 57.96%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 1.0216 | Acc: 69.53% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0060, Acc: 70.24%
测试 - Loss: 1.5133, Acc: 59.86%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.14% -> 59.86%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.8255 | Acc: 72.66% | Time: 0.0409s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9495, Acc: 71.31%
测试 - Loss: 1.6952, Acc: 56.30%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.7755 | Acc: 78.12% | Time: 0.0399s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9093, Acc: 72.66%
测试 - Loss: 1.4838, Acc: 60.23%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.86% -> 60.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.7274 | Acc: 82.03% | Time: 0.0388s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8852, Acc: 73.14%
测试 - Loss: 1.5461, Acc: 59.10%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8162 | Acc: 72.66% | Time: 0.0370s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8892, Acc: 73.02%
测试 - Loss: 1.5230, Acc: 59.24%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.8639 | Acc: 71.88% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8271, Acc: 74.93%
测试 - Loss: 1.5144, Acc: 60.12%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.7978 | Acc: 78.12% | Time: 0.0383s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8256, Acc: 75.16%
测试 - Loss: 1.5913, Acc: 58.09%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.7042 | Acc: 77.34% | Time: 0.0346s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7973, Acc: 75.46%
测试 - Loss: 1.4695, Acc: 61.70%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.23% -> 61.70%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.6188 | Acc: 84.38% | Time: 0.0329s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7815, Acc: 75.89%
测试 - Loss: 1.5242, Acc: 60.74%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.7102 | Acc: 71.09% | Time: 0.0375s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7817, Acc: 76.10%
测试 - Loss: 1.6089, Acc: 58.85%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.6010 | Acc: 82.03% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7301, Acc: 77.70%
测试 - Loss: 1.5575, Acc: 60.53%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.6112 | Acc: 81.25% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6965, Acc: 78.51%
测试 - Loss: 1.5478, Acc: 60.98%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.5743 | Acc: 82.81% | Time: 0.0389s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6988, Acc: 78.50%
测试 - Loss: 1.5690, Acc: 59.46%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6320 | Acc: 82.03% | Time: 0.0314s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6852, Acc: 78.68%
测试 - Loss: 1.4768, Acc: 61.42%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.5366 | Acc: 81.25% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6498, Acc: 79.92%
测试 - Loss: 1.5787, Acc: 59.92%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.7624 | Acc: 78.12% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6684, Acc: 78.89%
测试 - Loss: 1.5449, Acc: 59.87%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.4609 | Acc: 84.38% | Time: 0.0256s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6506, Acc: 79.35%
测试 - Loss: 1.5074, Acc: 61.31%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.6636 | Acc: 78.91% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6329, Acc: 80.83%
测试 - Loss: 1.4509, Acc: 62.56%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.70% -> 62.56%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.8680 | Acc: 71.88% | Time: 0.0273s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6035, Acc: 81.10%
测试 - Loss: 1.4568, Acc: 62.53%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.4922 | Acc: 82.81% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6059, Acc: 81.07%
测试 - Loss: 1.5077, Acc: 62.42%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.5962 | Acc: 81.25% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6009, Acc: 81.03%
测试 - Loss: 1.6127, Acc: 60.02%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.3565 | Acc: 90.62% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5769, Acc: 82.19%
测试 - Loss: 1.5586, Acc: 60.86%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.6083 | Acc: 79.69% | Time: 0.0265s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.3196, Acc: 90.48%
测试 - Loss: 0.9647, Acc: 73.42%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.56% -> 73.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1792 | Acc: 96.88% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2117, Acc: 94.33%
测试 - Loss: 0.9503, Acc: 74.07%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.42% -> 74.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.1791 | Acc: 94.53% | Time: 0.0369s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1771, Acc: 95.46%
测试 - Loss: 0.9553, Acc: 74.41%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.07% -> 74.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1510 | Acc: 95.31% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1541, Acc: 96.10%
测试 - Loss: 0.9614, Acc: 74.23%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.0994 | Acc: 99.22% | Time: 0.0367s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1386, Acc: 96.67%
测试 - Loss: 0.9624, Acc: 74.29%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.1139 | Acc: 98.44% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1254, Acc: 97.12%
测试 - Loss: 0.9747, Acc: 74.11%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0985 | Acc: 99.22% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1161, Acc: 97.34%
测试 - Loss: 0.9730, Acc: 74.20%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0890 | Acc: 98.44% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1050, Acc: 97.65%
测试 - Loss: 0.9774, Acc: 74.80%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.41% -> 74.80%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0730 | Acc: 99.22% | Time: 0.0353s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0944, Acc: 98.01%
测试 - Loss: 0.9859, Acc: 74.42%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0709 | Acc: 97.66% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0955, Acc: 97.94%
测试 - Loss: 0.9977, Acc: 74.64%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0699 | Acc: 98.44% | Time: 0.0269s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0878, Acc: 98.20%
测试 - Loss: 0.9865, Acc: 74.57%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0612 | Acc: 98.44% | Time: 0.0361s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0830, Acc: 98.22%
测试 - Loss: 0.9999, Acc: 74.69%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0422 | Acc: 99.22% | Time: 0.0338s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0764, Acc: 98.47%
测试 - Loss: 0.9992, Acc: 74.55%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0448 | Acc: 100.00% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0705, Acc: 98.77%
测试 - Loss: 1.0152, Acc: 74.43%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0450 | Acc: 100.00% | Time: 0.0420s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0642, Acc: 98.76%
测试 - Loss: 1.0096, Acc: 74.84%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.80% -> 74.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0664 | Acc: 99.22% | Time: 0.0359s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0600, Acc: 98.87%
测试 - Loss: 1.0192, Acc: 74.58%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0599 | Acc: 99.22% | Time: 0.0318s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0574, Acc: 98.98%
测试 - Loss: 1.0249, Acc: 74.83%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0370 | Acc: 100.00% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0541, Acc: 99.17%
测试 - Loss: 1.0285, Acc: 74.56%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0460 | Acc: 98.44% | Time: 0.0359s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0515, Acc: 99.18%
测试 - Loss: 1.0254, Acc: 74.73%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0485 | Acc: 99.22% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0492, Acc: 99.29%
测试 - Loss: 1.0284, Acc: 74.87%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.84% -> 74.87%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0200 | Acc: 100.00% | Time: 0.0376s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0460, Acc: 99.30%
测试 - Loss: 1.0389, Acc: 74.69%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0274 | Acc: 100.00% | Time: 0.0284s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0443, Acc: 99.29%
测试 - Loss: 1.0422, Acc: 74.73%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0215 | Acc: 99.22% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0430, Acc: 99.42%
测试 - Loss: 1.0441, Acc: 74.78%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0428 | Acc: 100.00% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0404, Acc: 99.50%
测试 - Loss: 1.0494, Acc: 74.96%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.87% -> 74.96%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0158 | Acc: 100.00% | Time: 0.0337s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0398, Acc: 99.42%
测试 - Loss: 1.0431, Acc: 74.89%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0291 | Acc: 100.00% | Time: 0.0272s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0361, Acc: 99.54%
测试 - Loss: 1.0417, Acc: 74.67%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0245 | Acc: 100.00% | Time: 0.0362s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0359, Acc: 99.54%
测试 - Loss: 1.0475, Acc: 74.97%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.96% -> 74.97%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0292 | Acc: 99.22% | Time: 0.0371s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0327, Acc: 99.61%
测试 - Loss: 1.0499, Acc: 74.98%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.97% -> 74.98%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0239 | Acc: 100.00% | Time: 0.0449s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0338, Acc: 99.62%
测试 - Loss: 1.0500, Acc: 74.90%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0213 | Acc: 100.00% | Time: 0.0375s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0327, Acc: 99.55%
测试 - Loss: 1.0540, Acc: 74.92%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0281 | Acc: 99.22% | Time: 0.0413s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0304, Acc: 99.58%
测试 - Loss: 1.0585, Acc: 75.07%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.98% -> 75.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0166 | Acc: 100.00% | Time: 0.0462s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0295, Acc: 99.66%
测试 - Loss: 1.0569, Acc: 75.14%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.07% -> 75.14%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0194 | Acc: 99.22% | Time: 0.0263s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0272, Acc: 99.72%
测试 - Loss: 1.0601, Acc: 75.22%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.14% -> 75.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0289 | Acc: 100.00% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0284, Acc: 99.69%
测试 - Loss: 1.0526, Acc: 75.01%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0155 | Acc: 100.00% | Time: 0.0294s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0265, Acc: 99.75%
测试 - Loss: 1.0561, Acc: 75.08%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0249 | Acc: 100.00% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0276, Acc: 99.73%
测试 - Loss: 1.0644, Acc: 74.92%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0088 | Acc: 100.00% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0264, Acc: 99.66%
测试 - Loss: 1.0597, Acc: 74.96%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0144 | Acc: 100.00% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0242, Acc: 99.82%
测试 - Loss: 1.0670, Acc: 74.97%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0149 | Acc: 100.00% | Time: 0.0299s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0237, Acc: 99.77%
测试 - Loss: 1.0610, Acc: 75.24%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.22% -> 75.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0259 | Acc: 100.00% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0222, Acc: 99.83%
测试 - Loss: 1.0674, Acc: 74.93%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0121 | Acc: 100.00% | Time: 0.0263s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0226, Acc: 99.77%
测试 - Loss: 1.0700, Acc: 74.76%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0154 | Acc: 100.00% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0225, Acc: 99.77%
测试 - Loss: 1.0617, Acc: 75.20%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0208 | Acc: 100.00% | Time: 0.0280s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0213, Acc: 99.77%
测试 - Loss: 1.0646, Acc: 74.92%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0114 | Acc: 100.00% | Time: 0.0409s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0210, Acc: 99.82%
测试 - Loss: 1.0651, Acc: 75.28%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.24% -> 75.28%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0102 | Acc: 100.00% | Time: 0.0301s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0214, Acc: 99.80%
测试 - Loss: 1.0585, Acc: 75.30%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 75.28% -> 75.30%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0408 | Acc: 99.22% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0218, Acc: 99.81%
测试 - Loss: 1.0661, Acc: 75.10%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0177 | Acc: 100.00% | Time: 0.0369s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0199, Acc: 99.86%
测试 - Loss: 1.0697, Acc: 74.89%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0226 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0195, Acc: 99.86%
测试 - Loss: 1.0626, Acc: 75.05%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0191 | Acc: 100.00% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0193, Acc: 99.82%
测试 - Loss: 1.0643, Acc: 74.96%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0174 | Acc: 99.22% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0178, Acc: 99.87%
测试 - Loss: 1.0648, Acc: 75.15%
学习率: 0.001000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 756.38秒 (12.61分钟)
平均每epoch: 7.56秒
最佳测试准确率: 75.30%
保存最终模型到: ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw4_chunks0.pth

训练完成!
