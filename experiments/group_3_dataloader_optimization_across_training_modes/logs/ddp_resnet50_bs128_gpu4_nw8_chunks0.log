====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw8_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 8,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 8 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw8_chunks0.pth
Start Time: 2025-12-10T08:27:54.811007
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 8
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw8_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.8847 | Acc: 1.56% | Time: 0.8489s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.0766, Acc: 1.37%
测试 - Loss: 4.5591, Acc: 1.72%
学习率: 0.100000, 时间: 40.79s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 1.72%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.5457 | Acc: 1.56% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.5052, Acc: 2.49%
测试 - Loss: 4.3790, Acc: 3.29%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 1.72% -> 3.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.3329 | Acc: 3.12% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.2305, Acc: 5.09%
测试 - Loss: 4.0480, Acc: 6.09%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 3.29% -> 6.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.8936 | Acc: 5.47% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.9757, Acc: 7.29%
测试 - Loss: 3.8778, Acc: 8.64%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 6.09% -> 8.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.7907 | Acc: 10.94% | Time: 0.0525s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.7869, Acc: 10.55%
测试 - Loss: 3.6596, Acc: 12.47%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 8.64% -> 12.47%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.6899 | Acc: 10.94% | Time: 0.0423s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.6061, Acc: 13.16%
测试 - Loss: 3.4614, Acc: 15.97%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 12.47% -> 15.97%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.3855 | Acc: 18.75% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.4283, Acc: 16.12%
测试 - Loss: 3.3106, Acc: 18.79%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 15.97% -> 18.79%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.2106 | Acc: 19.53% | Time: 0.0404s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.2268, Acc: 20.71%
测试 - Loss: 3.1723, Acc: 21.94%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 18.79% -> 21.94%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 3.0961 | Acc: 13.28% | Time: 0.0362s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.9923, Acc: 24.88%
测试 - Loss: 3.0256, Acc: 24.67%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 21.94% -> 24.67%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.8943 | Acc: 28.91% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.8383, Acc: 28.35%
测试 - Loss: 2.8505, Acc: 28.24%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 24.67% -> 28.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.7800 | Acc: 23.44% | Time: 0.0373s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.6246, Acc: 32.28%
测试 - Loss: 2.6724, Acc: 31.97%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 28.24% -> 31.97%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.4565 | Acc: 35.94% | Time: 0.0425s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.4051, Acc: 36.94%
测试 - Loss: 2.5322, Acc: 35.13%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 31.97% -> 35.13%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.3720 | Acc: 36.72% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2342, Acc: 39.97%
测试 - Loss: 2.3354, Acc: 38.50%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 35.13% -> 38.50%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 1.9613 | Acc: 43.75% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0763, Acc: 43.40%
测试 - Loss: 2.2702, Acc: 41.09%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 38.50% -> 41.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.6128 | Acc: 57.81% | Time: 0.0351s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9655, Acc: 46.09%
测试 - Loss: 2.0913, Acc: 44.23%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 41.09% -> 44.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.6060 | Acc: 53.91% | Time: 0.0449s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8643, Acc: 48.02%
测试 - Loss: 2.2133, Acc: 42.65%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.7477 | Acc: 51.56% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7722, Acc: 51.18%
测试 - Loss: 1.9785, Acc: 46.89%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 44.23% -> 46.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.5883 | Acc: 57.81% | Time: 0.0384s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6670, Acc: 53.62%
测试 - Loss: 1.8502, Acc: 49.92%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 46.89% -> 49.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.6562 | Acc: 54.69% | Time: 0.0436s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5700, Acc: 55.50%
测试 - Loss: 1.8610, Acc: 50.60%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 49.92% -> 50.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.3781 | Acc: 57.03% | Time: 0.0336s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4924, Acc: 57.70%
测试 - Loss: 1.7635, Acc: 52.24%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.60% -> 52.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.6300 | Acc: 55.47% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4288, Acc: 59.23%
测试 - Loss: 1.6788, Acc: 53.71%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.24% -> 53.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.3397 | Acc: 60.94% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3785, Acc: 60.26%
测试 - Loss: 1.6138, Acc: 55.60%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 53.71% -> 55.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.1875 | Acc: 60.94% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3012, Acc: 62.21%
测试 - Loss: 1.6468, Acc: 54.97%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.2110 | Acc: 66.41% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1977, Acc: 65.10%
测试 - Loss: 1.8578, Acc: 51.91%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 1.0130 | Acc: 71.88% | Time: 0.0390s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2001, Acc: 64.45%
测试 - Loss: 1.5613, Acc: 58.00%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 55.60% -> 58.00%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 0.9589 | Acc: 71.09% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1108, Acc: 67.30%
测试 - Loss: 1.5992, Acc: 56.76%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 1.0260 | Acc: 64.84% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0632, Acc: 68.33%
测试 - Loss: 1.5012, Acc: 58.74%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.00% -> 58.74%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 0.9989 | Acc: 70.31% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0183, Acc: 69.59%
测试 - Loss: 1.4797, Acc: 59.60%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.74% -> 59.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.9000 | Acc: 72.66% | Time: 0.0368s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9993, Acc: 70.38%
测试 - Loss: 1.4541, Acc: 60.32%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.60% -> 60.32%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.8637 | Acc: 71.09% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9529, Acc: 71.58%
测试 - Loss: 1.5460, Acc: 58.38%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.6345 | Acc: 82.81% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9152, Acc: 72.33%
测试 - Loss: 1.4957, Acc: 60.17%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.7238 | Acc: 80.47% | Time: 0.0329s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8685, Acc: 73.59%
测试 - Loss: 1.4058, Acc: 61.08%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.32% -> 61.08%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8223 | Acc: 74.22% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8756, Acc: 72.99%
测试 - Loss: 1.5906, Acc: 58.07%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.8209 | Acc: 69.53% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8142, Acc: 74.94%
测试 - Loss: 1.7185, Acc: 56.29%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.7608 | Acc: 77.34% | Time: 0.0404s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8107, Acc: 75.61%
测试 - Loss: 1.5380, Acc: 59.20%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.6699 | Acc: 78.12% | Time: 0.0329s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7725, Acc: 76.78%
测试 - Loss: 1.5155, Acc: 59.54%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.6578 | Acc: 80.47% | Time: 0.0318s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7690, Acc: 76.13%
测试 - Loss: 1.5687, Acc: 60.07%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.7562 | Acc: 78.12% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7465, Acc: 77.17%
测试 - Loss: 1.7497, Acc: 57.65%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.7699 | Acc: 78.12% | Time: 0.0270s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7137, Acc: 78.12%
测试 - Loss: 1.6037, Acc: 60.10%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.5973 | Acc: 81.25% | Time: 0.0383s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6954, Acc: 78.25%
测试 - Loss: 1.5809, Acc: 60.18%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.6427 | Acc: 79.69% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6806, Acc: 79.10%
测试 - Loss: 1.4963, Acc: 61.37%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.08% -> 61.37%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6870 | Acc: 80.47% | Time: 0.0369s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6999, Acc: 78.28%
测试 - Loss: 1.5770, Acc: 60.06%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.6513 | Acc: 79.69% | Time: 0.0380s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6508, Acc: 80.02%
测试 - Loss: 1.5029, Acc: 62.04%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.37% -> 62.04%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.5427 | Acc: 82.81% | Time: 0.0442s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6374, Acc: 80.00%
测试 - Loss: 1.7907, Acc: 56.96%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.5664 | Acc: 82.81% | Time: 0.0385s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6308, Acc: 80.37%
测试 - Loss: 1.5266, Acc: 61.72%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.6811 | Acc: 79.69% | Time: 0.0278s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5947, Acc: 81.62%
测试 - Loss: 1.5985, Acc: 61.04%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.5907 | Acc: 79.69% | Time: 0.0365s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5887, Acc: 81.30%
测试 - Loss: 1.5102, Acc: 61.72%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.4387 | Acc: 83.59% | Time: 0.0359s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5845, Acc: 81.88%
测试 - Loss: 1.6287, Acc: 60.31%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.3874 | Acc: 86.72% | Time: 0.0415s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5818, Acc: 81.38%
测试 - Loss: 1.5962, Acc: 60.47%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.4107 | Acc: 89.84% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5658, Acc: 82.17%
测试 - Loss: 1.4889, Acc: 62.54%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.04% -> 62.54%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.5324 | Acc: 85.94% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.3145, Acc: 90.70%
测试 - Loss: 1.0211, Acc: 71.91%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 62.54% -> 71.91%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.2527 | Acc: 90.62% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2070, Acc: 94.35%
测试 - Loss: 1.0089, Acc: 72.87%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 71.91% -> 72.87%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.2072 | Acc: 92.19% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1663, Acc: 95.72%
测试 - Loss: 1.0144, Acc: 72.91%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.87% -> 72.91%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1470 | Acc: 95.31% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1413, Acc: 96.56%
测试 - Loss: 1.0217, Acc: 72.90%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.1143 | Acc: 98.44% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1257, Acc: 97.04%
测试 - Loss: 1.0258, Acc: 73.11%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.91% -> 73.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.1198 | Acc: 96.09% | Time: 0.0360s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1160, Acc: 97.34%
测试 - Loss: 1.0344, Acc: 73.22%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.11% -> 73.22%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0940 | Acc: 97.66% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1027, Acc: 97.94%
测试 - Loss: 1.0364, Acc: 73.48%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.22% -> 73.48%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0850 | Acc: 96.88% | Time: 0.0288s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0920, Acc: 98.04%
测试 - Loss: 1.0449, Acc: 73.41%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.0793 | Acc: 97.66% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0883, Acc: 98.10%
测试 - Loss: 1.0514, Acc: 73.40%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0471 | Acc: 99.22% | Time: 0.0378s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0797, Acc: 98.42%
测试 - Loss: 1.0578, Acc: 73.45%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0681 | Acc: 99.22% | Time: 0.0339s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0785, Acc: 98.46%
测试 - Loss: 1.0626, Acc: 73.60%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.48% -> 73.60%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0383 | Acc: 100.00% | Time: 0.0321s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0707, Acc: 98.62%
测试 - Loss: 1.0663, Acc: 73.49%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0549 | Acc: 99.22% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0669, Acc: 98.81%
测试 - Loss: 1.0635, Acc: 73.71%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.60% -> 73.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0287 | Acc: 100.00% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0642, Acc: 98.82%
测试 - Loss: 1.0736, Acc: 73.76%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.71% -> 73.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0484 | Acc: 99.22% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0580, Acc: 99.04%
测试 - Loss: 1.0818, Acc: 73.54%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0649 | Acc: 98.44% | Time: 0.0390s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0548, Acc: 99.10%
测试 - Loss: 1.0869, Acc: 73.58%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0517 | Acc: 98.44% | Time: 0.0338s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0521, Acc: 99.13%
测试 - Loss: 1.0980, Acc: 73.35%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0580 | Acc: 97.66% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0475, Acc: 99.31%
测试 - Loss: 1.0897, Acc: 73.64%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0239 | Acc: 100.00% | Time: 0.0367s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0454, Acc: 99.36%
测试 - Loss: 1.0930, Acc: 73.72%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0522 | Acc: 99.22% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0443, Acc: 99.45%
测试 - Loss: 1.1047, Acc: 73.68%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0278 | Acc: 100.00% | Time: 0.0462s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0421, Acc: 99.35%
测试 - Loss: 1.1029, Acc: 73.69%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0204 | Acc: 100.00% | Time: 0.0251s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0405, Acc: 99.53%
测试 - Loss: 1.1125, Acc: 73.78%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.76% -> 73.78%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0214 | Acc: 100.00% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0383, Acc: 99.45%
测试 - Loss: 1.1093, Acc: 73.84%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.78% -> 73.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0355 | Acc: 99.22% | Time: 0.0329s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0372, Acc: 99.45%
测试 - Loss: 1.1154, Acc: 73.63%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0312 | Acc: 100.00% | Time: 0.0299s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0337, Acc: 99.57%
测试 - Loss: 1.1152, Acc: 73.74%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0246 | Acc: 100.00% | Time: 0.0411s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0312, Acc: 99.64%
测试 - Loss: 1.1196, Acc: 73.85%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.84% -> 73.85%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0339 | Acc: 99.22% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0324, Acc: 99.65%
测试 - Loss: 1.1205, Acc: 73.83%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0299 | Acc: 100.00% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0301, Acc: 99.66%
测试 - Loss: 1.1227, Acc: 73.49%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0249 | Acc: 100.00% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0301, Acc: 99.65%
测试 - Loss: 1.1245, Acc: 73.85%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0212 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0291, Acc: 99.64%
测试 - Loss: 1.1235, Acc: 73.93%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.85% -> 73.93%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0219 | Acc: 100.00% | Time: 0.0344s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0269, Acc: 99.74%
测试 - Loss: 1.1258, Acc: 73.99%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.93% -> 73.99%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0168 | Acc: 100.00% | Time: 0.0393s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0272, Acc: 99.66%
测试 - Loss: 1.1245, Acc: 73.88%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0289 | Acc: 100.00% | Time: 0.0392s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0258, Acc: 99.77%
测试 - Loss: 1.1269, Acc: 73.57%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0263 | Acc: 99.22% | Time: 0.0371s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0242, Acc: 99.78%
测试 - Loss: 1.1253, Acc: 74.08%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.99% -> 74.08%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0200 | Acc: 100.00% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0240, Acc: 99.72%
测试 - Loss: 1.1277, Acc: 73.78%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0431 | Acc: 99.22% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0247, Acc: 99.75%
测试 - Loss: 1.1349, Acc: 73.78%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0131 | Acc: 100.00% | Time: 0.0354s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0231, Acc: 99.80%
测试 - Loss: 1.1311, Acc: 73.79%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0154 | Acc: 100.00% | Time: 0.0383s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0230, Acc: 99.85%
测试 - Loss: 1.1281, Acc: 73.63%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0148 | Acc: 100.00% | Time: 0.0303s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0223, Acc: 99.80%
测试 - Loss: 1.1452, Acc: 73.61%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0148 | Acc: 100.00% | Time: 0.0416s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0203, Acc: 99.83%
测试 - Loss: 1.1323, Acc: 74.01%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0113 | Acc: 100.00% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0196, Acc: 99.88%
测试 - Loss: 1.1363, Acc: 73.93%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0335 | Acc: 99.22% | Time: 0.0355s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0208, Acc: 99.80%
测试 - Loss: 1.1304, Acc: 73.99%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0261 | Acc: 99.22% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0209, Acc: 99.81%
测试 - Loss: 1.1348, Acc: 73.95%
学习率: 0.010000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0144 | Acc: 100.00% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0202, Acc: 99.85%
测试 - Loss: 1.1362, Acc: 73.53%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0300 | Acc: 100.00% | Time: 0.0340s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0199, Acc: 99.82%
测试 - Loss: 1.1334, Acc: 74.00%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0330 | Acc: 99.22% | Time: 0.0365s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.78%
测试 - Loss: 1.1317, Acc: 73.85%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0347 | Acc: 99.22% | Time: 0.0371s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0189, Acc: 99.86%
测试 - Loss: 1.1386, Acc: 74.10%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 74.08% -> 74.10%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0190 | Acc: 100.00% | Time: 0.0333s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0187, Acc: 99.82%
测试 - Loss: 1.1293, Acc: 73.87%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0216 | Acc: 100.00% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0181, Acc: 99.86%
测试 - Loss: 1.1373, Acc: 74.04%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0160 | Acc: 99.22% | Time: 0.0359s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0182, Acc: 99.85%
测试 - Loss: 1.1282, Acc: 73.96%
学习率: 0.001000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 786.31秒 (13.11分钟)
平均每epoch: 7.86秒
最佳测试准确率: 74.10%
保存最终模型到: ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw8_chunks0.pth

训练完成!
