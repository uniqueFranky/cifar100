====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw1_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 1,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 1 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw1_chunks0.pth
Start Time: 2025-12-10T07:49:55.807295
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 1
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw1_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.7337 | Acc: 1.56% | Time: 0.7949s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.1096, Acc: 1.34%
测试 - Loss: 4.5997, Acc: 1.75%
学习率: 0.100000, 时间: 11.08s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 1.75%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.5532 | Acc: 3.12% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.4136, Acc: 2.90%
测试 - Loss: 4.2280, Acc: 4.28%
学习率: 0.100000, 时间: 5.98s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 1.75% -> 4.28%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.2063 | Acc: 4.69% | Time: 0.0374s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.1208, Acc: 5.62%
测试 - Loss: 3.9552, Acc: 7.56%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 4.28% -> 7.56%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.7910 | Acc: 8.59% | Time: 0.0319s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.9010, Acc: 8.42%
测试 - Loss: 3.8595, Acc: 9.68%
学习率: 0.100000, 时间: 6.18s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 7.56% -> 9.68%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.6425 | Acc: 9.38% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.6982, Acc: 11.62%
测试 - Loss: 3.5802, Acc: 13.20%
学习率: 0.100000, 时间: 5.96s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 9.68% -> 13.20%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.7760 | Acc: 7.03% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.5294, Acc: 15.14%
测试 - Loss: 3.3819, Acc: 17.41%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 13.20% -> 17.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.3940 | Acc: 14.84% | Time: 0.0402s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.3272, Acc: 18.70%
测试 - Loss: 3.1582, Acc: 22.68%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 17.41% -> 22.68%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 3.1962 | Acc: 20.31% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.0910, Acc: 22.74%
测试 - Loss: 3.1636, Acc: 22.55%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 2.9341 | Acc: 22.66% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.8678, Acc: 27.15%
测试 - Loss: 3.1841, Acc: 24.59%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 22.68% -> 24.59%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.7308 | Acc: 25.78% | Time: 0.0349s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.7292, Acc: 30.32%
测试 - Loss: 2.8358, Acc: 29.30%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 24.59% -> 29.30%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.6961 | Acc: 25.78% | Time: 0.0390s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.5468, Acc: 33.45%
测试 - Loss: 2.5320, Acc: 34.85%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 29.30% -> 34.85%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.3899 | Acc: 37.50% | Time: 0.0370s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.3619, Acc: 37.81%
测试 - Loss: 2.4735, Acc: 36.07%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 34.85% -> 36.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.2621 | Acc: 42.19% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2146, Acc: 40.38%
测试 - Loss: 2.2782, Acc: 39.83%
学习率: 0.100000, 时间: 5.95s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 36.07% -> 39.83%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 1.9581 | Acc: 41.41% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0591, Acc: 43.72%
测试 - Loss: 2.4128, Acc: 38.94%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.6199 | Acc: 53.12% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9641, Acc: 46.65%
测试 - Loss: 2.2905, Acc: 40.90%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 39.83% -> 40.90%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.6868 | Acc: 49.22% | Time: 0.0350s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8634, Acc: 48.74%
测试 - Loss: 2.0800, Acc: 45.11%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 40.90% -> 45.11%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.8059 | Acc: 47.66% | Time: 0.0395s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7837, Acc: 50.46%
测试 - Loss: 2.0924, Acc: 45.51%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 45.11% -> 45.51%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.6269 | Acc: 57.03% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6786, Acc: 53.37%
测试 - Loss: 1.9089, Acc: 49.61%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 45.51% -> 49.61%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.6654 | Acc: 53.91% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5929, Acc: 55.09%
测试 - Loss: 2.3360, Acc: 42.63%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.3444 | Acc: 63.28% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5284, Acc: 56.78%
测试 - Loss: 1.8045, Acc: 50.95%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 49.61% -> 50.95%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.5694 | Acc: 53.91% | Time: 0.0500s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4609, Acc: 58.07%
测试 - Loss: 1.8087, Acc: 51.32%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 50.95% -> 51.32%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.4403 | Acc: 57.03% | Time: 0.0354s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4153, Acc: 59.45%
测试 - Loss: 1.8143, Acc: 51.84%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 51.32% -> 51.84%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.1800 | Acc: 60.16% | Time: 0.0382s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3396, Acc: 61.00%
测试 - Loss: 1.8935, Acc: 50.24%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.1435 | Acc: 66.41% | Time: 0.0256s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2430, Acc: 63.56%
测试 - Loss: 1.7940, Acc: 53.05%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 51.84% -> 53.05%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.9407 | Acc: 72.66% | Time: 0.0347s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2389, Acc: 63.92%
测试 - Loss: 1.8012, Acc: 52.74%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 1.1331 | Acc: 65.62% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1703, Acc: 65.44%
测试 - Loss: 1.8668, Acc: 51.72%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 1.0995 | Acc: 63.28% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0959, Acc: 67.93%
测试 - Loss: 1.6526, Acc: 56.03%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 53.05% -> 56.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 1.2030 | Acc: 64.06% | Time: 0.0382s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0706, Acc: 68.45%
测试 - Loss: 1.6090, Acc: 57.29%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 56.03% -> 57.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 1.0435 | Acc: 68.75% | Time: 0.0348s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0643, Acc: 68.79%
测试 - Loss: 1.6386, Acc: 56.57%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.8891 | Acc: 73.44% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0023, Acc: 70.25%
测试 - Loss: 1.5904, Acc: 57.90%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 57.29% -> 57.90%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.7719 | Acc: 74.22% | Time: 0.0433s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9800, Acc: 70.20%
测试 - Loss: 1.4818, Acc: 59.68%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 57.90% -> 59.68%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.7789 | Acc: 80.47% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9365, Acc: 72.02%
测试 - Loss: 1.6335, Acc: 57.53%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8472 | Acc: 71.88% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9038, Acc: 72.96%
测试 - Loss: 1.5762, Acc: 58.05%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.8338 | Acc: 76.56% | Time: 0.0291s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8494, Acc: 73.80%
测试 - Loss: 1.4758, Acc: 60.88%
学习率: 0.100000, 时间: 5.98s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.68% -> 60.88%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.7914 | Acc: 75.78% | Time: 0.0400s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8525, Acc: 74.14%
测试 - Loss: 1.5209, Acc: 60.01%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.6240 | Acc: 82.03% | Time: 0.0385s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8088, Acc: 75.34%
测试 - Loss: 1.6402, Acc: 58.74%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.7231 | Acc: 75.78% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8001, Acc: 75.69%
测试 - Loss: 1.6668, Acc: 57.91%
学习率: 0.100000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.7984 | Acc: 75.00% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7764, Acc: 76.34%
测试 - Loss: 1.6690, Acc: 58.01%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.7527 | Acc: 78.91% | Time: 0.0281s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7526, Acc: 77.46%
测试 - Loss: 1.5916, Acc: 59.16%
学习率: 0.100000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.6261 | Acc: 80.47% | Time: 0.0260s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7170, Acc: 78.02%
测试 - Loss: 1.6311, Acc: 58.84%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.6476 | Acc: 78.91% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7114, Acc: 78.00%
测试 - Loss: 1.5932, Acc: 59.41%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.7788 | Acc: 78.12% | Time: 0.0371s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7061, Acc: 78.74%
测试 - Loss: 1.6023, Acc: 59.96%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.6802 | Acc: 75.00% | Time: 0.0338s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6704, Acc: 79.32%
测试 - Loss: 1.6798, Acc: 59.29%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.5800 | Acc: 82.81% | Time: 0.0447s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6520, Acc: 79.68%
测试 - Loss: 1.5723, Acc: 60.11%
学习率: 0.100000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.6024 | Acc: 78.12% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6742, Acc: 78.70%
测试 - Loss: 1.5405, Acc: 60.80%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.6888 | Acc: 81.25% | Time: 0.0324s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6381, Acc: 80.33%
测试 - Loss: 1.5527, Acc: 60.88%
学习率: 0.100000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.7493 | Acc: 80.47% | Time: 0.0304s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6211, Acc: 80.63%
测试 - Loss: 1.5215, Acc: 60.13%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.4395 | Acc: 86.72% | Time: 0.0393s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6016, Acc: 81.51%
测试 - Loss: 1.7057, Acc: 59.45%
学习率: 0.100000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4766 | Acc: 85.94% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6206, Acc: 80.40%
测试 - Loss: 1.5560, Acc: 61.44%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.88% -> 61.44%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.4477 | Acc: 88.28% | Time: 0.0361s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6104, Acc: 80.51%
测试 - Loss: 1.6228, Acc: 60.82%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.5901 | Acc: 82.03% | Time: 0.0434s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.3336, Acc: 90.22%
测试 - Loss: 1.0436, Acc: 72.29%
学习率: 0.010000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.44% -> 72.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1687 | Acc: 93.75% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2121, Acc: 94.22%
测试 - Loss: 1.0342, Acc: 72.61%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.29% -> 72.61%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.2349 | Acc: 93.75% | Time: 0.0387s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1758, Acc: 95.61%
测试 - Loss: 1.0461, Acc: 72.81%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.61% -> 72.81%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1379 | Acc: 97.66% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1534, Acc: 95.99%
测试 - Loss: 1.0522, Acc: 72.96%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.81% -> 72.96%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.1212 | Acc: 96.09% | Time: 0.0347s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1337, Acc: 96.80%
测试 - Loss: 1.0548, Acc: 73.03%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.96% -> 73.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.1030 | Acc: 96.88% | Time: 0.0346s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1231, Acc: 97.08%
测试 - Loss: 1.0596, Acc: 73.46%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.03% -> 73.46%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0978 | Acc: 100.00% | Time: 0.0471s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1092, Acc: 97.50%
测试 - Loss: 1.0647, Acc: 73.25%
学习率: 0.010000, 时间: 5.95s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.0957 | Acc: 98.44% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1018, Acc: 97.77%
测试 - Loss: 1.0816, Acc: 73.02%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.1101 | Acc: 96.09% | Time: 0.0376s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0905, Acc: 98.16%
测试 - Loss: 1.0875, Acc: 72.81%
学习率: 0.010000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0537 | Acc: 100.00% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0889, Acc: 98.22%
测试 - Loss: 1.0997, Acc: 72.97%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0828 | Acc: 98.44% | Time: 0.0446s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0801, Acc: 98.38%
测试 - Loss: 1.1013, Acc: 72.96%
学习率: 0.010000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0535 | Acc: 98.44% | Time: 0.0411s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0794, Acc: 98.46%
测试 - Loss: 1.1083, Acc: 72.87%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0490 | Acc: 100.00% | Time: 0.0383s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0701, Acc: 98.64%
测试 - Loss: 1.1096, Acc: 72.82%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0535 | Acc: 100.00% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0656, Acc: 98.75%
测试 - Loss: 1.1199, Acc: 72.81%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0433 | Acc: 100.00% | Time: 0.0294s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0610, Acc: 98.88%
测试 - Loss: 1.1308, Acc: 72.74%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0777 | Acc: 98.44% | Time: 0.0343s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0576, Acc: 98.96%
测试 - Loss: 1.1227, Acc: 73.10%
学习率: 0.010000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0356 | Acc: 100.00% | Time: 0.0306s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0560, Acc: 99.05%
测试 - Loss: 1.1345, Acc: 72.73%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0618 | Acc: 98.44% | Time: 0.0281s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0501, Acc: 99.13%
测试 - Loss: 1.1281, Acc: 73.09%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0410 | Acc: 99.22% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0485, Acc: 99.20%
测试 - Loss: 1.1361, Acc: 73.13%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0432 | Acc: 99.22% | Time: 0.0281s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0480, Acc: 99.23%
测试 - Loss: 1.1378, Acc: 73.16%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0414 | Acc: 99.22% | Time: 0.0365s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0417, Acc: 99.48%
测试 - Loss: 1.1397, Acc: 73.10%
学习率: 0.010000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0364 | Acc: 99.22% | Time: 0.0325s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0429, Acc: 99.41%
测试 - Loss: 1.1473, Acc: 72.98%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0230 | Acc: 100.00% | Time: 0.0319s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0415, Acc: 99.39%
测试 - Loss: 1.1468, Acc: 73.07%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0397 | Acc: 99.22% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0374, Acc: 99.55%
测试 - Loss: 1.1521, Acc: 73.08%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0219 | Acc: 100.00% | Time: 0.0397s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0369, Acc: 99.54%
测试 - Loss: 1.1532, Acc: 73.00%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0223 | Acc: 100.00% | Time: 0.0303s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0335, Acc: 99.53%
测试 - Loss: 1.1508, Acc: 73.13%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0320 | Acc: 100.00% | Time: 0.0340s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0354, Acc: 99.52%
测试 - Loss: 1.1588, Acc: 72.99%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0352 | Acc: 100.00% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0327, Acc: 99.55%
测试 - Loss: 1.1717, Acc: 72.89%
学习率: 0.010000, 时间: 5.93s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0196 | Acc: 100.00% | Time: 0.0351s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0288, Acc: 99.70%
测试 - Loss: 1.1596, Acc: 73.11%
学习率: 0.010000, 时间: 5.96s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0361 | Acc: 99.22% | Time: 0.0300s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0303, Acc: 99.62%
测试 - Loss: 1.1658, Acc: 72.95%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0262 | Acc: 99.22% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0292, Acc: 99.63%
测试 - Loss: 1.1645, Acc: 73.21%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0223 | Acc: 99.22% | Time: 0.0382s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0273, Acc: 99.76%
测试 - Loss: 1.1630, Acc: 73.15%
学习率: 0.010000, 时间: 5.95s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0224 | Acc: 100.00% | Time: 0.0288s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0263, Acc: 99.75%
测试 - Loss: 1.1685, Acc: 73.03%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0202 | Acc: 100.00% | Time: 0.0339s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0265, Acc: 99.71%
测试 - Loss: 1.1683, Acc: 72.92%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0306 | Acc: 99.22% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0244, Acc: 99.80%
测试 - Loss: 1.1653, Acc: 73.16%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0260 | Acc: 100.00% | Time: 0.0411s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0263, Acc: 99.70%
测试 - Loss: 1.1759, Acc: 72.87%
学习率: 0.010000, 时间: 5.88s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0116 | Acc: 100.00% | Time: 0.0366s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0232, Acc: 99.76%
测试 - Loss: 1.1692, Acc: 73.24%
学习率: 0.010000, 时间: 5.94s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0183 | Acc: 100.00% | Time: 0.0392s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0223, Acc: 99.82%
测试 - Loss: 1.1651, Acc: 73.42%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0186 | Acc: 100.00% | Time: 0.0256s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0212, Acc: 99.85%
测试 - Loss: 1.1691, Acc: 73.36%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0163 | Acc: 100.00% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0204, Acc: 99.81%
测试 - Loss: 1.1746, Acc: 73.14%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0105 | Acc: 100.00% | Time: 0.0380s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.79%
测试 - Loss: 1.1757, Acc: 72.86%
学习率: 0.010000, 时间: 5.92s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0218 | Acc: 99.22% | Time: 0.0337s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0219, Acc: 99.81%
测试 - Loss: 1.1685, Acc: 73.31%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0216 | Acc: 99.22% | Time: 0.0313s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0208, Acc: 99.82%
测试 - Loss: 1.1725, Acc: 73.36%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0091 | Acc: 100.00% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0204, Acc: 99.81%
测试 - Loss: 1.1691, Acc: 73.24%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0091 | Acc: 100.00% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0209, Acc: 99.74%
测试 - Loss: 1.1684, Acc: 73.49%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.46% -> 73.49%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0207 | Acc: 99.22% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0207, Acc: 99.78%
测试 - Loss: 1.1697, Acc: 73.35%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0222 | Acc: 99.22% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0195, Acc: 99.81%
测试 - Loss: 1.1674, Acc: 73.46%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0223 | Acc: 100.00% | Time: 0.0321s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0191, Acc: 99.79%
测试 - Loss: 1.1693, Acc: 73.17%
学习率: 0.010000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0235 | Acc: 99.22% | Time: 0.0320s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0187, Acc: 99.84%
测试 - Loss: 1.1768, Acc: 73.26%
学习率: 0.010000, 时间: 5.90s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0100 | Acc: 100.00% | Time: 0.0379s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0178, Acc: 99.82%
测试 - Loss: 1.1730, Acc: 73.16%
学习率: 0.001000, 时间: 5.91s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 733.42秒 (12.22分钟)
平均每epoch: 7.33秒
最佳测试准确率: 73.49%
保存最终模型到: ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw1_chunks0.pth

训练完成!
