====================================================================================================
Experiment: ddp_resnet50_bs128_gpu4_nw2_chunks0
Parameters: {
  "mode": "ddp",
  "model": "resnet50",
  "batch_size": 128,
  "epochs": 100,
  "dataset": "cifar100",
  "gpu_ids": [
    1,
    2,
    3,
    5
  ],
  "num_workers": 2,
  "prefetch_factor": 1,
  "chunks": 0,
  "num_gpus": 4
}
Command: python -u main.py --mode ddp --model resnet50 --batch-size 128 --epochs 100 --dataset cifar100 --gpu-ids 1,2,3,5 --num-workers 2 --prefetch-factor 1 --chunks 0 --final-checkpoint-path ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
Start Time: 2025-12-10T08:02:29.759574
====================================================================================================

================================================================================
训练配置:
================================================================================
  mode                     : ddp
  gpu_ids                  : [1, 2, 3, 5]
  num_gpus                 : 4
  num_workers              : 2
  prefetch_factor          : 1
  pin_memory               : True
  persistent_workers       : True
  batch_size               : 128
  epochs                   : 100
  lr                       : 0.1
  momentum                 : 0.9
  weight_decay             : 0.0005
  lr_schedule              : step
  lr_step_size             : 50
  lr_gamma                 : 0.1
  dataset                  : cifar100
  data_root                : ./data
  num_classes              : 100
  model                    : resnet50
  save_dir                 : ./checkpoints
  log_interval             : 100
  save_interval            : 10
  final_checkpoint_path    : ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth
  seed                     : 42
  resume                   : None
  evaluate                 : False
  dist_backend             : nccl
  dist_url                 : env://
  effective_batch_size     : 512
  chunks                   : 0
================================================================================

可用GPU数量: 7
  GPU 1: NVIDIA GeForce RTX 4090
  GPU 2: NVIDIA GeForce RTX 4090
  GPU 3: NVIDIA GeForce RTX 4090
  GPU 5: NVIDIA GeForce RTX 4090

使用训练模式: DDP

启动DDP训练...
使用 4 个GPU: [1, 2, 3, 5]
每个GPU的batch size: 128
有效batch size: 512
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/home/uniquefranky/.conda/envs/cifar/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once

进程 0 初始化完成
模型已包装为DDP
数据加载器创建完成
训练样本数: 50000
测试样本数: 10000

开始训练 100 个epochs...

============================================================
Epoch 1/100
============================================================
Rank 0 | Epoch: 0 [0/98] Loss: 4.8293 | Acc: 0.00% | Time: 0.7261s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 5.0934, Acc: 1.41%
测试 - Loss: 4.6208, Acc: 1.97%
学习率: 0.100000, 时间: 15.33s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 0.00% -> 1.97%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 2/100
============================================================
Rank 0 | Epoch: 1 [0/98] Loss: 4.5926 | Acc: 2.34% | Time: 0.0386s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 4.3444, Acc: 3.30%
测试 - Loss: 4.1411, Acc: 4.82%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 1.97% -> 4.82%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 3/100
============================================================
Rank 0 | Epoch: 2 [0/98] Loss: 4.0808 | Acc: 6.25% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.9761, Acc: 7.62%
测试 - Loss: 3.8284, Acc: 9.41%
学习率: 0.100000, 时间: 5.98s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 4.82% -> 9.41%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 4/100
============================================================
Rank 0 | Epoch: 3 [0/98] Loss: 3.6015 | Acc: 17.19% | Time: 0.0380s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.7457, Acc: 11.03%
测试 - Loss: 3.6845, Acc: 13.65%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 9.41% -> 13.65%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 5/100
============================================================
Rank 0 | Epoch: 4 [0/98] Loss: 3.5548 | Acc: 17.19% | Time: 0.0345s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.4974, Acc: 15.68%
测试 - Loss: 3.4432, Acc: 16.92%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 13.65% -> 16.92%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 6/100
============================================================
Rank 0 | Epoch: 5 [0/98] Loss: 3.4563 | Acc: 13.28% | Time: 0.0395s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.2845, Acc: 19.40%
测试 - Loss: 3.2390, Acc: 20.64%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 16.92% -> 20.64%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 7/100
============================================================
Rank 0 | Epoch: 6 [0/98] Loss: 3.0533 | Acc: 23.44% | Time: 0.0489s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 3.0839, Acc: 23.06%
测试 - Loss: 3.0206, Acc: 25.88%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 20.64% -> 25.88%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 8/100
============================================================
Rank 0 | Epoch: 7 [0/98] Loss: 2.8611 | Acc: 28.91% | Time: 0.0381s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.9055, Acc: 26.88%
测试 - Loss: 2.8582, Acc: 27.81%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 25.88% -> 27.81%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 9/100
============================================================
Rank 0 | Epoch: 8 [0/98] Loss: 2.7769 | Acc: 21.88% | Time: 0.0398s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.6866, Acc: 31.36%
测试 - Loss: 2.7128, Acc: 31.07%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 27.81% -> 31.07%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 10/100
============================================================
Rank 0 | Epoch: 9 [0/98] Loss: 2.4546 | Acc: 37.50% | Time: 0.0367s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.5593, Acc: 34.24%
测试 - Loss: 2.6821, Acc: 33.03%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 31.07% -> 33.03%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_10.pth

============================================================
Epoch 11/100
============================================================
Rank 0 | Epoch: 10 [0/98] Loss: 2.6065 | Acc: 32.03% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.4016, Acc: 36.96%
测试 - Loss: 2.4233, Acc: 37.42%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 33.03% -> 37.42%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 12/100
============================================================
Rank 0 | Epoch: 11 [0/98] Loss: 2.2777 | Acc: 39.84% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.2414, Acc: 39.76%
测试 - Loss: 2.2657, Acc: 40.91%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 37.42% -> 40.91%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 13/100
============================================================
Rank 0 | Epoch: 12 [0/98] Loss: 2.2530 | Acc: 44.53% | Time: 0.0407s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 2.0948, Acc: 43.79%
测试 - Loss: 2.2067, Acc: 41.33%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 40.91% -> 41.33%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 14/100
============================================================
Rank 0 | Epoch: 13 [0/98] Loss: 1.9012 | Acc: 46.09% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.9718, Acc: 46.33%
测试 - Loss: 2.1449, Acc: 43.23%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 41.33% -> 43.23%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 15/100
============================================================
Rank 0 | Epoch: 14 [0/98] Loss: 1.5576 | Acc: 53.91% | Time: 0.0360s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.8666, Acc: 48.68%
测试 - Loss: 2.0237, Acc: 46.09%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 43.23% -> 46.09%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 16/100
============================================================
Rank 0 | Epoch: 15 [0/98] Loss: 1.4552 | Acc: 57.03% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.7628, Acc: 50.82%
测试 - Loss: 1.9902, Acc: 47.70%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 46.09% -> 47.70%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 17/100
============================================================
Rank 0 | Epoch: 16 [0/98] Loss: 1.6744 | Acc: 52.34% | Time: 0.0360s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.6679, Acc: 53.26%
测试 - Loss: 1.8917, Acc: 49.32%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 47.70% -> 49.32%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 18/100
============================================================
Rank 0 | Epoch: 17 [0/98] Loss: 1.5723 | Acc: 54.69% | Time: 0.0321s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.5752, Acc: 55.45%
测试 - Loss: 1.8927, Acc: 49.58%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 49.32% -> 49.58%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 19/100
============================================================
Rank 0 | Epoch: 18 [0/98] Loss: 1.4607 | Acc: 57.03% | Time: 0.0364s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4576, Acc: 58.36%
测试 - Loss: 1.8499, Acc: 51.98%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 49.58% -> 51.98%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 20/100
============================================================
Rank 0 | Epoch: 19 [0/98] Loss: 1.3167 | Acc: 62.50% | Time: 0.0282s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.4129, Acc: 59.53%
测试 - Loss: 1.8139, Acc: 51.56%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_20.pth

============================================================
Epoch 21/100
============================================================
Rank 0 | Epoch: 20 [0/98] Loss: 1.4138 | Acc: 62.50% | Time: 0.0310s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3366, Acc: 61.30%
测试 - Loss: 1.7996, Acc: 52.39%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 51.98% -> 52.39%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 22/100
============================================================
Rank 0 | Epoch: 21 [0/98] Loss: 1.3636 | Acc: 60.16% | Time: 0.0356s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.3137, Acc: 62.14%
测试 - Loss: 1.6811, Acc: 55.24%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 52.39% -> 55.24%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 23/100
============================================================
Rank 0 | Epoch: 22 [0/98] Loss: 1.1659 | Acc: 64.84% | Time: 0.0379s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.2335, Acc: 63.80%
测试 - Loss: 1.6367, Acc: 55.76%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 55.24% -> 55.76%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 24/100
============================================================
Rank 0 | Epoch: 23 [0/98] Loss: 1.1120 | Acc: 63.28% | Time: 0.0346s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1843, Acc: 65.66%
测试 - Loss: 1.6803, Acc: 56.66%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 55.76% -> 56.66%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 25/100
============================================================
Rank 0 | Epoch: 24 [0/98] Loss: 0.8205 | Acc: 76.56% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.1339, Acc: 66.14%
测试 - Loss: 1.5918, Acc: 57.35%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 56.66% -> 57.35%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 26/100
============================================================
Rank 0 | Epoch: 25 [0/98] Loss: 1.0707 | Acc: 68.75% | Time: 0.0330s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0738, Acc: 67.99%
测试 - Loss: 1.5256, Acc: 58.58%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 57.35% -> 58.58%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 27/100
============================================================
Rank 0 | Epoch: 26 [0/98] Loss: 1.0101 | Acc: 72.66% | Time: 0.0409s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0136, Acc: 69.69%
测试 - Loss: 1.5940, Acc: 57.43%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 28/100
============================================================
Rank 0 | Epoch: 27 [0/98] Loss: 0.8523 | Acc: 73.44% | Time: 0.0352s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 1.0008, Acc: 69.43%
测试 - Loss: 1.6134, Acc: 57.63%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 29/100
============================================================
Rank 0 | Epoch: 28 [0/98] Loss: 0.9873 | Acc: 72.66% | Time: 0.0279s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9596, Acc: 71.17%
测试 - Loss: 1.5432, Acc: 59.01%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 58.58% -> 59.01%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 30/100
============================================================
Rank 0 | Epoch: 29 [0/98] Loss: 0.8966 | Acc: 70.31% | Time: 0.0374s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.9131, Acc: 72.29%
测试 - Loss: 1.5694, Acc: 58.81%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_30.pth

============================================================
Epoch 31/100
============================================================
Rank 0 | Epoch: 30 [0/98] Loss: 0.6675 | Acc: 82.03% | Time: 0.0403s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8842, Acc: 73.15%
测试 - Loss: 1.5244, Acc: 59.69%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.01% -> 59.69%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 32/100
============================================================
Rank 0 | Epoch: 31 [0/98] Loss: 0.6730 | Acc: 80.47% | Time: 0.0320s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8393, Acc: 74.40%
测试 - Loss: 1.6952, Acc: 56.60%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 33/100
============================================================
Rank 0 | Epoch: 32 [0/98] Loss: 0.8701 | Acc: 75.00% | Time: 0.0285s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.8427, Acc: 74.33%
测试 - Loss: 1.5516, Acc: 59.36%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 34/100
============================================================
Rank 0 | Epoch: 33 [0/98] Loss: 0.7088 | Acc: 78.12% | Time: 0.0290s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7853, Acc: 76.07%
测试 - Loss: 1.5732, Acc: 59.46%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 35/100
============================================================
Rank 0 | Epoch: 34 [0/98] Loss: 0.8617 | Acc: 72.66% | Time: 0.0340s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7894, Acc: 76.14%
测试 - Loss: 1.6380, Acc: 58.44%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 36/100
============================================================
Rank 0 | Epoch: 35 [0/98] Loss: 0.7008 | Acc: 78.12% | Time: 0.0281s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7516, Acc: 77.02%
测试 - Loss: 1.6521, Acc: 58.81%
学习率: 0.100000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 37/100
============================================================
Rank 0 | Epoch: 36 [0/98] Loss: 0.6592 | Acc: 82.03% | Time: 0.0351s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7528, Acc: 76.58%
测试 - Loss: 1.5495, Acc: 60.16%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 59.69% -> 60.16%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 38/100
============================================================
Rank 0 | Epoch: 37 [0/98] Loss: 0.7333 | Acc: 76.56% | Time: 0.0358s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7291, Acc: 77.69%
测试 - Loss: 1.5725, Acc: 60.71%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.16% -> 60.71%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 39/100
============================================================
Rank 0 | Epoch: 38 [0/98] Loss: 0.6488 | Acc: 80.47% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.7013, Acc: 78.54%
测试 - Loss: 1.6204, Acc: 59.00%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 40/100
============================================================
Rank 0 | Epoch: 39 [0/98] Loss: 0.6497 | Acc: 82.03% | Time: 0.0276s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6769, Acc: 79.03%
测试 - Loss: 1.6490, Acc: 59.59%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_40.pth

============================================================
Epoch 41/100
============================================================
Rank 0 | Epoch: 40 [0/98] Loss: 0.6762 | Acc: 78.12% | Time: 0.0334s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6696, Acc: 79.25%
测试 - Loss: 1.6126, Acc: 59.75%
学习率: 0.100000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 42/100
============================================================
Rank 0 | Epoch: 41 [0/98] Loss: 0.6158 | Acc: 78.12% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6711, Acc: 79.25%
测试 - Loss: 1.5855, Acc: 59.62%
学习率: 0.100000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 43/100
============================================================
Rank 0 | Epoch: 42 [0/98] Loss: 0.5124 | Acc: 84.38% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6194, Acc: 80.79%
测试 - Loss: 1.6089, Acc: 60.65%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 44/100
============================================================
Rank 0 | Epoch: 43 [0/98] Loss: 0.5931 | Acc: 79.69% | Time: 0.0328s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6171, Acc: 81.40%
测试 - Loss: 1.7893, Acc: 57.66%
学习率: 0.100000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 45/100
============================================================
Rank 0 | Epoch: 44 [0/98] Loss: 0.4744 | Acc: 83.59% | Time: 0.0297s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.6044, Acc: 81.36%
测试 - Loss: 1.6478, Acc: 60.18%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 46/100
============================================================
Rank 0 | Epoch: 45 [0/98] Loss: 0.6339 | Acc: 85.16% | Time: 0.0394s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5840, Acc: 82.18%
测试 - Loss: 1.6561, Acc: 60.31%
学习率: 0.100000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 47/100
============================================================
Rank 0 | Epoch: 46 [0/98] Loss: 0.6365 | Acc: 78.12% | Time: 0.0288s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5875, Acc: 81.42%
测试 - Loss: 1.6134, Acc: 58.89%
学习率: 0.100000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 48/100
============================================================
Rank 0 | Epoch: 47 [0/98] Loss: 0.6044 | Acc: 84.38% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5821, Acc: 82.06%
测试 - Loss: 1.5842, Acc: 61.29%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 60.71% -> 61.29%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 49/100
============================================================
Rank 0 | Epoch: 48 [0/98] Loss: 0.4820 | Acc: 83.59% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5574, Acc: 82.34%
测试 - Loss: 1.5813, Acc: 61.63%
学习率: 0.100000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.29% -> 61.63%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 50/100
============================================================
Rank 0 | Epoch: 49 [0/98] Loss: 0.3823 | Acc: 87.50% | Time: 0.0351s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.5683, Acc: 82.14%
测试 - Loss: 1.6139, Acc: 59.93%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_50.pth

============================================================
Epoch 51/100
============================================================
Rank 0 | Epoch: 50 [0/98] Loss: 0.5932 | Acc: 81.25% | Time: 0.0323s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.2984, Acc: 91.18%
测试 - Loss: 1.0633, Acc: 72.02%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 61.63% -> 72.02%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 52/100
============================================================
Rank 0 | Epoch: 51 [0/98] Loss: 0.1853 | Acc: 92.97% | Time: 0.0420s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1867, Acc: 95.11%
测试 - Loss: 1.0487, Acc: 72.89%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.02% -> 72.89%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 53/100
============================================================
Rank 0 | Epoch: 52 [0/98] Loss: 0.1463 | Acc: 96.88% | Time: 0.0324s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1571, Acc: 96.02%
测试 - Loss: 1.0600, Acc: 72.60%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 54/100
============================================================
Rank 0 | Epoch: 53 [0/98] Loss: 0.1275 | Acc: 96.88% | Time: 0.0315s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1300, Acc: 97.02%
测试 - Loss: 1.0693, Acc: 72.87%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 55/100
============================================================
Rank 0 | Epoch: 54 [0/98] Loss: 0.1008 | Acc: 98.44% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1149, Acc: 97.40%
测试 - Loss: 1.0701, Acc: 73.26%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 72.89% -> 73.26%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 56/100
============================================================
Rank 0 | Epoch: 55 [0/98] Loss: 0.0917 | Acc: 97.66% | Time: 0.0424s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.1032, Acc: 97.87%
测试 - Loss: 1.0802, Acc: 72.87%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 57/100
============================================================
Rank 0 | Epoch: 56 [0/98] Loss: 0.0997 | Acc: 98.44% | Time: 0.0274s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0919, Acc: 98.08%
测试 - Loss: 1.0777, Acc: 73.20%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 58/100
============================================================
Rank 0 | Epoch: 57 [0/98] Loss: 0.1074 | Acc: 96.88% | Time: 0.0350s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0874, Acc: 98.27%
测试 - Loss: 1.0901, Acc: 73.19%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 59/100
============================================================
Rank 0 | Epoch: 58 [0/98] Loss: 0.1101 | Acc: 96.88% | Time: 0.0293s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0832, Acc: 98.34%
测试 - Loss: 1.0928, Acc: 72.95%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 60/100
============================================================
Rank 0 | Epoch: 59 [0/98] Loss: 0.0632 | Acc: 99.22% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0766, Acc: 98.56%
测试 - Loss: 1.1046, Acc: 73.28%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.26% -> 73.28%
保存最佳模型到: ./checkpoints/best_model_ddp.pth
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_60.pth

============================================================
Epoch 61/100
============================================================
Rank 0 | Epoch: 60 [0/98] Loss: 0.0595 | Acc: 98.44% | Time: 0.0365s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0721, Acc: 98.69%
测试 - Loss: 1.1041, Acc: 72.98%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 62/100
============================================================
Rank 0 | Epoch: 61 [0/98] Loss: 0.0649 | Acc: 98.44% | Time: 0.0474s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0657, Acc: 98.86%
测试 - Loss: 1.1082, Acc: 73.03%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 63/100
============================================================
Rank 0 | Epoch: 62 [0/98] Loss: 0.0458 | Acc: 98.44% | Time: 0.0384s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0609, Acc: 98.93%
测试 - Loss: 1.1103, Acc: 72.92%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 64/100
============================================================
Rank 0 | Epoch: 63 [0/98] Loss: 0.0312 | Acc: 100.00% | Time: 0.0264s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0569, Acc: 99.14%
测试 - Loss: 1.1124, Acc: 72.97%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 65/100
============================================================
Rank 0 | Epoch: 64 [0/98] Loss: 0.0648 | Acc: 98.44% | Time: 0.0377s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0526, Acc: 99.23%
测试 - Loss: 1.1180, Acc: 73.21%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 66/100
============================================================
Rank 0 | Epoch: 65 [0/98] Loss: 0.0565 | Acc: 98.44% | Time: 0.0292s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0499, Acc: 99.27%
测试 - Loss: 1.1177, Acc: 73.20%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 67/100
============================================================
Rank 0 | Epoch: 66 [0/98] Loss: 0.0510 | Acc: 99.22% | Time: 0.0409s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0485, Acc: 99.34%
测试 - Loss: 1.1333, Acc: 72.90%
学习率: 0.010000, 时间: 5.89s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 68/100
============================================================
Rank 0 | Epoch: 67 [0/98] Loss: 0.0509 | Acc: 98.44% | Time: 0.0302s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0466, Acc: 99.30%
测试 - Loss: 1.1279, Acc: 73.06%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 69/100
============================================================
Rank 0 | Epoch: 68 [0/98] Loss: 0.0370 | Acc: 100.00% | Time: 0.0347s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0434, Acc: 99.44%
测试 - Loss: 1.1272, Acc: 72.91%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 70/100
============================================================
Rank 0 | Epoch: 69 [0/98] Loss: 0.0354 | Acc: 100.00% | Time: 0.0341s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0427, Acc: 99.50%
测试 - Loss: 1.1372, Acc: 72.96%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_70.pth

============================================================
Epoch 71/100
============================================================
Rank 0 | Epoch: 70 [0/98] Loss: 0.0271 | Acc: 100.00% | Time: 0.0380s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0398, Acc: 99.45%
测试 - Loss: 1.1351, Acc: 72.95%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 72/100
============================================================
Rank 0 | Epoch: 71 [0/98] Loss: 0.0260 | Acc: 99.22% | Time: 0.0288s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0387, Acc: 99.45%
测试 - Loss: 1.1391, Acc: 72.88%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 73/100
============================================================
Rank 0 | Epoch: 72 [0/98] Loss: 0.0236 | Acc: 100.00% | Time: 0.0317s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0383, Acc: 99.50%
测试 - Loss: 1.1379, Acc: 72.96%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 74/100
============================================================
Rank 0 | Epoch: 73 [0/98] Loss: 0.0371 | Acc: 100.00% | Time: 0.0412s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0386, Acc: 99.51%
测试 - Loss: 1.1461, Acc: 72.92%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 75/100
============================================================
Rank 0 | Epoch: 74 [0/98] Loss: 0.0614 | Acc: 99.22% | Time: 0.0307s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0341, Acc: 99.62%
测试 - Loss: 1.1450, Acc: 72.99%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 76/100
============================================================
Rank 0 | Epoch: 75 [0/98] Loss: 0.0263 | Acc: 100.00% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0330, Acc: 99.66%
测试 - Loss: 1.1410, Acc: 73.30%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.28% -> 73.30%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 77/100
============================================================
Rank 0 | Epoch: 76 [0/98] Loss: 0.0362 | Acc: 100.00% | Time: 0.0331s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0303, Acc: 99.77%
测试 - Loss: 1.1406, Acc: 72.89%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 78/100
============================================================
Rank 0 | Epoch: 77 [0/98] Loss: 0.0327 | Acc: 99.22% | Time: 0.0316s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0310, Acc: 99.62%
测试 - Loss: 1.1408, Acc: 73.25%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 79/100
============================================================
Rank 0 | Epoch: 78 [0/98] Loss: 0.0202 | Acc: 100.00% | Time: 0.0354s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0297, Acc: 99.66%
测试 - Loss: 1.1409, Acc: 73.00%
学习率: 0.010000, 时间: 5.81s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 80/100
============================================================
Rank 0 | Epoch: 79 [0/98] Loss: 0.0256 | Acc: 100.00% | Time: 0.0372s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0294, Acc: 99.78%
测试 - Loss: 1.1518, Acc: 73.11%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_80.pth

============================================================
Epoch 81/100
============================================================
Rank 0 | Epoch: 80 [0/98] Loss: 0.0294 | Acc: 100.00% | Time: 0.0379s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0280, Acc: 99.74%
测试 - Loss: 1.1470, Acc: 73.17%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 82/100
============================================================
Rank 0 | Epoch: 81 [0/98] Loss: 0.0160 | Acc: 100.00% | Time: 0.0305s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0263, Acc: 99.81%
测试 - Loss: 1.1511, Acc: 73.10%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 83/100
============================================================
Rank 0 | Epoch: 82 [0/98] Loss: 0.0281 | Acc: 99.22% | Time: 0.0378s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0253, Acc: 99.80%
测试 - Loss: 1.1476, Acc: 73.11%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 84/100
============================================================
Rank 0 | Epoch: 83 [0/98] Loss: 0.0265 | Acc: 100.00% | Time: 0.0295s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0254, Acc: 99.78%
测试 - Loss: 1.1487, Acc: 73.04%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 85/100
============================================================
Rank 0 | Epoch: 84 [0/98] Loss: 0.0271 | Acc: 100.00% | Time: 0.0332s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0234, Acc: 99.88%
测试 - Loss: 1.1510, Acc: 73.01%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 86/100
============================================================
Rank 0 | Epoch: 85 [0/98] Loss: 0.0319 | Acc: 100.00% | Time: 0.0303s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0249, Acc: 99.74%
测试 - Loss: 1.1588, Acc: 72.99%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 87/100
============================================================
Rank 0 | Epoch: 86 [0/98] Loss: 0.0141 | Acc: 100.00% | Time: 0.0308s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0221, Acc: 99.85%
测试 - Loss: 1.1553, Acc: 73.16%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 88/100
============================================================
Rank 0 | Epoch: 87 [0/98] Loss: 0.0134 | Acc: 100.00% | Time: 0.0309s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0253, Acc: 99.72%
测试 - Loss: 1.1474, Acc: 73.22%
学习率: 0.010000, 时间: 5.82s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 89/100
============================================================
Rank 0 | Epoch: 88 [0/98] Loss: 0.0162 | Acc: 100.00% | Time: 0.0416s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0223, Acc: 99.86%
测试 - Loss: 1.1512, Acc: 73.06%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 90/100
============================================================
Rank 0 | Epoch: 89 [0/98] Loss: 0.0197 | Acc: 100.00% | Time: 0.0363s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0216, Acc: 99.86%
测试 - Loss: 1.1484, Acc: 73.01%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_90.pth

============================================================
Epoch 91/100
============================================================
Rank 0 | Epoch: 90 [0/98] Loss: 0.0221 | Acc: 100.00% | Time: 0.0394s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.82%
测试 - Loss: 1.1550, Acc: 73.10%
学习率: 0.010000, 时间: 5.87s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 92/100
============================================================
Rank 0 | Epoch: 91 [0/98] Loss: 0.0112 | Acc: 100.00% | Time: 0.0283s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0206, Acc: 99.82%
测试 - Loss: 1.1543, Acc: 73.16%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 93/100
============================================================
Rank 0 | Epoch: 92 [0/98] Loss: 0.0137 | Acc: 100.00% | Time: 0.0335s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0222, Acc: 99.75%
测试 - Loss: 1.1570, Acc: 72.84%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 94/100
============================================================
Rank 0 | Epoch: 93 [0/98] Loss: 0.0101 | Acc: 100.00% | Time: 0.0320s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0212, Acc: 99.82%
测试 - Loss: 1.1579, Acc: 72.82%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 95/100
============================================================
Rank 0 | Epoch: 94 [0/98] Loss: 0.0093 | Acc: 100.00% | Time: 0.0312s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0205, Acc: 99.85%
测试 - Loss: 1.1491, Acc: 73.36%
学习率: 0.010000, 时间: 5.85s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
最佳准确率更新: 73.30% -> 73.36%
保存最佳模型到: ./checkpoints/best_model_ddp.pth

============================================================
Epoch 96/100
============================================================
Rank 0 | Epoch: 95 [0/98] Loss: 0.0188 | Acc: 100.00% | Time: 0.0311s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0204, Acc: 99.85%
测试 - Loss: 1.1542, Acc: 72.93%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 97/100
============================================================
Rank 0 | Epoch: 96 [0/98] Loss: 0.0152 | Acc: 100.00% | Time: 0.0357s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0202, Acc: 99.88%
测试 - Loss: 1.1598, Acc: 72.99%
学习率: 0.010000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 98/100
============================================================
Rank 0 | Epoch: 97 [0/98] Loss: 0.0165 | Acc: 100.00% | Time: 0.0342s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0196, Acc: 99.85%
测试 - Loss: 1.1557, Acc: 72.80%
学习率: 0.010000, 时间: 5.83s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 99/100
============================================================
Rank 0 | Epoch: 98 [0/98] Loss: 0.0213 | Acc: 99.22% | Time: 0.0326s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0184, Acc: 99.87%
测试 - Loss: 1.1632, Acc: 72.81%
学习率: 0.010000, 时间: 5.86s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB

============================================================
Epoch 100/100
============================================================
Rank 0 | Epoch: 99 [0/98] Loss: 0.0159 | Acc: 100.00% | Time: 0.0400s | GPU Mem: 0.29GB/3.77GB

训练 - Loss: 0.0196, Acc: 99.86%
测试 - Loss: 1.1518, Acc: 72.94%
学习率: 0.001000, 时间: 5.84s
GPU内存使用:
  GPU 1 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 2 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 3 - 已分配: 0.28GB, 已保留: 3.77GB
  GPU 5 - 已分配: 0.28GB, 已保留: 3.77GB
保存checkpoint到: ./checkpoints/checkpoint_ddp_epoch_100.pth

============================================================
训练完成!
============================================================
总时间: 723.77秒 (12.06分钟)
平均每epoch: 7.24秒
最佳测试准确率: 73.36%
保存最终模型到: ./experiments/group_3_dataloader_optimization_across_training_modes/checkpoints/ddp_resnet50_bs128_gpu4_nw2_chunks0.pth

训练完成!
